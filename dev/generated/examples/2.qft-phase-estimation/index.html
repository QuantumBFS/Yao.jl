<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0579333-0.159633im       0.321754-0.0441277im   -0.00768479-0.149769im     -0.0590229+0.171401im       -0.115534+0.120855im    -0.0611099+0.0607925im   -0.0853689+0.115795im        0.211159-0.00661494im    -0.129711+0.196269im      -0.133391-0.0734545im      0.106417+0.204946im       0.106173+0.0481779im   0.0933958+0.100184im     -0.0824223+0.0687288im     -0.129487+0.0448206im     0.205394-0.0960958im   -0.182894-0.0387131im      0.142374-0.148135im      0.0944601-0.160816im      0.0261681-0.122907im    -0.0075432-0.169715im        0.13225-0.141687im       0.0404796+0.0148974im     0.0274659+0.0215491im    -0.184784-0.0509822im    0.0237845-0.178372im      -0.248418+0.204394im    -0.0806566-0.0350273im    -0.145302-0.0706187im        0.02546+0.153222im     -0.116126+0.06591im      -0.132255+0.0236091im
  -0.147571+0.0853108im    -0.0225597+0.0596935im    -0.0732536+0.0236206im     -0.231245+0.0314847im      0.0890198+0.0992352im    -0.261795+0.121543im    0.00876738+0.10779im        -0.147891-0.0882344im      0.123483+0.0038575im      0.158576-0.143445im       -0.22465+0.16007im       -0.253528+0.109621im     0.168059+0.0196664im     -0.063013+0.0348158im    -0.0440554-0.0197524im    0.0659643-0.0644032im   0.0623264-0.152307im      0.0553069-0.00193918im    -0.184803+0.0368975im    -0.0575184+0.251438im    -0.0975682-0.103797im       0.102151+0.0195308im     -0.0894912+0.069796im    -0.00556839+0.182207im     -0.015186+0.0393075im    0.0415236+0.0196427im   0.000253096+0.195018im    -0.0475429-0.132006im    -0.0507935+0.264357im      -0.0209024-0.108575im    -0.0246112-0.266415im    -0.0892148+0.26607im
   0.163684+0.013191im      0.0649723-0.20322im       -0.106106-0.0541472im     0.0716996+0.0268621im     -0.0618836-0.111033im    0.00352935+0.00961337im     0.22904+0.0561228im      0.0873868+0.180822im      0.0470346+0.187684im      -0.187288-0.0396396im    -0.0305902+0.00545813im    0.0643724+0.153202im    0.0957492-0.0493543im      0.126862+0.111536im        -0.1198-0.0534509im     0.193166+0.168778im      0.18146+0.118875im      0.0338236+0.283864im      -0.175403-0.148783im       0.173659+0.13543im        0.19199-0.0965439im     0.0192642-0.0690548im     -0.0613838+0.0232608im    -0.0631206-0.0790323im    -0.165565-0.109522im     0.0357874+0.0811336im     0.0975503-0.182148im      0.164947+0.166417im       -0.1481+0.201646im         0.12156-0.165044im     0.0436847-0.133139im     0.0651605+0.00659866im
  0.0634132+0.168794im      0.0372402+0.146431im      -0.201153-0.070642im      -0.191545-0.146844im       0.0124137+0.0545166im   -0.0274668-0.181857im       0.13247+0.0387392im       0.152662+0.0681966im    -0.0162865+0.127746im      0.0948281-0.0525912im    -0.0486847-0.0377103im      0.164207-0.195907im   -0.0806936-0.0115151im     0.0435817+0.0373835im      0.143453+0.100568im     -0.164347+0.0713227im     0.13658-0.0207569im     -0.130602-0.0234405im      0.108047-0.191987im      0.0558658+0.0242818im   -0.0628322+0.0733846im     0.0702207-0.17981im       -0.0454012-0.0767365im     0.0539997-0.0591103im   -0.0399774+0.237566im      0.118739+0.198005im      -0.118136-0.0760448im     -0.16986-0.143009im    -0.0769535+0.0609373im      0.0490214-0.145733im     -0.425276+0.121629im     0.0934004+0.137328im
  0.0643692+0.025249im       0.137371-0.0399615im     -0.048145+0.130997im      0.0701373-0.105324im      -0.0331258-0.0917786im    0.0356454-0.108265im     -0.354584+0.100808im       -0.116976+0.0502048im    -0.0623796-0.171556im      -0.228996+0.08747im        0.179105+0.063663im         0.2057-0.0391428im    0.179313-0.0276298im     -0.142055+0.102864im     -0.0401533-0.151968im     0.0367713+0.104772im      0.20628-0.202171im     -0.0405641-0.291028im     -0.0469501+0.149986im      -0.153542+0.167448im      0.139503+0.00126317im     -0.12794+0.0378411im     -0.0428011+0.087833im      0.0106841-0.00204938im   0.0172935+0.138179im    0.00486289+0.0332948im   -0.00587747-0.0712568im    0.0998391+0.0611678im    -0.173393+0.051978im       -0.147464-0.169416im    -0.0455554+0.142804im    -0.0988404+0.206743im
 -0.0490737-0.0520955im     -0.058089-0.0510673im     -0.159443+0.0359602im    -0.0203297-0.276451im      -0.0417015+0.0507639im     0.193356-0.133415im     0.0384146+0.15771im        -0.121014-0.187341im     -0.0283103-0.00668033im   -0.0767211-0.338823im      -0.084677+0.0385063im      0.142052+0.0123479im   0.0127608+0.116734im     -0.0331505+0.0296087im    -0.0448045+0.0290527im     0.127544+0.107032im    -0.196815+0.109664im       0.103765-0.114761im       0.101782-0.010053im        0.14367-0.0432943im    -0.234628-0.0648852im    -0.0343414+0.0370877im       0.163376+0.171469im      -0.110158-0.0442178im     0.130503+0.0807875im     0.248906+0.0598284im      0.220091-0.00881244im   -0.130503-0.0194969im    -0.177021+0.0756652im      -0.171187-0.0869115im     0.143476-0.0803089im    0.0148626-0.238795im
  0.0872921-0.0552295im    -0.0384864+0.0319204im     0.0815319-0.0556289im    -0.0232623-0.228847im      -0.0129645+0.20932im      0.0954672+0.0907023im     0.163238+0.0178827im     -0.0480221+0.0912633im       0.13332+0.0960748im      -0.16767+0.115193im    -0.00658604+0.165411im      0.0621995-0.25069im      -0.09682+0.0461158im     -0.477713+0.157643im     0.00188962-0.117207im     -0.164406+0.027373im   -0.0555398-0.072116im       0.158171+0.212532im     -0.0329397+0.156384im     -0.0215926+0.0555963im    -0.052743+0.0450059im     -0.262966+0.0709468im     -0.0186008+0.102139im     -0.0252824-0.0345296im    -0.113372-0.0758845im    0.0483675+0.0686435im    -0.0982071+0.0533492im    -0.146267+0.12373im       0.053124+0.0302406im       0.175702+0.168416im    0.00631602-0.0906763im     0.065518+0.0842987im
  0.0434954-0.0439884im    -0.0977238-0.0826036im     -0.183913-0.19181im       0.0530834-0.026646im       0.0127891-0.046946im     -0.245005+0.108514im      -0.12197-0.214462im       0.0738684+0.0584467im     -0.074728+0.0978999im    -0.0822134+0.0227235im     -0.115241-0.118563im       0.102009-0.118408im    -0.194771-0.0166709im    -0.0241996-0.00531305im   -0.0214247+0.0961039im     0.134468+0.356634im   -0.0199514+0.0336079im     0.0250289-0.1915im       -0.0539105-0.0483097im     0.0330951+0.168036im      -0.16982-0.096787im      -0.160344+0.0965238im      0.0138125+0.121593im       0.264583+0.0833323im     0.286121-0.186296im     -0.237766-0.13855im       0.0864635+0.0133596im   -0.0465876-0.028448im     0.0636033+0.0367614im      0.0845742+0.0253479im    -0.167221-0.0702142im    -0.075769-0.0206986im
 -0.0464566-0.0834443im    -0.0643378-0.0331538im      0.034578-0.0800161im    -0.0371094-0.116403im         0.15855-0.0801604im    0.0994509-0.018176im    -0.0637148-0.203257im       -0.176472-0.141923im      -0.239904+0.238407im      -0.059276-0.0770626im    -0.0344731+0.0246175im    -0.0256682-0.103818im    -0.110066+0.00404875im    -0.117528-0.0243237im      0.115321+0.0310771im    0.0176377+0.0858499im   -0.132478-0.192945im      -0.113797-0.00923916im   -0.0903734+0.210293im       0.145263-0.0244806im     0.255431+0.0426019im      0.283521-0.22606im         0.151657-0.11185im         0.21668+0.135402im     -0.145024+0.142081im     0.0517814+0.0016119im     0.0412299+0.0460424im     0.166148+0.0521377im    0.0584251+0.237313im        0.166174-0.0168693im     0.109931+0.0892837im   -0.0886032-0.0654782im
    0.26027-0.205848im      0.0755605+0.145476im      -0.119208+0.201286im     -0.0835827-0.312894im       -0.269861+0.036626im     0.0272902-0.00645077im  0.00619068-0.0302838im     -0.0613429+0.028443im     -0.0557288+0.161051im       0.192316-0.0708847im    -0.0038486-0.112433im     -0.0281567+0.0993597im    0.169171+0.0375936im      0.179575+0.0482181im      0.137414+0.115868im     -0.130021-0.0702798im  -0.0748972+0.105514im       0.230162-0.0923754im     -0.128598+0.151321im     -0.0245194-0.0418928im    0.0732711+0.0791324im    0.00126816+0.0293692im      -0.170974-0.0605469im      0.187333-0.0185293im    0.0267994-0.0604813im   -0.0735182-0.254525im      0.0912408-0.0490408im    0.0374452+0.0452009im    -0.104362+0.0428782im      0.0138757+0.162302im     0.0289562+0.0217333im      0.18535+0.21271im
  -0.131618-0.115587im      0.0457155+0.0633835im     -0.047732-0.313013im     -0.0753324-0.0781871im      -0.109441+0.0276203im    0.0719904-0.034412im      0.066267-0.135529im       -0.241901-0.241717im       0.172949-0.0309499im    -0.0654843-0.0239363im   -0.00620049-0.108172im      0.0346372+0.126394im     0.182858+0.054869im      0.0674198-0.0103406im     -0.177534-0.140464im    0.00754291+0.14702im     0.0241837-0.104145im     -0.0456134+0.269624im       0.140673-0.0700902im    -0.0450451-0.0979207im   -0.0840692+0.0523147im    -0.0274191+0.00133971im      0.114482-0.0476566im     0.0853423+0.0318586im   0.00511423-0.0516323im    -0.220991+0.135086im     -0.0519646+0.0630239im     0.221166+0.075101im    -0.0256091+0.0663816im      -0.293801+0.206283im     -0.213977+0.153205im     0.0848656+0.124621im
 -0.0702443-0.0472588im      0.115435+0.0408995im     0.0175004-0.155633im        0.14769-0.141325im     -0.00322087-0.0416586im    -0.162941-0.222738im      0.068487+0.209431im        0.155185+0.0737918im    -0.0260352+0.0435825im     -0.132791+0.110688im      -0.263144+0.309069im     -0.0818343+0.111739im    -0.107849-0.0487243im   -0.00652144+0.0119153im      0.052389-0.0670508im     0.004392-0.102185im     0.213115+0.166072im      0.0935815-0.00863008im    0.0543653+0.16541im       0.0192599+0.0855741im    -0.299998+0.140984im       0.116253-0.0488495im     -0.0267605-0.0311927im      0.126319+0.150056im      0.113833+0.0777242im   -0.0143746-0.0243027im     0.0102826+0.103951im      0.244922+0.0672529im    0.0719554-0.0748219im    -0.00353849-0.0477598im     0.145898+0.265016im      0.137125-0.053303im
   0.139724-0.0302944im      0.047396-0.146001im      0.0277375-0.00541577im   -0.0831203-0.0511242im      0.0735012+0.0640882im     0.100049+0.0742142im    -0.117976+0.0307534im     -0.0902974+0.286961im       0.319976+0.150963im       0.109212-0.166249im      0.0219675-0.123855im    -0.00499588+0.065343im   -0.0970698+0.108904im      -0.112444+0.0217194im      0.020481-0.0738472im    -0.221111-0.167259im    0.0892584-0.1867im      -0.00348802-0.222925im      -0.104322-0.2906im         0.255499+0.0514856im     -0.11322-0.121474im    -0.00790607+0.0424279im       0.117237-0.183551im     -0.0238983+0.244275im     0.0662603-0.0699349im    0.0295014+0.075945im      0.0262398-0.074289im      0.224258+0.0479734im    0.0367585-0.125065im      -0.0557097+0.0474745im    0.0627079+0.103106im    -0.0719898-0.0597128im
  -0.020092+0.196866im      -0.101599+5.72969e-5im   -0.0157326-0.0977166im    -0.0818121-0.0638404im      0.0693871-0.0891756im    -0.165463-0.174451im      -0.14652+0.092658im      0.00469117-0.106772im      0.0269029+0.0973515im     -0.169651-0.211011im       0.102461-0.139891im      0.0511357+0.0572591im  -0.0214775-0.0680097im     0.0733424+0.0493143im     -0.010785-0.134794im     0.0680229-0.310061im    -0.014306-0.0873388im     0.0708161+0.133486im     -0.0409271+0.0490614im       0.33038-0.134087im      0.128831+0.136471im     -0.0396257+0.305088im       -0.240561+0.194677im     -0.0160459+0.0307319im    0.0855944+0.186951im     -0.222912-0.00558624im   -0.0584102+0.0486123im    -0.084294+0.0189955im   -0.0452059-0.046938im        0.208657+0.107172im    -0.0570568+0.0353577im   -0.0663535-0.0659052im
 -0.0900358-0.0911757im     -0.136154-0.0423157im     0.0167763-0.0573945im     -0.040563-0.168143im      -0.0165777+0.0521748im    -0.132155+0.041435im     -0.134623+0.000900693im     0.071172+0.146712im      0.0369713-0.107519im      -0.148668-0.196422im      0.0389052+0.114232im      -0.333677-0.210026im   -0.0405978-0.0759473im   -0.00976273+0.040099im       -0.21123+0.294587im    -0.0248753-0.132941im    -0.036814-0.0179128im     0.0181133+0.0886674im    -0.0556023-0.038496im      -0.106333+0.010842im      0.207765+0.0200015im    -0.0362071-0.272235im       0.0576068+0.0782953im     0.0245178+0.152369im    -0.0641314+0.0354362im    -0.218587+0.0325626im      0.115056-0.187043im    -0.0926873+0.0523086im    -0.188239-0.205144im       -0.194849-0.0643369im   -0.0560893+0.0161065im     0.186265-0.104059im
  0.0223085+0.0738756im     -0.168499+0.0170879im     0.0607988-0.0573582im   -0.00404677-0.0150486im     -0.0141082+0.191195im    -0.0333338+0.0929991im   -0.0237463+0.222115im       -0.285903-0.0386644im     0.0273673-0.0996377im   -0.00884917+0.209119im      -0.224202-0.0597861im   -0.00289495+0.104773im    0.0540062-0.0756433im     0.0374831+0.165928im       0.187537+0.086835im    -0.0416796+0.165583im     0.113925-0.198184im     0.00985059+0.0528485im    -0.0175322-0.13493im        0.147885-0.047388im    -0.0361851-0.0217047im     0.0266099-0.184307im       0.0204259+0.222304im     -0.0368801-0.186072im     -0.176295+0.0624556im  -0.00573954-0.436986im      0.0704348-0.0444502im    0.0436907-0.0309158im   -0.0385716-0.192808im       0.0627579-0.00705191im  -0.0695767+0.13765im     -0.0956048-0.135376im
 -0.0403898+0.109504im       0.235216+0.0223536im    -0.0654748-0.111738im     -0.0760939-0.208594im        0.418737+0.0280244im     0.168998+0.150519im     0.0486045+0.21507im        0.0463293-0.08371im     -0.00161683+0.0993383im     -0.040816+0.0465304im      0.147318-0.0711714im    -0.0291145-0.215951im    0.0901705-0.206606im      0.0547015-0.184006im      0.0554967-0.172287im     0.0258871+0.0237409im  -0.0466234+0.0811232im      0.165134+0.10095im       -0.178649-0.0241178im     -0.141684-0.00592645im   0.0126478-0.119376im       0.143295+0.12435im        -0.110354+0.0260941im      0.209566-0.00561427im  -0.0272755-0.113752im      0.058643-0.1186im        0.0341311-0.125196im     0.0454228-0.116124im      0.116818-0.15031im        -0.216168-0.0762682im   -0.0500023-0.0115697im   -0.0445946-0.0820201im
 -0.0206841+0.0301779im     0.0620227+0.0772399im     -0.445803+0.0392828im      0.148276-0.00226687im  -0.000815232+0.173623im      0.216294-0.244818im     0.0248956-0.0283062im      0.0702989-0.0383758im      0.016374+0.0209205im     -0.227454-0.023525im     -0.0682404+0.00430651im    -0.179725+0.0746396im   -0.221412-0.0380698im      0.249519-0.0232721im     0.0834986-0.138339im    -0.0665496-0.0885138im  -0.0812364-0.284175im      -0.166668-0.0706925im      0.104739-0.00537824im    -0.117325+0.0913172im     0.106183-0.0273148im     -0.058243-0.0753567im     0.00340449+0.158544im      -0.126394+0.127528im    -0.0590699-0.230948im     0.0474912-0.0976938im    -0.0237356+0.0424407im    0.0371094+0.0274209im      0.11999-0.077026im       0.0621365+0.0727561im    0.0100853-0.172516im     0.0371952+0.0955044im
   -0.13947+0.248001im      0.0484218+0.0916498im    0.00880917+0.200373im       0.202356-0.262235im        -0.15955+0.0367784im    0.0115722+0.110397im      0.187489-0.0697704im    -0.00224605+0.0203701im     0.0281648-0.0889008im     -0.187018-0.133552im       0.152427-0.080104im      -0.209309-0.0227415im    0.178138-0.0102252im    -0.0271527-0.00250897im   -0.0332243+0.0376931im    0.0191139+0.282958im    0.0227672+0.0722444im     0.0469134-0.132494im      0.0323596-0.126457im       0.194604-0.00969594im   -0.040493-0.0903854im       0.15002-0.042362im       0.0327213-0.0103921im    -0.0355276+0.0572254im   0.00160386+0.0887772im    -0.205658+0.0184429im     -0.324412+0.0210264im   -0.0637477-0.0745023im     0.227296-0.0503019im       0.101192-0.0275144im     0.224387+0.0878094im   -0.0386532+0.129919im
   0.235815+0.0710956im     -0.164891-0.0667199im    0.00910618-0.0415939im     -0.116245-0.0335809im      0.0846936+0.31139im      0.0763607+0.0479256im    0.0368897-0.0271497im      0.0129456+0.0409043im     -0.110768-0.0469014im     0.0733253-0.12926im         0.10564+0.0308413im    0.00956691+0.1217im      -0.103308+0.290796im      0.0420591-0.0486956im     -0.265585+0.0497398im    0.0887865-0.0725217im  -0.0243506+0.135437im       -0.16872+0.0315503im    -0.0230566-0.0193572im     -0.245289+0.0885059im   -0.0897848+0.0194822im     0.0579856-0.044071im        -0.15683+0.313685im       0.122286-0.0977799im    0.0454802+0.206336im     0.0378877+0.0014773im    -0.0966489-0.175365im        0.2107+0.107027im      0.215233+0.0226959im      0.0542468+0.0496147im    0.0624857+0.134895im     -0.156014+0.081718im
 -0.0807431-0.0499361im     0.0904096+0.133692im       0.114479-0.284988im      0.0227896-0.112174im       0.0793839+0.0288212im     -0.20842-0.037673im      0.139259+0.115624im      -0.0243434+0.055315im     -0.0562687-0.178937im      -0.111076-0.107639im      0.0553804-0.246251im      -0.064854+0.0613382im   -0.192365+0.258331im      0.0305592-0.228796im      -0.119392-0.0202867im    0.0946173-0.0805777im    0.122644-0.0910935im      0.062469-0.208101im      -0.115616+0.0459997im     0.0394256-0.038451im     0.0908067-0.0425579im     -0.175194+0.0342036im       0.152276-0.192956im     -0.0103932-0.276027im      -0.18661-0.0170872im     0.120984-0.115541im       0.166357+0.0338332im    -0.106196+0.0104357im     0.109878+0.0714559im      0.0651499-0.0613329im    0.0251287+0.0410771im      0.13695+0.184181im
   0.214275-0.0191065im     0.0719577+0.0520914im     -0.110626-0.0307382im      0.109748-0.0311837im     -0.0105307-0.0801821im    -0.202274-0.0324403im    -0.121878+0.186072im         0.10695+0.010019im         0.1426-0.181757im      0.0779394-0.0263974im      0.202065-0.141159im     -0.0850795-0.0575584im   0.0988015+0.0109096im     -0.169373-0.094916im        0.21923-0.0641439im     0.129582+0.0456885im   -0.157199-0.136307im      0.0526527+0.0118492im    -0.0272142-0.0428842im     -0.111051+0.00279318im   -0.181661+0.178286im       0.181227-0.210841im         0.09891+0.00539367im   -0.0912142-0.127248im     0.0433968+0.13506im     -0.0895198+0.0437577im    -0.0228487-0.030041im      0.205616+0.178259im     0.0865206+0.139462im        0.102435+0.128522im    -0.0958601-0.313339im      0.114861-0.20604im
   0.211556+0.129416im      0.0300702-0.120712im      0.0405601-0.0426512im      0.215017+0.0991766im      0.0534312+0.224041im    -0.0257788-0.18145im      -0.031806-0.0165639im       0.214378-0.18375im       0.0326841+0.109269im      0.0554463+0.025766im      -0.281358+0.044439im       -0.14822+0.0802458im      0.2058-0.0400614im      -0.13209+0.153026im     -0.0359974-0.0968645im   -0.0354404+0.0105086im   0.0374073+0.020493im      0.0648039-0.130867im     -0.0365764-0.0472932im   -0.00623478-0.0819159im     0.247224+0.0209988im    -0.0265209+0.107513im        0.296942-0.026979im       0.152283-0.105156im     0.0329456+0.164113im    -0.0713151+0.0962352im      0.146123-0.225441im     -0.132659-0.162497im      0.168075+0.0356806im      -0.123769+0.184673im    0.00954319-0.0514709im  -0.00439311+0.0446093im
  0.0970424+0.0409642im    -0.0363449-0.0521732im     -0.128733-0.0148922im     0.0641562+0.101012im        0.156488+0.288271im     -0.125775-0.197579im      0.146301-2.81189e-6im    -0.0730229-0.0305079im      0.122588-0.204193im      0.0606237-0.0471554im      0.104811-0.101878im        0.12867+0.0852798im   -0.170296+0.0323082im     -0.312227+0.127979im       0.249492+0.158465im      0.152626-0.0179777im  -0.0801506+0.164702im      0.0288457+0.0320863im      0.111104+0.149002im       0.100048-0.0128775im     0.208326-0.0903172im      0.167329-0.00230876im      -0.16296-0.108488im     -0.0313386+0.0544695im    0.0221949-0.235104im     -0.159541-0.0232742im    -0.0513194+0.0335858im    0.0476244-0.0257688im   -0.0700842+0.0333185im      -0.247129-0.156275im     0.0365897+0.102653im     0.0152199+0.082994im
   0.133047+0.291953im      0.0373431+0.0693487im     0.0724794+0.0282102im    -0.0242427+0.14397im        0.0815665-0.0708937im    0.0392015-0.0814862im     0.067555+0.166097im       -0.102915-0.263065im     -0.0967183+0.0330102im      0.131154-0.0953005im    0.00622823+0.130699im     -0.0669377-0.228909im    0.0792906+0.0678924im    -0.0312792-0.0278496im     -0.110886+0.146584im     0.0553707+0.0834606im    0.105358+0.0178879im    -0.0200118-0.17038im     -0.00283093+0.111923im      0.0661794-0.25117im       -0.03962-0.151862im      -0.305792-0.105524im      -0.0669063+0.0255348im    -0.0664966+0.164952im     -0.011257-0.212354im    -0.0410839+0.0424732im     0.0044421-0.0722428im     0.342241-0.0410385im   -0.0436035-0.0376787im       0.206307+0.0695128im   -0.0796654-0.014614im      0.218085+0.00330338im
 -0.0114637-0.169771im      -0.150055+0.167198im      -0.139574+0.117147im     -0.0147767-0.0762097im      0.0499686-0.0505976im     0.104336-0.0293868im    0.0944441+0.17221im         0.125831+0.190736im      0.0611041+0.0703205im     0.0830239+0.0633003im      0.163459+0.0193044im       -0.0478+0.146228im    0.0858317+0.0639466im     -0.174448-0.106111im     -0.0715668+0.0296316im     0.139106+0.174889im     0.309593-0.00375161im    -0.152331+0.0422736im   -0.00846901+0.0784009im    -0.0550927-0.165496im      0.186523-0.169816im      0.0819658+0.0188022im     -0.0296922+0.0670834im    -0.0865616+0.17876im      0.0855248+0.0730858im   -0.0134458-0.00305622im     0.296832+0.25647im       -0.12811-0.0726074im     0.106227+0.000937202im    0.0401976+0.249617im     -0.148418+0.105611im    -0.0651899-0.142277im
   0.155514-0.0489673im     0.0599445-0.275781im     -0.0729434+0.00349582im    0.0379882+0.113455im       0.0274317+0.225im        0.0542705+0.0662923im    0.0186288+0.111982im       -0.100895+0.052215im    -0.00930051-0.130946im     -0.0290633+0.0310929im    -0.0367566-0.0950519im    -0.0694531-0.192832im     0.168064+0.207702im        0.25968-0.192226im      0.0135597-0.0429228im    0.0605223+0.0291661im    0.171675-0.0783915im      0.129412+0.13715im        0.275788+0.326243im       0.147045+0.0878698im   -0.0592251+0.00594937im  -0.00909229-0.0955767im    -0.00806572-0.219422im       0.150782+0.172495im     0.0755204+0.0899277im   -0.0115871+0.0725908im      -0.01218-0.0350622im    -0.223188+0.0730124im   -0.0842383-0.107658im        0.124602+0.0220644im   -0.0145206-0.0652473im    -0.152745-0.0342737im
 -0.0589405+0.000666478im  -0.0301997+0.305409im      -0.202384-0.0696429im     0.0778941+0.121298im      -0.0998842+0.0504374im    -0.121961+0.0454299im     0.144079-0.0361065im     -0.0715557+0.0509054im      0.152946-0.0139623im      0.181837-0.00558372im   -0.0529621-0.0934882im      0.124052-0.0943757im    0.121628-0.184949im     -0.0626332-0.0591864im    -0.0995831-0.120793im     0.0995282-0.0866894im  -0.0102179+0.172721im      -0.219455-0.151004im     -0.0532006+0.0825204im      0.126411+0.0785976im     0.144991-0.026673im      -0.137224+0.000202567im    0.0976589+0.103703im       0.319111+0.0817271im    -0.135395+0.156345im      0.191661-0.0162582im     -0.178417+0.0430334im    0.0259671+0.261135im     -0.103685-0.209664im      -0.0588022+0.0143209im     0.113995-0.0978751im     0.013787-0.14182im
  0.0849513+0.154517im      -0.160765+0.0181057im     0.0142509+0.0916166im    -0.0483335-0.00319239im    -0.0371329+0.0428587im    -0.144603-0.180395im     0.0955116+0.0345898im      0.0864004+0.0796461im     -0.107552+0.154609im      0.0050041-0.191019im    -0.00576016+0.0109533im     0.0789519-0.0678678im    0.167865-0.0713048im      0.134024+0.0591721im     -0.078169+0.0859861im    -0.177346+0.0604597im  -0.0610631-0.161758im      0.0757876-0.025585im     -0.0646143+0.170999im     -0.0915964+0.115313im    -0.0697761-0.0461922im    -0.0606045+0.00434009im    0.00185925-0.157728im     -0.0252731-0.254625im     -0.192548-0.158137im     -0.138899+0.138512im      0.0716179+0.323913im       0.07481+0.198253im      0.194265-0.105206im       -0.198555-0.0728749im   -0.0301746+0.0489083im    -0.274323-0.211258im
   0.134718-0.074211im       0.276093+0.324067im       0.153955-0.0261699im      0.158377-0.0669688im       0.173981-0.0505716im     0.149343-0.0556552im   -0.0129352+0.017306im      -0.0633852-0.056733im       0.222731-0.0101192im    -0.0162166+0.193448im      -0.162862-0.0465905im     0.0304674-0.0221379im   0.0107736+0.0866494im     0.0808243+0.0408552im     -0.269721+0.242201im   -0.00308712-0.0716019im  -0.0691855-0.0458424im    -0.0500645-0.105585im      0.0319049-0.0652431im      0.119332+0.157352im     0.0532205+0.115022im     -0.0406028-0.13901im        -0.294047+0.0200942im   -0.00762457-0.00148984im   0.0300146-0.0486382im    -0.141835+0.0437447im    -0.0145899+0.00454444im    -0.15128-0.023678im     0.0515275+0.276681im       -0.046384-0.016806im     0.0468216-0.0174214im    -0.146783-0.248774im
  0.0393584-0.209367im     -0.0390024+0.106702im      0.0414798+0.0429506im    -0.0630001+0.213207im       -0.219612-0.00807614im    0.158255-0.11453im       0.212193+0.0689116im       -0.16384-0.146912im      -0.158297-0.135116im      -0.160011+0.035564im      0.0238022+0.181745im    -0.00612959-0.194322im    -0.109408+0.124497im     -0.0296204+0.000318538im    0.119696-0.021333im     0.0343963-0.060664im    0.0352636-0.0714629im     0.0597208-0.0447641im     -0.178215-0.302827im      0.0630703+0.170649im     0.0652268-0.162493im       0.110586+0.132362im       -0.167568-0.103685im       0.178663-0.0858975im     0.107618+0.208968im     -0.187842+0.111438im       0.134834+0.0556823im    0.0740831-0.00626974im   0.0842505-0.184764im       -0.030208-0.00700525im  -0.0251924-0.174043im     0.0637475-0.0228502im
   0.114339+0.244007im      -0.162688-0.0433943im      0.162137-0.192443im     -0.0333705-0.195904im      -0.0892079-0.0900046im    0.0855167+0.00354838im   0.0905042-0.201936im        0.115969+0.057811im       0.208913-0.197618im     -0.0647744+0.0311512im    -0.0607472+0.169109im     0.00980007-0.120037im     0.252902+0.108915im       0.090938-0.123962im       0.189066-0.124991im     0.0758194-0.207871im    -0.157759+0.0603712im    -0.0946387-0.087004im      0.0476948+0.00631im      -0.0342185+0.244257im      0.156766-0.206406im      0.0726247-0.021942im       0.0609073+0.0265184im    -0.0150379-0.0761612im     0.115453-0.12759im      0.0481385-0.0984938im     0.0780874+0.141366im     0.0620343-0.112875im     -0.159229+0.0682344im       0.126494+0.0917679im   -0.0976829+0.161927im     0.0187605-0.0788093im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.12371201167490728 + 0.2812622981888257im
  0.042664924943180325 + 0.02569725303541824im
  0.019114925227824434 + 0.004317966552644753im
  -0.17055901129493675 - 0.15639890241209595im
 -0.012172726669414102 - 0.058576221192462696im
  -0.06310589285444305 + 0.009634497985483626im
  0.013020360388929921 - 0.032229828243657645im
    0.1861809581366877 + 0.21834275725348185im
  -0.11781779665813263 - 0.03190363439588432im
  -0.13434255003504075 + 0.12252902506380164im
   0.20414429219308555 + 0.17315381964988646im
  0.049456923932085735 - 0.14189196992286177im
  -0.07298143976040383 - 0.1990459000268145im
  -0.09115759713104075 + 0.00139226333162484im
  -0.09509410420991303 - 0.061230257523789765im
    0.0962371639304159 - 0.17646774121254583im
 0.0010638009388283035 - 0.06391568795092432im
   0.09860378549280356 - 0.025409313589683992im
    -0.063299143308135 + 0.05107728292509907im
  -0.14118348186112734 + 0.19911055503247738im
  0.018257020189465616 + 0.17937334281458167im
   0.03634186616697462 + 0.12753369340319345im
   -0.0575960510585278 - 0.048331133681408754im
   0.02178953143908348 + 0.10324406293974944im
    0.3425638866831231 + 0.0im
  -0.13386883830124408 + 0.15626803751776652im
 -0.055085948925483574 - 0.0841849576962613im
 -0.024951282232209118 - 0.20875621557433152im
   0.10691122047758991 - 0.12790297616647925im
  0.009154960091304596 - 0.1339675997667979im
  0.013211696875365081 + 0.15193571422191496im
   0.05824627191535149 - 0.2744233523337903im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Monday 3 March 2025 23:24">Monday 3 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
