<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor Network Backend</a></li><li><a class="tocitem" href="../../../man/paulipropagation.html">Pauli Propagation Backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.156791+0.016212im     0.0158186-0.0981521im      0.0479512+0.0844168im     0.251907+0.0864439im      0.16329-0.108009im     -0.0692153-0.264938im    -0.0188142-0.0917685im     0.0990432-0.00245198im   -0.0126416+0.183182im     -0.055971+0.193315im       0.158202+0.0395083im      0.137319-0.0155854im   -0.0252575+0.133602im     -0.0479165+0.0458282im    -0.0635035-0.0994829im     0.0115029-0.226544im      0.0801346+0.265546im      -0.208771-0.0660567im     0.163496-0.0593182im     0.0941527+0.0562485im      0.074113-0.00596867im     0.0196788-0.113267im      0.0245297+0.0192864im    -0.0974785+0.0216396im     0.0574616-0.133543im    -0.0455015-0.261088im      0.0304719+0.0933656im     0.210298-0.0324431im  -0.0304388-0.0371789im    0.0837448+0.232803im      -0.110787+0.0660545im      0.301612-0.17482im
   -0.145622-0.107121im    -0.0348941-0.0839481im      -0.128891-0.0971562im     -0.14921-0.4194im      -0.0528096+0.0581351im   -0.00628936+0.0814304im    0.0837438-0.0719123im    -0.0972472-0.0291545im      0.102818-0.0565331im    0.0201393+0.320369im      -0.108027-0.0683714im      0.185572+0.0430418im     0.121292-0.000305954im    0.103026-0.0693481im    -0.0616325+0.185067im      0.0694109-0.00918656im    -0.102667+0.13654im       -0.164389-0.0410545im    0.0359773+0.130809im     -0.0564353+0.122656im      0.0860181-0.0476466im     -0.0363963-0.0926942im      0.273482+0.0883713im     0.0925107-0.0630337im     0.0750739+0.0132527im   -0.0887902-0.223458im    -0.00609993-0.0451992im    0.0673761+0.0553451im    0.183578-0.174876im     -0.030277+0.193868im      0.0380813-0.155134im      -0.117322+0.179885im
  -0.0248794-0.247405im     -0.303079+0.149539im        0.134945-0.063816im     0.0533744-0.116375im     0.0249623+0.169323im       0.102986-0.0243702im    0.0345764-0.00402455im   -0.0332368+0.0178502im     0.0110226-0.104258im     0.0531806-0.00430533im    -0.118992+0.0689031im     -0.218858+0.0085585im    -0.186396+0.193996im       -0.26786-0.178815im      0.0519954+0.0677502im      0.185596-0.0393085im    -0.0316832-0.0581819im     -0.026523-0.0744244im    0.0560041-0.0346217im     0.0815924-0.0627826im    0.00575979+0.0222938im      0.0335068-0.0571764im     -0.100261-0.0535127im     0.0279665+0.24077im      0.00339293-0.267585im      0.155058+0.0842176im      0.141745-0.00665704im   0.0793838+0.0383331im  -0.0892769-0.0831613im    0.0586556+0.163355im      -0.094855-0.317465im      -0.126996-0.19574im
   0.0368149-0.0180392im    -0.244924-0.00527811im    -0.0214126-0.00503739im   -0.140606-0.135414im     -0.121213-0.317836im      0.0526686-0.085601im     0.0599831+0.168539im       0.206156-0.211362im     -0.0580587-0.20067im      0.0338348-0.182496im     -0.0299383+0.105263im      -0.190034-0.00526313im  0.00662462-0.133769im       0.107655-0.00432943im   -0.0859617+0.0299201im      0.099395+0.270822im     -0.0626613+0.0910507im    -0.0425251-0.173866im      0.213001-0.0543766im    -0.0485097+0.0111333im    -0.0941407+0.0259018im      -0.119617-0.0303916im    -0.0474125+0.122508im     -0.0275918+0.125796im     -0.0725559+0.112114im    -0.0436413-0.136355im      0.0578092+0.0411829im   -0.0309684-0.141695im    0.0392445+0.260316im     0.0616482+0.178211im      -0.176889+0.0747463im      0.180191+0.123207im
    0.014223+0.300456im     -0.250627+0.00559391im      0.071221-0.0298986im    0.0341897-0.149791im      0.119444-0.23897im       -0.076806-0.209021im     0.0728272-0.0125145im     -0.190698-0.0948628im     0.0886609+0.178021im     -0.055656+0.132867im      0.0640919+0.201426im      -0.191393+0.0450789im    0.0436351-0.0256772im    -0.0522362-0.0797429im    -0.0930682+0.00667113im   -0.0476664+0.0612132im     -0.143465-0.138525im       0.164544+0.0501157im     -0.24272+0.118744im       0.186831+0.116956im     -0.0322234-0.117875im        0.095684+0.0741924im     0.0593014+0.0757548im       0.18493+0.0174797im      0.144734+0.0458237im    0.0434209+0.069164im      0.0383642-0.13627im       0.100717-0.0973036im  -0.0562633-0.174987im       0.13102-0.198691im    -0.00949655-0.0598612im      0.197781+0.0916234im
   0.0229653+0.00734991im    0.090643-0.0195698im      -0.118967-0.309004im     0.0123785+0.156755im    -0.0788496-0.0897877im      0.145069-0.0139774im     0.102183+0.00941866im  -0.00617003+0.122856im      0.0255932+0.122883im    -0.0535512-0.106072im       0.108478-0.335279im       -0.12876-0.0117002im     0.217664-0.0826774im     -0.130268-0.00220429im     0.010077-0.0612466im     0.0425617+0.0139314im     -0.011137-0.107782im     0.00807009-0.124767im     -0.108412+0.149767im      -0.096604-0.0153752im      0.101535+0.0770207im      0.0449667-0.0705737im      0.051266-0.103122im     -0.0740497+0.160696im      0.0402928-0.0522926im    -0.227118-0.153793im       0.375468+0.168133im      -0.23867-0.0148643im  -0.0597668-0.207845im      0.136068-0.00754596im    -0.113189-0.0960126im     0.0822061+0.0914821im
   0.0198788+0.196843im     -0.180295+0.0333677im       0.116695+0.212496im      0.182519+0.0534682im    0.0757275+0.187755im     -0.0826948+0.286998im    0.00114483+0.124624im      0.0171303+0.0718646im    0.00139528+0.0738375im      0.13063-0.0823603im     0.0271693-0.0230408im     0.0423883-0.115901im       0.08683-0.0737596im     -0.165819-0.0661945im     -0.022404+0.0985704im     -0.079497-0.0348926im    -0.0401182+0.101382im     -0.0629611-0.228914im      0.026762+0.147886im      0.0696113-0.136238im      0.0103129-0.0605239im      -0.346003+0.0483261im     0.0224117+0.242485im       0.226695-0.0276111im     0.0752176+0.226564im     0.0245993-0.0713154im     0.0414908+0.146214im     -0.129142+0.261525im   0.00580839-0.0536367im     0.151525-0.0133246im     -0.120251+0.0462931im    -0.0319349-0.0815468im
  -0.0301288+0.0878334im     0.041928+0.11741im         0.181256+0.0151203im    -0.242685+0.0302457im   -0.0664916+0.034644im      0.0198373+0.0806001im   -0.0430945+0.0605274im     0.0665002-0.082354im        0.19796+0.25936im      0.0135254+0.124847im      0.0506632-0.059121im     -0.0482323-0.141958im     -0.212568-0.166817im       0.127472+0.0250686im    -0.0791477-0.416946im      0.0340959-0.156897im      -0.175935+0.110705im       0.187791-0.0695795im    0.0802649+0.00334194im  -0.00908037+0.171319im       -0.10743-0.06472im         0.116344+0.171069im     -0.0394542-0.0103522im      0.126623-0.0305639im    -0.0970896-0.0710154im   -0.0731845-0.131979im       0.077295-0.0947735im    -0.117033+0.0634486im  -0.0333675+0.111436im      0.141143+0.212781im        0.06327-0.0890946im      -0.20996-0.0782402im
     0.09691+0.110201im      -0.01052-0.0926241im      0.0065385+0.03681im      -0.204974+0.0315319im  -0.00779412+0.0308119im    0.00297241-0.169275im      0.157567-0.0167782im     0.0693306+0.239941im      0.0476917+0.0402876im    -0.132028+0.0356209im    -0.0132237+0.00549794im     0.149318-0.0865691im    0.0856265-0.0199896im    -0.0542211+0.104408im      -0.128836+0.405852im       0.133049+0.173474im      0.0770507+0.0533849im      0.132168+0.10759im      -0.103979-0.0893367im     0.0651047-0.0397281im     -0.137242+0.12155im         0.161723-0.0197055im    -0.0913383+0.00531545im     0.213118+0.0560763im    -0.0857016-0.0808944im    0.0734785-0.0384629im       0.12778+0.169im        0.0836254+0.208879im    -0.189642+0.134124im      0.169144+0.18043im        0.225828+0.173268im      -0.113494+0.0103206im
   0.0883557-0.0385963im     0.113866-0.0247588im     -0.0938211+0.187254im      -0.19283-0.156823im      0.118668-0.0307754im    -0.0652536-0.160905im    -0.0528342+0.108796im      0.0201971-0.0512083im     -0.139572+0.091429im     0.0507812+0.00294493im     0.134046-0.218356im     -0.0203248-0.110437im     0.0954969+0.0913156im     -0.234675+0.159849im      0.0393266+0.014125im      -0.059256+0.0289056im     -0.150642-0.239569im       0.143683-0.177178im      0.214162-0.159855im       0.173569-0.00579415im    -0.178243+0.175262im      -0.0654734-0.0689625im     0.0739987+0.123006im       -0.21249+0.00541582im    0.0576815-0.104015im    -0.0454928+0.124401im     -0.0316679-0.239539im    -0.0122261+0.225509im     0.254301-0.101218im     0.0678086-0.00766853im      0.06098-0.0130364im   -0.00618635+0.0138558im
   -0.119282-0.0781408im   0.00646482+0.272638im        0.159459+0.0589516im    0.0505647+0.131734im      0.209736-0.0762344im     -0.176119+0.0159634im    -0.143656+0.0398168im    -0.0905138+0.0632864im     0.0813939-0.114196im     -0.215252+0.109649im     -0.0154852-0.315656im       -0.14798-0.0121554im    0.0633585+0.0605583im     0.0689524-0.116664im       0.106421-0.0254195im     0.0340235+0.174254im      0.0815482+0.106668im     -0.0276709+0.181687im     -0.155839-0.109177im     -0.0342879+0.175197im      -0.181225+0.000447948im    -0.134369-0.145924im      0.0956018+0.202402im      0.0378755-0.0733262im      0.066242-0.101032im     -0.106676+0.0945891im    -0.0308612-0.0376545im     -0.10527+0.146212im    -0.175799+0.127572im     -0.143947+0.169024im      -0.062754-0.0729352im      0.164483+0.141335im
   0.0324492-0.160151im    -0.0990958-0.0527512im       0.267903-0.133576im    -0.0121526-0.0914771im    -0.117493+0.119767im      -0.054191-0.155935im    -0.0953829-0.0867777im     0.0698424+0.0955704im     0.0127464-0.10946im      -0.133988+0.113524im        0.13787+0.060019im       0.133394+0.0204077im    -0.126522+0.0466319im     -0.100522+0.202166im     -0.0553313-0.154454im    -0.00891589+0.253571im      0.0140633+0.0690728im      0.246669-0.0604921im    0.0295454-0.0968173im     0.0636118+0.209212im        0.30948+0.116665im       -0.305586-0.0210966im    0.00512869-0.222488im       0.024498-0.153704im      0.0970833+0.149697im    -0.0151661+0.131436im      0.0419996+0.0945956im   -0.0474144+0.0197284im  -0.0389032-0.0952109im    0.0633083-0.0541722im     -0.146246+0.0815861im    -0.0680324+0.121974im
   0.0485148-0.0923385im    0.0587876+0.202785im       0.0870278+0.124324im     0.0556879+0.0218918im   -0.0424196+0.0807133im    -0.0319764-0.112905im     0.0460864+0.053221im      0.0100638-0.0497944im      0.194053+0.145434im     0.0664951+0.0601338im    -0.0582676+0.231122im     0.00382667-0.153996im      0.145237+0.104994im       0.177656-0.0145942im      -0.16097+0.202763im      0.0377971-0.0142544im     -0.163374-0.353412im     -0.0665865-0.0188802im   -0.0241066-0.0886712im     -0.272661+0.0596024im   -0.00597337-0.0935024im     -0.0181374-0.037548im       0.163083-0.287098im      -0.139981-0.180223im      -0.114812-0.0115461im     0.103608-0.0617113im     0.0204089+0.0836689im    -0.167672+0.202159im   0.00865325+0.102885im      0.051594-0.037188im       -0.21445-0.0442005im      0.157974-0.0466733im
    0.160845-0.0486143im    -0.024793-0.149912im       0.0338106-0.292377im    -0.0498497-0.0372002im     0.138105-0.0783296im     -0.176478-0.17683im     -0.0276244-0.0553109im     -0.318115+0.285827im        -0.1851+0.152128im      0.146451-0.00765383im    -0.217772+0.0149656im     0.0557929-0.0480824im    -0.247397+0.0643396im      0.151453-0.0757885im      0.249537-0.00810954im   -0.0570424+0.0537934im     -0.116022-0.040336im      -0.109669-0.0156511im    0.0574866+0.0143012im    -0.0837141-0.0314371im     0.0373349-0.0239865im      0.0534918+0.0497868im     0.0445704+0.134707im       -0.12112+0.0972886im     0.0931813+0.171303im    -0.0224477-0.0116019im    -0.0613643-0.0291591im     -0.16759+0.0995785im  -0.0690369+0.22292im       0.187853+0.0238388im     -0.104779+0.0687585im     -0.105599-0.0211652im
    0.155788-0.0162773im   -0.0637164+0.142407im        0.218283+0.0739175im   -0.0240974+0.0463176im    -0.108607-0.116392im    -0.00214717-0.0754217im   -0.0788693+0.060005im       0.148454+0.306472im      0.0846751-0.0503653im     0.180188+0.0991851im     0.0794345+0.0514754im    -0.0437682+0.296767im     0.0279638-0.131064im      -0.129479-0.00658772im   -0.0610704+0.0153359im      0.102645-0.175915im      0.0934245-0.221406im      -0.176059-0.0125657im   -0.0021193-0.0107645im     -0.109007+0.125604im       0.133007-0.184571im       0.0348516+0.0803696im     -0.104754+0.196624im      -0.175993+0.108914im      -0.151111+0.159857im    -0.0917762+0.0950244im    -0.0987067-0.0381764im   0.00490712+0.0631803im  0.00688537-0.175456im    -0.0283207+0.156031im       0.218081+0.0563869im    -0.0395333+0.222199im
   -0.231747+0.15188im      -0.258675+0.0805875im     -0.0509007-0.0148418im    0.0477203+0.111681im      -0.12388+0.00789353im   -0.0687844-0.243511im    -0.0107059-0.0454726im    -0.0392828-0.0113362im      0.218464-0.200488im      0.112122-0.0764823im    -0.0874505-0.277001im      0.0436795-0.0111154im   -0.0539731+0.0507066im     -0.103596-0.141226im    -0.00569803-0.110057im      -0.147626-0.140272im       -0.13904-0.174883im      0.0691307+0.124305im      0.051421-0.0734113im    -0.0457537-0.217976im       0.106421+0.177848im      -0.0125585+0.087353im       0.090586-0.0887272im    -0.0302562-0.10532im        0.153559+0.104659im      0.178608-0.234735im      0.0664461-0.0672119im     0.104567+0.010633im    0.0155996+0.0502915im   -0.0765842+0.179646im       0.123784+0.243799im      0.0141352+0.0493656im
  -0.0368025+0.0413357im    0.0628585-0.112506im        0.107542-0.137972im     -0.115942-0.0938182im    -0.201445+0.107363im       -0.16444+0.11819im      0.0821377-0.100106im     -0.0212917+0.248481im      -0.126094-0.0298146im    -0.285545-0.0932094im     0.0798032+0.169926im     -0.0166419-0.139411im     0.0839507-0.00186825im     0.119021-0.235037im      -0.137104-0.0561361im     -0.241561-0.190313im     -0.0194818-0.225492im      -0.112908-0.171182im     0.0898598-0.0743065im     0.0110491-0.0411183im    -0.0454628+0.181751im       -0.136584+0.11014im      -0.0574934+0.146285im      0.0457951-0.100468im      -0.078392-0.137685im     -0.109623+0.0841571im      0.120118-0.0938141im     0.202341-0.057618im    -0.164338+0.03935im      -0.106934+0.0673328im    -0.0258401-0.0733353im      0.153336+0.0566584im
   0.0289474-0.0349465im     0.202017-0.270139im       0.0768834+0.0562072im     -0.10042-0.162722im     -0.178708-0.0347182im     0.0874781+0.0613621im   -0.0538846-0.0373976im      0.068408-0.0915215im    0.00423931+0.00272042im  -0.0139239-0.109267im      0.0187571-0.105342im      -0.186769+0.130141im    -0.0854884+0.207289im     -0.0732742-0.187362im       0.212156-0.0503623im   -0.00613871+0.139645im      0.0241423-0.0728582im     0.0631217+0.00922605im   -0.046491-0.143884im      0.0579463-0.13724im        0.209594-0.33309im        0.0539241-0.0592742im    -0.0535469+0.0387361im      0.151523-0.221572im      -0.131929-0.0416169im    0.0130776-0.260295im      -0.118748-0.0283811im   -0.0186491+0.246806im    -0.147905-0.0604814im     0.116559-0.00584879im    0.0567352+0.0298991im      0.208673-0.0237315im
    0.220364-0.0774708im   -0.0351714-0.152147im       0.0570656+0.115027im    0.00664978+0.0699262im   -0.0945739-0.0407297im     0.0172795+0.0189077im     0.248761+0.163254im      0.0901112+0.143929im      -0.090365-0.135148im     -0.186224+0.141091im     -0.0688465-0.103281im      -0.114959+0.00564719im    0.235212+0.063606im      0.0247838+0.00696609im     0.109355-0.0349065im    -0.0860285-0.195612im     0.00892122+0.0183156im     -0.106168-0.0171949im    -0.074273-0.0748936im      0.118499+0.00785952im    -0.183933-0.206909im     -0.00936277+0.0145464im    -0.0946379-0.295697im      0.0846516-0.0925695im      0.305582+0.0927514im     0.177469-0.00899505im   -0.0631553-0.195809im      -0.15689-0.181143im    0.0637665+0.0485536im     0.117031+0.132489im        -0.1034-0.00838027im    -0.167438+0.0799175im
 -0.00235583-0.245271im    -0.0460887-0.000996306im    0.0274298-0.0167428im     0.067498-0.024161im      0.172485+0.0368137im    0.00787207-0.0203038im   -0.0150963-0.0448493im     -0.225457-0.0589865im    -0.0525383-0.178836im     -0.135159+0.0196852im      0.227661+0.0841495im     0.0161311-0.0659446im     0.251589-0.263411im     -0.0602364-0.116365im     -0.0832827-0.145624im     0.00530171-0.0994703im     0.0789031+0.0963587im       0.12824-0.0645541im     0.159212+0.040281im     0.00500126-0.230701im       0.115239-0.105601im        0.107868+0.0276135im      0.247172-0.188172im      0.0340443+0.246078im       -0.12193+0.057945im     0.0513115+0.0322663im     -0.142531-0.0923583im   -0.0553193+0.192509im   -0.0923905+0.205205im      0.136602-0.0319997im      0.200373-0.0124344im     0.0941921+0.129686im
    0.110849-0.100044im     -0.117902-0.154428im       -0.291432-0.0606973im    0.0270249+0.165775im      0.011017+0.0256346im     -0.181727-0.0164047im    -0.112907+0.219347im      -0.170505+0.0544403im     0.0568638-0.202736im    -0.0863714-0.0771973im      0.105293+0.148786im      -0.105712+0.102641im    -0.0637612-0.205891im      0.0365587+0.252915im     -0.0092682-0.00301092im   -0.0748094+0.0246146im     0.0996601-0.102211im     -0.0269522+0.224103im    -0.0107424-0.0378417im      0.135636+0.112387im     0.00856351+0.0124431im     -0.0451858+0.267032im         0.0269+0.0890443im   -0.00658206-0.148647im     -0.0973565-0.119873im     0.0893574-0.279285im      0.0307613+0.0474793im   -0.0170414+0.176577im    0.0995638-0.0976283im    0.0146783+0.0744317im    -0.0919586-0.264919im     -0.0381687-0.0856916im
  0.00914251+0.226048im     -0.106888-0.00661936im    -0.0446623-0.0404979im    0.0293405-0.136418im      0.035305-0.0594384im    -0.0887138-0.00691219im    0.480958-0.0298302im     0.0877101-0.0320099im     -0.021553-0.0871866im     0.100106-0.0397357im     0.0818285-0.126002im       0.088197-0.17909im       0.126377+0.0414763im     -0.117436-0.0225859im   -0.00507603-0.168146im       0.206381-0.030299im       0.062473-0.0124203im     -0.118289+0.142997im     0.0604391-0.128399im       0.028822+0.209969im       0.216229+0.147724im        0.100175+0.0314437im     -0.109618+0.0483885im    -0.0552839-0.0830347im    -0.0637919+0.101034im    -0.0378639+0.00243027im    -0.232793+0.0176937im    -0.118282+0.130362im     -0.15305+0.133564im     -0.120146-0.162729im     -0.0270393-0.263951im     -0.0450444-0.106977im
 -0.00657571+0.0601946im   -0.0463521-0.0734665im    -0.00299023-0.0988142im    0.0949992+0.12291im      0.0381988-0.276616im        0.06597+0.0608853im   -0.0262997-0.190541im       0.127811-0.0757585im     -0.136935+0.10324im      0.0632648-0.101021im       0.125955+0.141478im       0.134838+0.0650125im    -0.170547+0.0295957im     -0.063058-0.0437076im     -0.124447+0.158519im      0.0446539-0.0114126im    -0.0387627+0.0187223im  -0.000175387-0.0374514im    -0.265894-0.116509im      0.0485245-0.095771im      -0.112618+0.00343805im     -0.317845+0.0216746im      0.115227-0.222055im      -0.057117+0.0475198im     0.0174497-0.00521524im   -0.163074-0.172469im     -0.0227751-0.34502im      -0.113517+0.153628im    -0.120238+0.043954im     -0.193055+0.107935im       0.100088-0.161098im      -0.181062+0.0339188im
   0.0474173-0.045087im     0.0785047+0.0661626im       0.106591+0.0259034im    -0.229303-0.145524im     0.0448989-0.0206265im     0.0587003-0.0294203im    -0.119281+0.0673787im      0.112261+0.106636im      0.0693808-0.124564im     -0.104245+0.109403im     -0.0979927+0.128761im      0.0485484-0.177835im    -0.0376443+0.0986897im    0.00484485+0.0943611im    -0.0805046-0.119087im      0.0150727-0.0353516im     0.0390964+0.124852im     -0.0772086+0.232854im     -0.184305+0.0964425im     0.0330465-0.375294im    -0.00482699+0.159846im       0.0895564+0.0191738im     -0.165406+0.0211478im    -0.0398023+0.106498im      0.0218278+0.345561im    -0.0502438-0.0670469im      0.159141-0.161224im     -0.142499+0.13266im      0.129997-0.120856im     -0.104779-0.0403823im    -0.0610681-0.136129im       0.261458-0.127564im
   0.0809531+0.102239im      0.124663+0.0694576im      -0.138318+0.0789098im    0.0376937-0.0151705im   0.00196858+0.0446834im     0.0560885+0.048048im     -0.268201-0.120849im      0.0296443-0.0699322im   -0.00512847-0.00243738im   0.0455651+0.261259im     -0.0202202+0.0561376im     -0.155925+0.26623im       0.188326+0.102994im       0.172657-0.0604543im     0.0228783-0.041982im       0.049726+0.0606711im     -0.058319-0.151475im     -0.0364022-0.00176548im    0.236268-0.205965im       0.108194-0.0374905im    -0.0695933+0.238026im      -0.0365537+0.127026im     -0.0727965-0.0834976im     0.0995673+0.155113im       0.239735+0.225549im     -0.115734-0.125668im     0.00370555+0.21669im      0.0443394+0.0297112im   -0.251865+0.0606639im    0.0413891-0.0910937im     0.0872786-0.174875im      -0.108618-0.006718im
  -0.0839565+0.198604im     -0.141768-0.0533596im       0.134701+0.0418468im    -0.169518-0.163157im    -0.0341852+0.0440122im     -0.227006-0.083427im     -0.210087+0.205386im       0.233305-0.140565im      -0.167443+0.062057im     -0.163379-0.0457892im    -0.0444509-0.044581im      -0.102601+0.199104im    -0.0547781-0.0300761im    0.00681455-0.0817576im     0.0553897+0.141765im      -0.189349-0.223809im       0.187356+0.12971im      -0.0799483-0.0659831im   -0.0573346+0.153399im      0.0199343+0.0957162im     0.0693331+0.120581im        0.195216-0.0706263im      0.165836-0.168845im      -0.195007+0.0423644im   -0.00137208-0.063353im     0.0708579-0.034771im      0.0633921+0.107502im     -0.108726+0.179652im   -0.0927056+0.0790439im   -0.0713042-0.174142im     -0.0483522-0.0040403im     -0.131234+0.0397059im
    -0.17797-0.0349776im   -0.0895228-0.125199im       0.0728822+0.11513im     -0.0673404+0.0725375im    0.0773213-0.291601im     -0.0497003+0.385183im     -0.144671-0.22769im       -0.120085-0.122054im      0.0680276-0.172186im    -0.0680071-0.0708379im     0.0292229+0.0919307im       0.18857+0.038928im     0.0171418+0.0606086im    -0.0955482+0.180666im    -0.00942042-0.043771im      0.0212874+0.0391387im   -0.00192005-0.19817im       -0.206017-0.162581im    -0.0131373+0.0622975im    -0.0434945+0.148688im      0.0300122+0.120884im        0.317549-0.0751801im    -0.0930999-0.0189168im    -0.0250499-0.102275im       0.167886+0.0169377im    0.0813598+0.0934294im     0.0986151-0.0425632im   -0.0979186+0.0765141im  -0.0739359-0.0037404im     0.207802+0.14373im     -0.00661479+0.0739633im     0.0267467-0.0801246im
   -0.248281+0.0259145im    0.0819897-0.0572133im       0.190818+0.238509im    0.00454241+0.12244im      -0.235919+0.0325644im    -0.0189434-0.101302im      0.130284-0.212551im     -0.0805562+0.129515im     -0.0290064+0.083362im      0.194561-0.0224123im      0.081878-0.0315581im    -0.0426645+0.128637im      0.145939+0.161319im      0.0322395+0.122295im      -0.015103+0.0247575im     -0.168142+0.264711im       0.131322+0.164079im    -0.00670505+0.0364162im     0.119037+0.142547im      0.0303741+0.040383im        0.02703-0.129429im       0.0326112+0.212041im      0.0627211+0.0494138im     -0.126762+0.116781im      0.0332124+0.0022091im     0.115294-0.00694382im     0.261115-0.150193im     0.0400083+0.0209947im    0.114626+0.225457im     -0.023494-0.0337001im   -0.00163625-0.275989im      0.0255304+0.00501646im
   0.0562308+0.157359im     -0.130659+0.162243im       -0.182284-0.0486753im   -0.0884734-0.156643im      0.114005+0.0567464im      0.236565-0.037151im      0.105682-0.0740996im     0.0629907+0.110585im       0.177915-0.0621056im    0.0203106-0.109633im       0.128832+0.000444846im    0.103875+0.248447im     0.0591993-0.0354129im      0.364178+0.0113088im      0.172011-0.101567im      -0.243654-0.00773156im     0.148391+0.0520851im     0.0869028-0.214347im     -0.237308-0.14741im      -0.0653579+0.00509736im    0.0577174+0.00607719im     -0.111902-0.106127im     -0.0214003+0.00965591im   -0.0867871+0.0476732im     0.0559385-0.0470299im     0.102682+0.160344im     -0.0283008-0.0215611im    0.0246457+0.141609im    0.0805928+0.0140867im     0.153308+0.13012im       0.0404334-0.0801683im     0.0914744-0.235042im
   0.0946964+0.241567im     0.0534446-0.230741im       0.0266006+0.116281im    -0.0407339-0.108183im     0.0785198+0.229527im     -0.0987896+0.0567797im    0.0930498-0.0665251im   -0.00432602+0.00355616im    0.0166773-0.235757im      0.134194+0.0972659im      0.260142-0.032438im       -0.18309+0.0334453im    -0.255836+0.120075im      0.0613222+0.200818im     -0.0588118-0.175307im       0.150193-0.0125097im    -0.0519523-0.155762im      -0.190774+0.109726im     -0.153001+0.145473im      -0.172003-0.107459im     -0.0908179+0.0220922im      -0.145607-0.0818482im      0.129882-0.0826076im     0.0757483+0.217846im      0.0264758-0.217766im    -0.0327242+0.0363369im    0.00998334+0.0822236im   -0.0258328-0.0215738im   0.0542022+0.137755im     0.0518812-0.00283086im   0.00224572+0.102675im      0.0497582+0.160356im
    0.138268-0.0220039im    0.0488847-0.0239689im      -0.115881+0.0710703im   -0.0282224-0.142489im    -0.0526251+0.0670919im    -0.0878935+0.226538im    -0.0220446+0.010094im      -0.118205-0.027753im      0.0624766+0.196731im    -0.0296943-0.0771226im      0.039977-0.115914im      0.0375879+0.0765558im    -0.074838-0.0815142im    -0.0742336-0.0956537im     -0.166699+0.0163713im       0.16543-0.0614281im      0.142378+0.115452im       0.139515+0.180784im    0.00854279-0.0796596im     -0.270736+0.0351423im    -0.0696328+0.0848987im      -0.154967-0.0697713im     -0.124283+0.0512506im     -0.304784+0.0181963im     0.0875173+0.114113im      0.347452-0.0934172im     0.0770868-0.200912im      0.157099-0.0780189im   -0.204749-0.0301358im      0.24908-0.0729533im     -0.091936-0.0549098im     0.0551834+0.165876im
   0.0453894+0.212034im    -0.0327434-0.0872827im      0.0132108-0.089937im     0.0299924+0.0998271im    -0.100639-0.227467im     -0.0298049+0.06384im     0.00737358-0.10279im       0.0473017-0.0918946im     0.0811553-0.24208im      -0.139536+0.304847im    -0.00971792-0.00168249im     0.199697-0.0336515im   -0.0446819+0.0834788im    -0.0534574-0.0618956im      0.154251+0.0860904im    -0.0521876-0.113449im      -0.081185+0.120006im       0.183797-0.0103346im     0.150892-0.257839im      -0.248903-0.122252im      -0.112533-0.177431im       -0.011695+0.203653im   -0.000877072+0.13387im      -0.0712016+0.152578im      -0.109767-0.158376im     0.0852882+0.124582im       0.116822+0.128236im     -0.111742+0.102739im    0.0906314-0.126678im   -0.00253742-0.188776im      -0.151092-0.0440719im    -0.0287831+0.065223im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.1674790706490836 - 0.07608245314743131im
  -0.11440869406528856 - 0.09065528441262531im
    0.2227578306528099 + 0.07171694308986458im
  -0.09961525031723654 - 0.05701333045929471im
 -0.029621331886992217 - 0.07766447431186056im
   0.34088343426693696 + 0.0im
 -0.012304375646323286 + 0.010002358549591186im
  -0.19742808151394775 + 0.057763557443845974im
  0.012289987516360895 + 0.017078013476409356im
  0.039564458035970515 + 0.0830150234152591im
   0.25642028266982764 + 0.12255565165616109im
  -0.01231206907125032 + 0.22228253419700433im
   -0.0977342410238798 - 0.16970989061687275im
    0.1650029037196769 + 0.03676883803896556im
   0.20651795912367935 - 0.01354783815410044im
   0.13893650973180588 - 0.12048563398312068im
    0.1580640820135337 - 0.18509860759698873im
   0.10008769588437615 + 0.059086541641615246im
  -0.04171468596899761 + 0.017774363847062824im
   0.11733268188688133 - 0.0971360794521751im
   0.01563631778179249 - 0.16058592339262695im
  0.017911285131999313 + 0.15344063138509126im
  -0.27152055642350664 + 0.006715955878768304im
  -0.08470855771071234 + 0.06873096951244799im
    0.1063985841426231 - 0.06194280511286686im
  -0.05723230354302822 - 0.09398811174668682im
   -0.2617092087602084 - 0.0003453500398970105im
  -0.11478182254076506 - 0.12832305923512055im
    0.0681071937110368 + 0.2086041769416428im
 -0.050065851623349596 - 0.05572721604720255im
  0.005222271430657899 - 0.027614458317280113im
  -0.10131091266837325 - 0.06800410264263194im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 24 October 2025 01:58">Friday 24 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
