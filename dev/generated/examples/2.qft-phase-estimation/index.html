<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor Network Backend</a></li><li><a class="tocitem" href="../../../man/paulipropagation.html">Pauli Propagation Backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.126937-0.287628im     0.0270385+0.124221im       0.150834-0.107468im      -0.064114+0.0843995im      -0.145581-0.183941im        0.157247+0.0375659im    -0.221337-0.0664684im      0.109506-0.140194im       -0.202388-0.0728106im     0.0244695+0.117412im       -0.024693+0.0361198im   -0.0367532-0.0924087im    -0.0525041-0.228905im    -0.145517-0.114151im      -0.100047-0.174989im      -0.103008+0.0887876im    -0.0718166+0.0580875im      0.181871-0.0114568im   -0.0370505-0.0662164im    0.225188-0.0122359im      0.098905-0.0877362im      -0.119045-0.0215715im     0.0212886+0.00413282im   -0.0267853-0.235176im     0.0490874+0.0871753im     0.0797996-0.305481im      0.0918516-0.194118im     -0.0404279+0.0979665im     -0.211353+0.127151im        0.061368+0.02209im     -0.0504068+0.0750998im     -0.119673-0.103427im
   -0.232115+0.0606859im   -0.0634199-0.0979536im     0.0237617+0.066935im       0.141209-0.0745738im      0.0722352+0.208816im      -0.0479489+0.0959319im    0.0701671-0.0663239im   -0.00271095-0.315369im      -0.0749815+0.126044im     -0.0987708-0.0285647im     -0.0704849+0.0706993im   -0.0317761+0.133126im     -0.0947029+0.045047im    -0.157015+0.229938im     -0.0786135-0.219529im      0.0938156+0.0356631im     0.0204059+0.0797237im     0.0280595+0.182991im     -0.116113+0.0906948im   0.0502242+0.261852im        0.13072+0.23461im        0.0144664-0.0446273im     0.0696697-0.136879im       0.095287-0.00188838im   0.0724126+0.203665im      0.0698042+0.17916im      -0.0949176-0.21026im       0.0566748-0.228488im      -0.153041-0.0855761im      0.0219162+0.156113im     -0.128869+0.0859979im  -0.000228559+0.0513738im
    0.112764-0.164743im     0.0124796+0.107938im     -0.0105137-0.354384im       0.207748+0.0261328im      -0.221886-0.0214859im     -0.0635719-0.0600398im   -0.0360686-0.162502im      0.0488911-0.134643im        0.019674-0.0980917im    -0.0116563+0.280349im      -0.0195626-0.0783364im     0.218264-0.0717938im      0.141726+0.0947544im   0.0794819+0.126178im      -0.135024+0.175646im      0.0152936+0.0776321im      0.130773-0.221828im    -0.00674201+0.0890567im    0.0713905+0.0859531im   0.0579735+0.11594im      -0.0501922+0.0216667im      0.0607535-0.0118183im    0.00330836+0.0744926im      0.129843+0.149141im     0.0544918+0.0228642im     0.0983268+0.224574im      0.0261365-0.035085im       0.174749+0.0867212im      0.148752+0.100617im        0.028422-0.0576903im   -0.0774853+0.11928im       -0.288061+0.142515im
    0.107885+0.187768im     0.0725069-0.063731im       0.103572+0.0653732im     -0.141897-0.322715im        0.033766-0.136907im       -0.013368+0.0183845im    -0.306173-0.166417im       0.261506-0.237164im      0.00516565+0.126682im      0.0809221+0.000235129im    0.0108196+0.0384977im    -0.115978-0.0134298im      0.128415-0.0177928im   0.0218331+0.172368im     -0.0950956-0.0313185im    -0.0427275-0.00732454im   -0.0220286-0.0881214im   -0.00698415+0.0236382im    -0.020781-0.0597283im   -0.174989-0.106779im        0.14155+0.000403729im    0.0956514+0.0937405im     0.0968682-0.206489im      -0.151277-0.0510512im    -0.056279+0.109013im      -0.102375-0.101226im       0.156031+0.304667im      0.0750582-0.0333975im      0.150423-0.0215822im      -0.196499-0.0308384im    -0.107116+0.110956im      -0.135198+0.0806475im
    -0.20603-0.059779im    0.00304007-0.140345im     -0.0998162+0.0193014im      0.100492-0.132511im       0.0848825-0.265037im       -0.145815-0.255121im      0.046776+0.0544334im     0.0921917-0.0120331im       0.164115+0.0473221im    -0.0511797+0.0483619im       0.102569-0.144788im    -0.0217563-0.00340361im     0.171936+0.043689im    0.0392781+0.104455im       0.189761-0.0289637im    -0.0550339-0.0663583im      -0.01076+0.0766653im      0.151405+0.275175im    -0.0579852-0.150556im   6.82271e-5+0.0283095im    -0.0017895-0.341933im       0.0161824-0.302694im     -0.0426151+0.130913im      -0.116671-0.0615164im    0.0304603+0.0427945im     -0.111126+0.0148478im    0.00345206-0.0842968im      0.183891-0.0753216im     0.0635955+0.188374im        0.153655+0.0254717im    -0.125513+0.065395im       0.203369-0.0253145im
   0.0559724+0.0838727im   -0.0572216-0.0476606im    -0.0525247+0.103804im     -0.0238148-0.131307im       -0.203288-0.0632846im      -0.173965-0.183332im     0.0952421+0.176569im       0.113733+0.000234763im     0.079602-0.0930273im      0.134331+0.0202543im       0.199879+0.0640369im     0.202596+0.049405im       0.106515-0.113056im    -0.139045+0.0161516im     0.0261459+0.101572im       0.231065+0.120106im      0.0507033+0.0010766im     0.0262272+0.00937202im   0.0165946+0.306152im    0.0395363-0.00273746im     0.112972+0.0267686im       0.237105+0.273835im     -0.0274591-0.118637im      0.0289543-0.11784im      -0.219321-0.0688644im     0.0325385-0.132521im      0.0868126-0.195087im    -0.00328373-0.0248631im     -0.150283-0.108897im        0.175465-0.237832im    -0.0847127+0.0865188im     0.0911071-0.106897im
   -0.104177-0.124748im    -0.0677241+0.112833im      -0.204758-0.0119315im     -0.179164+0.222772im         0.13428+0.116876im      -0.0676595+0.0567555im    -0.226568-0.238147im       0.310881-0.0652979im       0.220144+0.0692885im    -0.0389563-0.0127353im     -0.0269402-0.0489176im       0.1874+0.0338007im     -0.113045-0.0873851im   -0.108319-0.131797im      0.0303205+0.0682728im     0.0369323+0.00532492im     0.085451+0.294737im     -0.0186883-0.029116im    -0.0477902+0.0619069im   -0.107464+0.173683im      0.0726358-0.0516391im     -0.0216757+0.00391787im   -0.0466237-0.171215im      -0.103657-0.0655523im     0.043979-0.0964694im     0.0793077+0.149483im     -0.0833066+0.139911im      0.0848855+0.0156266im     0.0329551+0.0890915im       0.132048-0.224595im      0.258407+0.0204059im     0.0883018+0.0965363im
     0.12085-0.158595im     0.0663716+0.10809im        0.258035+0.228156im     -0.0340629+0.0969103im      -0.092833+0.000405131im    0.0792407+0.0506316im    0.0381805+0.108478im     -0.0710629-0.108089im      -0.0712714+0.152954im      0.0410676+0.0153463im      0.0504358+0.0327492im    -0.109349+0.00962403im    0.0666187+0.164505im     0.271474+0.0193606im      0.185471+0.167503im       0.040032+0.0470236im     0.0760675+0.12272im        0.105065+0.0413905im     0.141052-0.061076im    0.0754361+0.162177im      0.0778229+0.176715im       -0.286491-0.00143816im    0.0246805-0.154939im       0.074799-0.0932419im    -0.232566+0.0340238im     -0.197739-0.0575607im     -0.130536+0.0588781im      0.294997-0.0547186im      0.106618+0.0125366im       0.242523-0.120374im     0.0334046-0.0419im        -0.066956-0.0422739im
 -0.00563439+0.119358im    -0.0851377-0.021968im     -0.0647314-0.0499212im      0.028884+0.0350882im     -0.0863785+0.00530222im      0.331392+0.172791im    -0.0985118-0.0285744im    -0.0394077+0.0926683im      -0.133294-0.420494im       0.165573-0.107761im        0.162709+0.180998im      0.148545+0.245989im      -0.122424-0.0634136im   0.0491065-0.0475766im    -0.0298349-0.0591338im   0.000392333-0.27298im       0.0231725-0.0429507im     -0.124397+0.0301458im   -0.0164262-0.0726771im    -0.12036+0.111064im      0.0527824-0.163757im       0.0465511-0.035016im      0.0825012+0.0299567im     -0.106208-0.136416im     -0.104897-0.0301881im   -0.00717639+0.0594538im     -0.120192-0.0148241im      0.201151-0.187131im       0.176241+0.00649941im      0.143186+0.0408425im    -0.191012+0.0653575im    -0.0446539-0.0028021im
  0.00484626-0.0301893im    -0.193797+0.110857im      0.0271854+0.0349131im      0.215547+0.0520226im      0.0179942-0.286767im      -0.0978231+0.141041im     0.0871159+0.0158121im     0.0478007-0.125235im      -0.0921852+0.12132im       0.0222767-0.387067im       0.0517412-0.233332im    -0.0466618+0.20289im       0.0275753-0.0580929im   0.0415608+0.0466722im   -0.00781487+0.0828899im    0.00780988+0.0983594im     -0.279804+0.0918618im     0.0401424-0.168623im     0.0281122-0.0752819im    0.123277+0.10573im      -0.0380959-0.118669im       0.0965984+0.146159im      -0.104648-0.0605877im     0.0159108-0.0263852im     0.111729-0.203339im       0.192279+0.00805192im    -0.147888+0.00798545im    0.0467736+0.0928744im     0.0983997-0.0544247im      -0.103808-0.0539751im    -0.235193-0.113135im     -0.0965832+0.150871im
   0.0307881+0.0764565im     0.119223+0.0953988im   -0.00380538-0.0164387im     -0.202216+0.0311736im     -0.0206175+0.275118im     -0.00524825-0.0233983im    0.0295006-0.0904823im      0.124227+0.0620409im     -0.0329614-0.0924377im    -0.0514542-0.0187606im      0.0263786-0.438901im     -0.108247+0.204987im    -0.00773224+0.108704im     0.115191-0.0202101im      -0.16118+0.0610034im     0.0117023-0.0412054im     0.0857046-0.0210193im   0.000507818+0.26346im      -0.104821+0.173536im    0.0323432-0.216105im     0.00250946-0.110767im       -0.175946+0.0967563im     -0.149434-0.0861948im     0.0631148-0.0474607im    0.0321132-0.0212574im      0.171563-0.205909im      0.0852187-0.172655im       0.216777-0.137372im      0.0424395+0.0202857im       -0.12943+0.0911413im   -0.0653895-0.202893im      0.0271294-0.0398645im
  -0.0621007-0.0410938im    0.0894604+0.0201868im      0.213075-0.0520989im    -0.0622881-0.28594im          0.12173-0.0438998im      0.0264141-0.0164639im    -0.205372+0.0435517im      0.135586+0.0153925im       0.103237-0.0703482im     -0.155933-0.0707162im      0.0469298+0.0691074im   -0.0375025-0.045157im     0.00843568+0.199122im   -0.0763878-0.315008im      -0.117898+0.0320828im     0.0827987+0.0131201im     -0.111359-0.0651542im    -0.0925392-0.0751999im     0.238924-0.0183798im   0.0554769-0.0464556im    0.00511946+0.163447im      -0.0178137-0.134976im     -0.0686148-0.0554809im     -0.180151+0.172779im      0.139839-0.0932404im     0.0166384+0.0894495im     -0.189587-0.395625im       0.100953+0.0293047im      0.169452-0.174094im     -0.00516344-0.0986081im   -0.0325021+0.0626647im     0.0784216-0.144743im
    0.118893+0.0591279im    -0.156184-0.18346im       0.0329613+0.142696im        0.22579+0.0151368im      0.0202201+0.0510726im      -0.112356-0.181154im     -0.196604-0.00794752im   -0.0337179+0.0340382im     -0.0940586+0.0793386im     -0.264398+0.0972778im      0.0913689+0.0971962im    0.0980361+0.0715722im     -0.151571-0.465135im    0.0949712-0.113885im      -0.131007+0.0120434im      0.181766-0.0706745im     -0.171497-0.0527609im    -0.0527866+0.139007im     0.0655953-0.033476im    0.0144265-0.0197342im     0.0358463+0.101405im       -0.217179+0.0131628im     -0.151372+0.123317im       0.115536+0.0856537im    0.0672006-0.0767378im      -0.12474-0.0254749im     0.0281663+0.0887486im       0.17482-0.0839012im    -0.0328042+0.151712im       -0.159471-0.124469im    0.00122993-0.035287im    -0.00186222-0.0361087im
   -0.073255-0.0847939im   -0.0729549+0.0580472im     0.0521734+0.18222im      -0.0147157+0.134257im       -0.140939-0.0924911im       -0.13015-0.0236406im   -0.0222419-0.122666im       -0.16004-0.024817im      -0.0177522+0.00387517im    0.0665056+0.0646299im       0.269611+0.105637im     -0.183605+0.118917im      -0.116019+0.0628489im  -0.0653905-0.291417im      0.0543171+0.0353539im     -0.133968+0.189832im       0.150405-0.124059im       0.170579+0.149249im     0.0539323+0.0846267im   -0.179039-0.208115im     -0.0631252+0.203655im        0.220917-0.0991874im     -0.110469+0.0123177im     -0.160148+0.0901736im    0.0431971+0.00843352im      0.23715+0.00260399im    -0.151773+0.213884im      0.0743045-0.0987866im     -0.117802+0.0955517im    -0.00813339+0.114924im     -0.094788+0.0768183im     0.0258474+0.111055im
  -0.0435233-0.110543im      0.108655+0.089585im      -0.051564-0.0781981im     -0.100267-0.333107im        0.116157+0.0043624im      0.0701702-0.0465408im     0.246397+0.21614im       0.0970137-0.131718im       -0.177953-0.122245im      -0.219521+0.0579714im      0.0808366+0.10604im       0.106945+0.0340895im    -0.0284834-0.0251613im   0.0308238-0.0142509im     0.0579745-0.22624im        0.103432+0.0813425im     0.0394352-0.0844091im      0.146339-0.139218im     0.0213628+0.0313239im   -0.230413+0.0514337im     -0.175721+0.0419034im      0.0495536-0.0493515im      -0.27025-0.135684im      0.0971294-0.229238im      0.120622-0.139365im       0.020028+0.0177134im     0.0312779+0.146717im      0.0359974-0.0349054im     0.0717688+0.147876im       0.0608966+0.0672665im     0.140106-0.206752im      -0.144876+0.0505213im
    0.215048+0.0131702im   -0.0401543+0.077982im     -0.0440324-0.00967541im    0.0448244+0.0438367im      -0.119252+0.157656im        0.100256-0.111076im     0.0160069-0.0514877im      0.119012-0.121365im        0.143008+0.0439945im     0.0216286+0.0552908im      0.0133084+0.121511im     -0.262303+0.191789im      0.0716444+0.0534im      -0.149676+0.143535im      0.0522057-0.207588im      -0.399034-0.206196im      -0.147886+0.0839671im     0.0233702-0.0963646im     0.167144+0.107702im     0.177636-0.0633957im    -0.0209213+0.102751im        0.181008-0.0326864im     -0.103798+0.193391im       0.137179-0.0153963im     0.115454-0.227717im     -0.0867302-0.0414159im     0.0934264-0.0337985im     0.0658882-0.187326im      0.0608575+0.0168539im      0.0822025-0.167191im      0.110769+0.0182376im     0.0260098+0.00652348im
   0.0748267-0.0446483im   0.00669344+0.309496im      0.0568337-0.0645343im     0.0494233-0.0395637im      0.0298566+0.0225364im     -0.0866347-0.190221im     0.0417893+0.0267211im    -0.0251057-0.136942im      -0.0336492-0.106059im      -0.118652-0.0878843im      -0.105841+0.0301556im    -0.230232+0.0994756im     0.0422742-0.101362im   -0.0102898-0.0368689im     -0.143902+0.256934im       0.156563-0.34892im        0.167716-0.107869im       0.143396-0.0377146im    -0.210964-0.195969im    -0.110112+0.054332im      0.0142333+0.114182im        0.073527-0.0982021im      0.309179-0.00629113im    -0.101188+0.0235233im    0.0593808-0.0685447im    0.00246115-0.045635im      0.0509867-0.0339593im     -0.125442-0.0354797im     -0.160814+0.0240527im       0.104616-0.199871im    -0.0562374-0.1768im         0.108922+0.115804im
   -0.085695-0.0299337im    0.0937434+0.105475im        0.18859+0.310038im     -0.0657654-0.126635im      -0.0216005+0.244427im      -0.0463998+0.0581133im    0.0133702+0.117157im       0.202005+0.174955im        0.104036-0.132447im      0.0879566+0.167377im      -0.0927567+0.00726501im   0.0322875-0.0249717im    -0.0124376-0.166644im    0.0041814+0.159907im      -0.131846+0.196173im      -0.208895+0.161328im     -0.0475956-0.13961im       -0.114291-0.141044im     -0.132242-0.210987im     0.131728+0.159526im     -0.0282781-0.084618im          0.0941+0.0720204im     -0.221119+0.101626im     -0.0916344+0.0748623im      0.15362+0.0778162im     -0.048099+0.0399978im     -0.124767+0.113428im      0.0973739-0.0252996im     -0.172415-0.0324868im       0.162507+0.0686242im    -0.129653-0.0459813im     0.0405735+0.076934im
   0.0924147+0.0763785im   -0.0266449-0.0320072im     -0.234665+0.0653819im     0.0390655+0.133165im      -0.0250173-0.0789704im        0.20886-0.109305im    -0.0329885-0.0627504im     0.0528193-0.147147im        0.219016-0.134077im      -0.158616+0.159213im       0.0447535-0.249209im    -0.0516362-0.00277359im    -0.323895+0.118412im     0.146081+0.0793852im      0.154387-0.00908156im    0.0733758+0.115665im      -0.225607-0.2235im        0.0246834-0.167286im     -0.160236-0.276642im     -0.05793-0.162267im      0.0591835+0.183532im       0.0445219+0.0202984im    -0.0786112-0.110873im      0.0915779-0.0856012im   -0.0386957+0.160819im      0.0141099+0.0193766im    -0.0697214-0.0875043im     -0.119418-0.00906392im  -0.00559017-0.0276026im       0.116872-0.117983im    -0.0698476+0.0832968im    0.00359897-0.103923im
    0.063259+0.289283im      0.151922+0.106801im       0.260733+0.165976im      0.0237564+0.132484im       0.0192587+0.0246422im       0.127629-0.052891im     0.0527532-0.0595403im    -0.0666412-0.0700392im      0.0513639+0.128686im        0.14426+0.109872im       0.0288018+0.0461979im     0.370167-0.105126im      0.0989422-0.0717492im     -0.1425-0.0251411im     0.0678669-0.0750467im    -0.0235607-0.113283im      -0.173202+0.0770325im      0.207175-0.0451111im   -0.0889072-0.116793im    -0.116354-0.280352im     -0.0758423-0.0707554im    -0.00402946-0.126355im      0.0506565-0.136916im      0.0680789+0.0524068im   -0.0264231-0.0609118im      0.115607+0.18579im       0.0461179-0.215093im       0.185746+0.0796251im    -0.0875936-0.030544im      -0.0128647+0.00609269im  0.00852945-0.149039im     -0.0403926+0.203878im
  -0.0120673-0.143616im     0.0788464+0.364165im      0.0757051-0.0264763im     0.0551642+0.0716318im    -0.00812199+0.0419254im      0.0395291-0.114502im   -0.00881424-0.0905641im     0.0364956-0.0269611im      -0.121484+0.0935836im      0.108182+0.129037im       0.0734332+0.0536744im     -0.07763+0.00952825im   -0.0263187-0.261326im    0.0633414+0.273962im       0.153993-0.163419im       0.184084-0.0635716im   0.000546886-0.0125094im     -0.020009+0.163632im     0.0195416+0.0611272im   -0.128669-0.103025im      0.0666782-0.0554063im     -0.0375241+0.123461im      -0.139194+0.0167319im    -0.0925158+0.12454im      0.0717849-0.0646354im     0.0274166+0.0879534im     -0.134695+0.0253346im     -0.183171+0.156091im       0.280814-0.275458im       0.0759363+0.144185im    -0.0462083+0.0535561im      0.231711-0.187833im
    0.060987-0.0431344im    -0.198233-0.00682868im    -0.157974-0.0297952im     0.0284923-0.0984541im      -0.136026+0.107071im        0.164082-0.104704im      0.103252+0.0829586im       0.21495-0.0849799im      0.0880659+0.269142im       0.170836+0.0202539im      -0.164538+0.138019im     0.0225873+0.0177066im    -0.0994875-0.0179666im   0.0902877-0.104845im       0.082654+0.0680318im     0.0599533+0.0429947im     0.0802595-0.0258974im    -0.0255126-0.208602im      0.073559+0.139955im   -0.0372495-0.0631927im      0.210467-0.189589im       -0.169829-0.34049im     -0.00806277+0.0114154im    -0.0866803+0.181496im    -0.0234321+0.0265838im      0.173716-0.016934im      0.0140678+0.0553873im    -0.0468249-0.12604im      -0.0962932-0.0458457im     -0.0292211+0.0418466im    -0.246513-0.218927im      -0.161734-0.166388im
   -0.146384+0.102639im     0.0267947+0.172209im     -0.0650372-0.00525527im    0.0216444+0.0575667im       0.156079+0.144461im      -0.0655145-0.0472131im    -0.139418-0.0945251im     -0.149771+0.0320478im     -0.0499926-0.0955413im     -0.229054+0.0873237im       0.208263+0.0428234im    -0.188596-0.142631im       0.193503-0.0791092im   0.0283602-0.052948im     -0.0139947+0.165522im      0.0400943+0.0471412im     -0.210058+0.310665im      0.0517847-0.230331im    -0.0347009+0.132221im     0.022471+0.00482449im   -0.0479177-0.108482im        0.213022-0.0243896im     0.0344871-0.0274628im     0.0804726+0.105789im       -0.1333+0.198064im      0.0165404+0.0457731im      0.112069+0.0431137im    0.00540932-0.153067im       0.126921+0.0185888im       0.122233+0.117769im     -0.122916-0.0910547im      -0.23787-0.238214im
   0.0976676+0.00913437im    0.141303-0.0117417im     0.0455739+0.0838232im    0.00935742+0.0356012im       -0.04984-0.0343832im     -0.0581937-0.155452im     0.0170709-0.170655im      -0.143135+0.0407309im      0.0826592+0.0206228im    -0.0341736-0.206189im      -0.0510047+0.0423976im   -0.0198143-0.0131887im    -0.0839089-0.0330729im   -0.280129+0.11948im        0.101795+0.291315im      0.0707014+0.0550675im     0.0227517-0.152569im     -0.0231804-0.00813004im  -0.0538229+0.0178727im   0.0617494+0.0199987im   -0.00540839-0.0325366im      -0.107011-0.122459im     -0.0120035+0.054589im      -0.111754-0.449085im      0.180771-0.140558im      0.0473795+0.171397im       0.100754+0.0453276im      0.107405-0.0987803im     0.0192939-0.188639im      -0.0509087+0.155747im      0.131938+0.10148im       -0.233476-0.278853im
    0.067513-0.0632244im    0.0440582-0.319624im      0.0465324+0.170982im      0.0758308-0.0562826im     -0.0393119+0.225423im       0.0773722-0.0654886im   -0.0304539-0.0863146im       0.02963-0.101997im      -0.0615386-0.135869im    -0.00174925-0.0418156im      0.0215376-0.208725im     -0.159882-0.138377im      0.0148097-0.0695133im  -0.0584488-0.162946im   -0.000811561-0.0497519im     0.0447206-0.0493527im       0.22183+0.0332865im      0.153008-0.0557277im   -0.0754346-0.0502619im    0.173836-0.0038114im      0.162486-0.0834029im      0.0616489-0.0333723im    -0.0656688-0.154626im      0.0688646+0.099387im     -0.153522-0.431978im      -0.104799+0.185056im     -0.0100446+0.032008im      -0.183586+0.173077im      0.0751459+0.070663im       0.0944664+0.195964im     -0.107629+0.116858im     -0.0751892+0.0679442im
    0.148258-0.199501im    -0.0850592-0.157438im      0.0376823+0.0734538im    -0.0349556+0.0322168im       0.166303-0.0121542im     -0.0723831-0.013722im      0.174817-0.0880254im     -0.170594-0.0489715im    -0.00141342+0.0374922im    -0.0600732+0.118187im     0.000707645-0.0297745im     0.118513-0.0290613im     -0.100903-0.0608317im  -0.0715085-0.0132728im     0.0303043-0.137653im     0.00430005+0.0712982im      0.119615-0.0760718im     -0.115116-0.0953295im    -0.109087-0.0887615im    0.072506-0.0223531im     0.0889013-0.15604im         0.218148+0.0486351im      0.308826-0.129016im    -0.00591835+0.224639im      0.233269-0.0384162im     0.0395671-0.385988im     -0.0472214-0.00817528im     0.262834-0.0995968im       0.21989-0.147693im        0.125475+0.0189618im     0.137173-0.0512399im    -0.0555012-0.0628861im
  -0.0556292+0.207357im     0.0762716-0.0177291im     0.0999323-0.017579im       0.330126-0.000237607im   -0.0930944-0.0646713im     -0.0666101+0.114657im      0.241044-0.17998im        0.183432-0.185359im      -0.0436135+0.0463699im    -0.0220786+0.108949im       0.0707127+0.120969im     -0.123029+0.0179421im     0.0141778-0.0314824im    0.113758-0.199179im     -0.0751009+0.192887im      -0.117968+0.0250308im    -0.0166834-0.0447943im     -0.185461+0.0223im      -0.0315271-0.104807im    -0.149877+0.0849791im     0.0708724-0.206533im      -0.0239732+0.011224im      -0.150565-0.0398737im    -0.0124708-0.0204626im    -0.158653-0.00986379im    0.0495981-0.148054im    -0.00875102-0.182832im      -0.175678-0.118476im      0.0366568-0.0389647im      0.0453002+0.107647im      0.421065+0.0475476im     0.0131141+0.0231147im
    0.223066+0.067756im       0.24437-0.0133567im    -0.0140756+0.012376im      -0.153944+0.124231im       -0.202598-0.0459159im      -0.287598-0.117206im     -0.151784-0.0518732im      0.119861+0.157581im       -0.139453+0.0582723im    -0.0611595-0.0478232im      -0.130821+0.294721im     -0.038028+0.116425im      -0.148356+0.19645im    -0.0164012-0.0026553im    -0.0608338-0.156817im       0.231187+0.103382im     0.00223454-0.00228909im      0.06683-0.0124741im     0.045056-0.213942im      0.20225+0.0547005im    -0.0287618-0.249519im          0.1267-0.0437272im    -0.0038414-0.0397898im      0.206947-0.00849561im  -0.0806414+0.0919608im     0.0972237+0.0735536im      -0.10843-0.0126041im     -0.103135-0.116263im       0.123956+0.084051im    -0.000189073+0.0387442im   -0.0279301-0.112386im      0.0994312+0.0747496im
  -0.0391541+0.119366im     -0.208874+0.0016012im     0.0474838-0.0967424im   0.000865156+0.0424443im      0.0919046+0.0714357im     0.00890994-0.173354im    -0.0687525-0.183973im       0.139067+0.015698im       -0.143368-0.085225im     0.00877699+0.189428im        0.216165+0.051374im    -0.0210204+0.0935906im    0.00310545+0.160028im     0.137771+0.0487678im      0.189989+0.0435202im     0.0903624+0.0493567im      0.176812+0.0320347im      0.172851-0.346014im     0.0370357-0.0241554im   0.0563274+0.158779im      -0.113499-0.0771789im     -0.0521833+0.016239im      0.0517726+0.0624906im     0.0218109-0.0599414im    0.0680371-0.0620115im     -0.144462-0.0854525im    -0.0126852-0.049232im       0.168514+0.0922148im     -0.229941-0.233802im       -0.333348+0.138273im     0.0172523+0.094776im       0.181315+0.0815182im
   0.0745022+0.216563im     -0.100343+0.189367im     0.00983426-0.082976im     -0.0552212+0.115668im       0.0831637+0.215726im     -0.00466628+0.10093im      -0.097094+0.208345im     -0.0460182+0.0961515im       0.112127+0.250962im      -0.112386+0.0824414im      0.0257624+0.0367589im    -0.116602-0.122642im       0.109192-0.0441051im   0.0700522-0.119825im      0.0861697-0.205322im     -0.0343065+0.191369im      0.0484076-0.214731im     -0.0225757+0.17539im      -0.236849-0.0392162im  -0.0831131+0.238878im      0.0182989-0.0800487im       0.135655-0.077423im      0.0475617+0.0920526im    -0.0447582-0.202811im     -0.107851-0.240684im      0.0283634-0.0881021im     -0.143684-0.130938im      0.0119323+0.0679583im       0.05597+0.00841293im      -0.12917-0.14835im      -0.120551+0.101787im      -0.172013-0.0283947im
  -0.0643051+0.291271im     -0.146066+0.0235522im      0.102317-0.292461im      0.0537829+0.115576im      -0.0330136+0.139387im        -0.31405-0.179118im      0.054525+0.0975671im     0.0135271-0.0799117im      0.0668218-0.207513im      0.0341361-0.0152425im      -0.112481+0.00561933im    0.111929-0.0480565im     -0.110889-0.031441im    0.0295101-0.109171im      0.0505775-0.0430787im     -0.168259-0.0060908im    -0.0892544+0.0572206im    -0.0321143+0.121677im       0.15352-0.0566458im    0.172778-0.012613im      0.0786989+0.176635im      -0.0215772-0.1614im       -0.0315248-0.232814im      -0.101702-0.160317im     0.0265099+0.0486049im    -0.0713146-0.166917im      0.0199934+0.211394im     -0.0133397+0.189079im       0.129864-0.159687im        0.148618+0.151331im     -0.103112-0.120085im     0.00827688+0.052861im
   0.0206331-0.044414im    -0.0997235-0.0519882im    -0.0250173-0.0804967im     0.0324822-0.0622368im       0.107323+0.105841im       0.0788389-0.0819846im    0.0636494-0.0563803im     -0.100842+0.104761im      0.00534772+0.0526693im      0.281954+0.146231im       -0.136084+0.0612254im   -0.0208559+0.163989im      0.0276412+0.0200287im   -0.041027+0.0671253im    -0.0180314+0.0703246im      0.100437-0.0169875im    -0.0201586+0.173495im      0.0299295+0.119367im     0.0460264-0.378587im    0.0511577+0.134711im      -0.312177+0.134423im       0.0917727+0.030407im      -0.194309-0.287363im      -0.165371+0.102603im    -0.0970902-0.0957834im       0.18823-0.0979426im      0.165765-0.048311im     -0.0125821-0.020295im     0.00379162+0.176378im       -0.128676-0.0541im      -0.0045412+0.132243im     -0.0697864-0.265844im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.2454648997316655 - 0.07547635382339522im
   0.10483602679823577 - 0.05179455122555242im
  -0.04786749373486927 + 0.028593962236965517im
  -0.17658497475790116 + 0.053471431167464833im
  -0.07659643186563549 + 0.1273497888818301im
  -0.04768265027042231 + 0.14686563364378624im
   0.05163658378594733 - 0.03700623209175075im
  -0.02331047317306859 + 0.014670150757199277im
 -0.050532075929641734 - 0.11577613717008084im
    -0.240096986837869 - 0.020845716813736266im
  -0.04270377369447498 + 0.27638800177287154im
  -0.14782868758083925 - 0.05868922540771019im
  0.018649791187561035 + 0.27392119348924077im
 -0.012267232249889844 + 0.11230258554374094im
  -0.04146949377383693 + 0.06258606211413546im
   0.12160502391381721 + 0.01665647056244853im
   0.08441834192148848 + 0.053112990170795626im
   0.08350033683248691 - 0.1526630334944627im
   0.24002554383699945 + 0.001540617691023649im
  -0.15281009139197319 - 0.005683331687779736im
  -0.10787449832652159 + 0.07065966297707725im
 -0.011983488412636474 - 0.10308407796469954im
  -0.08175391858239547 - 0.054003076976276515im
   0.22987209287873017 - 0.04261315343166712im
  -0.19684433583700658 - 0.023041815164010403im
   0.18112418847657422 - 0.0847369094076386im
   0.11961752955466576 - 0.05161629814704349im
   0.25789276101925157 + 0.15185825736242498im
  -0.09623972647569459 - 0.00370737406378812im
  -0.07552272788117313 + 0.008254483766206222im
  -0.05369869278709617 - 0.19252697184654627im
   0.30401234985192377 + 0.0im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 9 December 2025 02:01">Tuesday 9 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
