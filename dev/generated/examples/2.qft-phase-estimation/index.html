<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0281946+0.240534im       0.112972+0.258094im     0.0570919+0.150344im     -0.0501182+0.224713im     0.0661984-0.0512398im     0.0988772-0.172444im     -0.140468+0.349384im     -0.0799169-0.166648im    -0.0379954-0.234057im      0.132253+0.0695438im    0.257626+0.0572896im     0.0624001+0.110633im     0.00283845-0.17275im       0.14653+0.0136285im    0.0757289+0.0646391im     -0.158745-0.0048469im     0.0179572-0.164756im      -0.016683+0.121533im       0.143298-0.135148im     -0.0804713-0.011894im      0.0792795+0.00870589im   0.0925859-0.142804im      0.0121237-0.0338373im    -0.0739004+0.0986208im     -0.117423+0.172216im     0.159001-0.11665im        0.103904+0.0879221im   0.00405029+0.0406815im     0.0327195+0.16575im        0.013037-0.0108319im   -0.00079732-0.166561im      0.095784+0.0402449im
   0.0407366-0.0823578im     -0.100559-0.0384687im     0.123132-0.111009im      -0.120435+0.0740658im     0.141907-0.103968im      -0.138312+0.03089im     -0.0427107+0.192696im       0.115533-0.283053im     0.0238871+0.169219im     0.0403801-0.105388im   -0.0698789+0.0214922im      0.104037-0.126255im      -0.162137-0.024223im     0.197189-0.0494268im   -0.0891161-0.139471im     -0.0388668-0.148692im       0.189769-0.102312im     0.00814053-0.0480267im     -0.142713-0.139734im    -0.00156083+0.000465232im  -0.0359483-0.114075im    -0.0662725-0.194452im      -0.102698-0.271224im     -0.0339266+0.127738im       0.209251-0.063013im     0.136354+0.144809im      0.0548325+0.0845701im    -0.184588-0.099874im      -0.137805-0.0627416im    -0.0592576-0.0718223im      0.192179+0.202088im     -0.229421+0.0735305im
 -0.00251839-0.0824358im    -0.0764901-0.0555167im   -0.0349656+0.0339136im     -0.329063-0.0490885im    -0.221593-0.102604im     -0.0381625+0.112867im      0.108167+0.139751im      -0.226583+0.0658489im    0.0468708+0.0163447im    -0.028108+0.17308im     -0.129013-0.0440456im      0.186568-0.0973339im      0.106591+0.0705326im   -0.195163-0.0288621im     0.123684+0.0204703im     -0.116319+0.295796im       0.174501-0.222012im      0.0596661-0.0703413im     0.0081524-0.1029im        0.0609255-0.0859263im     0.0980995+0.155959im     0.0545761+0.000276794im   -0.142501-0.097999im      -0.101873-0.163866im     -0.0769206+0.288441im    -0.112938+0.123914im      0.0873516+0.108559im     0.0905098-0.00183552im    -0.222609-0.0463407im   -0.00657075-0.133324im       -0.10644+0.0248546im   -0.0446377-0.00557271im
    0.141006-0.115707im      -0.229325-0.046653im      0.115843+0.0466682im     0.0583652+0.255221im     -0.022541-0.0289489im      0.271465+0.30505im      0.0954418-0.00939825im   -0.0780165-0.107901im     0.0638781+0.057182im      0.118831+0.0100847im  -0.0805177-0.149487im       0.185953+0.0121213im      0.157433+0.0934119im    0.137506+0.220694im      0.203016-0.0367067im    -0.0930523-0.225406im     -0.0190207+0.100007im       0.262868+0.145468im     -0.0569724+0.0101299im     0.0742822+0.10978im      -0.0909195-0.0672789im    0.0957174-0.0327635im     0.0962523+0.117638im      0.0701075-0.241258im       0.108227+0.0596637im      0.1438-0.0708652im    -0.0661094-0.0149703im     0.103111-0.00744698im    0.0113959-0.0820666im     0.0379554+0.0484297im     0.0203262-0.206083im    -0.0539422+0.0320413im
    0.282378-0.186103im      0.0701151-0.0673459im   -0.0643755+0.0521284im      0.110864-0.0659494im   -0.0166409+0.303796im      -0.080638+0.0744891im    -0.132989+0.112499im      -0.137602-0.0570547im    0.0155307-0.279588im      0.176959-0.159707im   -0.0187263-0.000959523im  -0.0277733+0.180271im    -0.00149814-0.0372005im   -0.140086-0.0125384im     0.144367-0.0650424im     0.0499705-0.0462038im      0.253447+0.0551399im    -0.0352078-0.0226131im     -0.147499+0.117587im       0.121723-0.0237829im    0.00439563+0.0858886im    -0.036869-0.109792im      -0.225333+0.155644im      -0.252045-0.0773602im     -0.125812-0.0284059im  -0.0213479+0.00597698im   -0.0788316-0.225417im     -0.266753-0.0660104im     0.0202494+0.115561im      0.0330899-0.0534375im     0.0756846-0.0118956im    -0.119873-0.0535197im
    0.050722+0.245516im     -0.0682468-0.0831881im    -0.287109+0.0961675im      0.283935-0.126999im     0.0626753-0.0684009im      -0.02297+0.149743im    -0.0116131-0.0494884im    -0.0886801-0.053404im    0.00400519-0.0842613im    -0.214989+0.104196im    0.0851914+0.18093im       0.0935234-0.169264im      0.0197106+0.0425131im    0.247501+0.146718im     0.0397148+0.125678im       0.163442-0.0829611im      0.136592-0.173404im      0.0594122-0.00415329im    -0.172176-0.049613im      -0.105953+0.106952im     -0.0303313-0.0660104im     -0.13237+0.0536915im      0.119894-0.0970335im    -0.0844835-0.00542102im    0.0600074+0.122399im    -0.327729+0.0526855im   -0.00295497-0.092797im    -0.0322417-0.110384im       0.036386+0.161366im     -0.0879572-0.205925im     -0.0346787-0.12582im     -0.0290584+0.0712882im
  -0.0163752-0.168134im      0.0247793+0.132386im    -0.0388217+0.0648313im     0.0103714+0.0171775im    -0.180386-0.0791509im     0.0540368-0.0427162im   -0.0326274+0.242178im      0.0639092+0.0602216im     0.105553-0.00116067im  -0.0740106-0.152759im    0.0218834-0.00220893im    -0.375209+0.119223im      -0.114186+0.216681im     0.278246-0.106767im     -0.147812+0.0667009im     0.0645079+0.112615im     0.00561439-0.106036im       0.135978+0.176609im     -0.0176343-0.0694131im    -0.0121912-0.0055933im      0.072646+0.0276217im     0.139105+0.082689im       0.256489+0.143741im     -0.0598139-0.21362im       0.0631452+0.157951im   -0.0309234+0.0319331im    -0.0108393-0.251722im     0.0153569+0.107973im    -0.00360183-0.101609im      0.0290687-0.105525im      0.0984969+0.240646im     -0.130304+0.03875im
  0.00105643+0.286152im      0.0593531-0.0172977im   -0.0455484-0.192965im      -0.138037-0.0538986im   -0.0463061+0.0371958im      0.221074+0.0990282im     0.204057+0.0123024im      0.122422+0.0580982im    -0.132035-0.0356672im   0.00179481-0.0503592im   0.0121876-0.111564im      0.0948654+0.0865052im     0.0620062+0.0665202im    0.218799+0.0424536im     -0.16823+0.0858873im      0.233866+0.0407129im      0.237568-0.0102786im     -0.112841-0.0420965im      0.125672+0.210309im        0.36041-0.0895243im     -0.097768+0.0700986im   -0.0509399-0.0432609im    -0.0927916-0.139076im     -0.0121591-0.0689498im    -0.0372496+0.145621im       0.1473-0.154046im       0.165601-0.101725im    -0.0616828-0.0362456im      0.201394-0.103665im      -0.156449+0.10118im       -0.020241+0.0814771im    0.0117288+0.0739962im
  -0.0513328-0.18904im       0.0981881-0.253762im     -0.180493-0.189786im     -0.0893603+0.0294721im    0.0515506-0.0194505im     -0.215082-0.175487im      0.182235-0.0379099im     -0.120103+0.0349676im   -0.0534925-0.108092im    0.00173857+0.0574017im  -0.0147915+0.0996653im      -0.22755+0.0364012im      0.177262-0.0762834im    0.288472+0.189535im     0.0829247+0.103669im     -0.0792677-0.192892im       -0.19774+0.0529385im   -0.00407242+0.207584im     -0.0324884-0.0103686im      0.169091-0.114737im     -0.0102347-0.0985853im    0.0939186-0.111166im      -0.115506-0.14205im     0.000159816-0.0339577im     -0.163839-0.017473im    0.0672705+0.0417865im    -0.0502373+0.0450472im    0.0257425+0.0707396im     -0.112235+0.106201im     0.00726794-0.0340812im     -0.291242+0.0721178im    -0.103111+0.134803im
 -0.00502078-0.169548im      -0.179864+0.122955im     0.0738561+0.111955im     -0.0158306+0.0701776im     0.247793+0.0755201im       0.10869-0.132736im     0.0413236-0.0313755im      0.145064-0.0863739im    0.0724154+0.0964402im    -0.174986+0.251228im    0.0982382-0.143564im     -0.0168094-0.0847591im     0.0222199-0.12555im      -0.18495-0.160915im     -0.193413+0.198186im      0.0389088+0.0557469im   -0.00321206+0.132902im      0.0758542+0.198288im      -0.328228-0.0225798im      0.213018-0.142949im       0.102339-0.0203409im    -0.226922-0.102981im      0.0649722-0.00416992im   -0.0541981-0.0460446im     -0.152556+0.10496im    -0.0111842+0.0243173im      0.126597-0.0514476im    0.0325738-0.00713611im     0.130895+0.134331im     -0.0363826+0.021237im     -0.0903628-0.0751138im    -0.198671-0.0713018im
  0.00735252-0.102721im      0.0109362-0.235959im    0.00560086+0.0883108im     -0.016595+0.0156093im    -0.325515-0.173189im      0.0420484-0.150683im    -0.0828514+0.18341im        0.113975+0.108758im     -0.148605+0.0981867im     0.122132+0.15965im     -0.269384+0.0544992im     0.0110473+0.00752334im   -0.0397618-0.128869im   -0.0113633+0.0264244im    -0.328173+0.119324im      0.0138278-0.201793im     -0.0186607+0.0892043im     0.0847839-0.0146984im   -0.00546127+0.169106im     -0.0838318+0.0663436im     -0.246634-0.0317861im    0.0312567-0.129324im     -0.0217709+0.150747im      -0.164836+0.186241im     -0.0739979+0.0754044im   -0.096315-0.00865362im     0.182781-0.0430953im   0.00701227-0.0215357im    -0.0547286-0.0208118im    -0.0671354-0.113382im      0.0920159-0.24149im      0.0654719-0.0357179im
   -0.266384-0.141847im     -0.0361544-0.0534267im    0.0846672-0.112913im      0.0477402+0.00669196im   0.0947351-0.0313644im     0.0574157+0.12034im     -0.0215277-0.0296788im     -0.262789-0.087017im    -0.0409331+0.0166896im     0.141324+0.288419im     0.210779+0.169859im      0.0972464+0.328983im      -0.130741-0.159487im     0.123391-0.10402im      -0.140809-0.0731824im      0.137887-0.0090855im    -0.0562303-0.10705im       -0.204455-0.0309763im    -0.0309104-0.0909912im      0.107971+0.0188552im     0.0156262+0.073552im     0.0978832+0.0768826im     -0.101862+0.0910791im     0.0116193-0.0252225im      0.160632-0.0829228im   -0.148822+0.0165942im     0.0901208-0.178263im      0.112862-0.128445im     -0.0334682-0.238947im       0.157539+0.0252152im    -0.0754719-0.1116im       -0.125903-0.0821145im
   -0.149805-0.036839im      -0.332212+0.0160843im    -0.066067-0.0510128im    -0.0128173+0.0321273im     0.016978-0.0311774im     -0.192152-0.185979im     -0.135156-0.0604787im     0.0286722-0.0278697im    -0.110508+0.00453062im    0.132855-0.120216im    0.0174203-0.239955im     -0.0866384+0.117872im       0.143929+0.212415im   -0.0493891-0.0385478im   -0.0716013-0.161493im       0.119894-0.145305im      0.0705361-0.390121im      0.0841559-0.0401884im    -0.0360084-0.0276246im     0.0230358+0.159691im     -0.0496418-0.127718im     -0.121668+0.118639im      -0.013676-0.106862im     -0.0335747-0.0175228im     -0.140564+0.0559489im    0.131877-0.101164im    -0.00429894-0.140162im      0.107077-0.120203im     -0.0817869+0.112114im      0.0131853+0.0485888im     -0.146627-0.0675098im     0.190831-0.256971im
   -0.143256-0.109552im     -0.0838373-0.0369312im   -0.0245487+0.0581147im      0.224909-0.104141im    -0.0968756+0.119148im       0.023858+0.0224354im    0.0169575+0.180836im      -0.032986+0.130042im    -0.0609305-0.10525im      0.0635895+0.191745im    -0.103278+0.0623997im    -0.0306091-0.0577442im     -0.189533-0.0179621im   -0.126939+0.0600752im   -0.0952083+0.0754458im      0.113111-0.186742im     -0.0239603-0.102108im      0.0827716-0.0401556im    -0.0319728-0.250029im       0.106308-0.0847945im      0.056091+0.00393928im   0.0188385-0.0645254im     0.0393248-0.108984im       0.230775-0.221565im     -0.0158261+0.123365im    0.0147628-0.0866961im    -0.0805925+0.251058im     -0.328292-0.0878803im     0.0615592+0.00665653im     0.122758+0.294815im      0.0862551+0.112738im      0.235291+0.103477im
  -0.0631671-0.0134499im     0.0560454-0.0148636im    -0.194004-0.221651im      0.0411251+0.107327im      0.111086+0.209875im       0.189604-0.0420895im    -0.267272+0.0962639im   -0.00205187-0.0147847im    -0.297675-0.0160882im    -0.192658+0.038636im    0.0794285+0.00169782im    0.0290612-0.0511575im    -0.0344253+0.144535im    -0.177822-0.00571833im    0.139566+0.142085im       -0.13993+0.0379109im    -0.0875601-0.0570064im     0.0452188-0.148229im     -0.0983664-0.0342648im     -0.156951+0.144108im      -0.350115-0.0809919im     0.096898-0.11214im       -0.042336+0.0707921im    -0.0420597-0.0602412im     0.0131733+0.0757472im   0.0337955+0.12334im         0.15545-0.0875017im    0.0658007+0.0565896im    -0.0258057-0.13984im      -0.0856638+0.232914im      -0.115985+0.175771im     -0.129357+0.0824137im
  -0.0275255+0.0771241im      0.247025-0.279356im     0.0462466+0.112632im     -0.0134418+0.182902im       0.20893+0.0515592im    -0.0452442+0.0388416im    -0.210834-0.0631071im     0.0791769+0.00640606im  -0.0124498-0.0462672im     0.211212+0.0185431im   -0.159103+0.124895im      0.0582518-0.0214489im     0.0889307+0.317162im     0.102615-0.131673im     -0.239119-0.0517067im     -0.119601+0.292945im      -0.047903-0.00644415im     0.115994+0.117529im     -0.0284251-0.0402308im     0.0591872-0.126578im      -0.125992+0.114777im    -0.0365395+0.206241im       0.029902-0.0931225im    -0.0291956-0.0401607im      0.130294+0.0495191im   0.0391634+0.143466im     -0.0848961+0.0290665im    -0.152177-0.0430916im     0.0527691+0.123977im       0.078796+0.139539im      -0.101574-0.214949im    -0.0158726+0.0329445im
   0.0325136-0.00904523im    -0.238546+0.0114618im    0.0172188-0.119894im       -0.19337+0.0613053im    -0.118158+0.0384194im     -0.240171+0.0701083im    -0.106518-0.0070451im     -0.169988-0.0973993im   -0.0705186-0.0207281im    -0.114117+0.142777im     0.152678-0.0814014im      -0.03224-0.191823im    -0.00779437+0.158503im     0.102392+0.0580363im   -0.0444387+0.0640564im    -0.0347974+0.196278im      -0.179541+0.182338im    -0.00506853-0.0626204im      0.206709+0.0428326im     0.0602181+0.0133796im      0.127851-0.231659im    -0.0360533-0.132322im       0.141284+0.0515954im     -0.338568+0.074744im      0.0100728-0.0426505im   -0.051127-0.101995im     -0.0721436-0.0651607im    -0.281912-0.128933im       0.127932-0.169265im       0.137793+0.0949802im     0.0370439-0.0972538im     0.106026+0.041461im
   -0.081266-0.12599im        0.117654-0.0187151im     0.126593+0.013152im     -0.0136378+0.061608im     -0.112535+0.066995im      -0.103987-0.160199im     -0.104185+0.0907135im      0.120474+0.162251im       0.28379+0.274784im    -0.0125693-0.112247im     0.316443+0.073614im       0.233466-0.0409657im      0.155992-0.111942im    0.0553672-0.0366475im    0.0995597-0.12174im        0.163476-0.0514322im    -0.0616613+0.0380158im    -0.0632466-0.0705455im     0.0428654-0.0214563im    -0.0310997+0.0835469im     -0.171199-0.164999im     -0.151617+0.190929im      -0.132387-0.044585im     -0.0362097-0.238894im      -0.154438+0.190006im   -0.0844215-0.020597im     -0.0264344-0.0259469im    -0.139613+0.118543im      0.0416728-0.0679044im   -0.00234727+0.0190057im    0.00890985-0.104678im    -0.0335549+0.253068im
   0.0348728-0.0991441im    -0.0469233+0.161834im      -0.15234+0.0178685im    -0.0730307+0.153642im      0.023681-0.0988309im     -0.161261-0.0430861im    0.0937126+0.0852343im     0.0420912-0.144337im    -0.0375687+0.03107im      0.0745684-0.0126664im   0.0500777+0.145015im      0.0612263+0.0346532im     0.0849052+0.0280278im   -0.121375-0.0509496im    0.0121444-0.189126im      0.0668574+0.0712858im     0.0919232+0.00361828im    -0.216372+0.177385im      -0.143028+0.292564im     -0.0614808-0.156639im       -0.17216-0.0462698im     0.225111-0.180523im       0.231865-0.00191306im     0.119992-0.213953im       0.145683-0.0801618im   -0.261156-0.0370731im   0.000863671+0.090477im     -0.129427+0.015251im       0.023828-0.0219026im     -0.272623+0.0625563im     -0.135538-0.0133512im     0.220935-0.0688755im
   0.0137664-0.0898253im     -0.177302+0.235315im     -0.053736+0.0544733im     0.0733095-0.0179238im     0.078958+0.00582206im     -0.15295-0.133723im     0.0621228-0.0278501im      0.106683+0.225964im     0.0469514-0.279902im     0.0432585+0.0241477im   -0.194294+0.112354im       0.289671-0.00404692im       0.1324+0.0958676im    0.104596+0.0164711im   -0.0701253+0.0391649im    -0.0667146+0.0775794im     0.0596103+0.0935342im   -0.00132544+0.261455im      -0.105768-0.0247784im    -0.0866404+0.325494im       0.171306+0.0383017im    0.0936085+0.0435728im     -0.221706-0.0924793im     0.0234625+0.1663im       -0.0320768-0.0316938im  -0.0500942+0.010856im       0.107581-0.113971im     0.0125741+0.0738691im     0.0629535-0.292064im     -0.0231818+0.17267im       0.0539881+0.0514801im    0.0208578+0.113355im
    0.173677-0.117045im     -0.0311377+0.00507061im  -0.0709055-0.289266im     -0.0608079+0.165168im     0.0164884-0.035248im     -0.0872226-0.0644096im   -0.0184557+0.0300815im    -0.0630951+0.216126im      0.112476-0.134169im     0.0482788+0.0618736im    0.125216+0.0532599im      0.181843-0.132336im      -0.055829-0.0028048im    0.194647-0.0616457im   0.00846893+0.0764693im     0.0614652-0.0278415im    -0.0163986-0.0350393im     0.0328424-0.240914im       -0.13518+0.205909im    -0.00354307-0.120885im     -0.0662765+0.122721im     0.0824513+0.0123281im      0.164635-0.0594404im      0.128509+0.0763935im      -0.13023+0.0995429im  0.00815556+0.150761im      -0.125352+0.0528094im     0.191836+0.05571im        0.132917+0.126695im       0.189192+0.113868im       0.321475+0.023482im    -0.0311061-0.313598im
    0.161842-0.185723im      0.0279973-0.0265208im   -0.0431279-0.0508508im      -0.14298+0.0105759im      0.15481-0.0692755im     0.0514272+0.0854142im    0.0163572+0.0288741im     0.0142112+0.0270121im   -0.0853614-0.209629im      0.213583+0.0654902im    0.084344+0.0264419im     0.0581518-0.00776737im    0.0956109-0.142551im    -0.059358-0.00904778im   -0.253518+0.249407im      -0.124669-0.00704574im    -0.021548+0.0979418im     -0.140148-0.0981305im      0.137145-0.00925131im    -0.104214+0.256831im     0.00567259-0.0669099im    -0.324337+0.163645im        0.12203-0.0441104im    -0.0323794-0.257584im       0.191188+0.0121514im  0.00665974-0.198762im         -0.133-0.00318804im   0.0528853+0.0180347im     -0.193003+0.108108im       -0.13117-0.0880244im     0.0264443+0.232895im     0.0532087-0.00790744im
  -0.0551469+0.0436095im     0.0613357+0.163068im     -0.124092-0.197854im      -0.147742-0.06829im      -0.155998-0.133399im      0.0432158-0.110137im       0.10281+0.180746im      0.0393274-0.0994683im   -0.0450993-0.0299333im   -0.0496185+0.0566295im  -0.0716868+0.117566im      0.0399504+0.0483045im     0.0700911+0.147207im    0.0660383-0.110056im      0.060555-0.0805166im      0.171927-0.12722im        0.116625+0.181565im      0.0443176+0.0814339im     0.0047699-0.155643im      -0.105167+0.0755524im     0.0247823+0.0433798im    -0.298198+0.0383132im     -0.139646+0.355877im      -0.111879-0.0583266im      0.128731-0.0677661im   0.0380911+0.182631im      -0.167459+0.267583im     0.0689456-0.10875im        0.192806+0.118148im      0.0659109+0.147799im      -0.163988-0.0220876im   -0.0683664-0.0985962im
  -0.0224307-0.157516im       0.110457-0.0571245im     0.109318+0.10634im        0.102538+0.0755021im     -0.21052-0.0859289im      0.105147+0.0927095im   -0.0579532+0.0930329im      0.178733+0.128455im      0.112585-0.0523972im    -0.192509+0.0894066im    0.134801+0.0898721im      0.105371+0.00388875im    0.0738051+0.182967im   -0.0751297+0.134555im     0.0186608+0.0632324im     -0.252151-0.0307602im      0.150927-0.102383im       -0.23018+0.101473im     -0.0575125-0.00933684im    0.0551233-0.19813im      -0.0965701-0.190181im    -0.0970069-0.0684729im     -0.101826-0.0901781im     -0.010903+0.133924im       0.105422-0.152149im    0.0854283-0.0452528im      -0.10865-0.152585im      0.140694-0.164884im       0.164368+0.0078663im      0.224141-0.120995im      -0.125339+0.199839im      0.195584-0.0929289im
    0.073976-0.212501im    0.000411424+0.14619im      -0.131086-0.161802im     -0.0807346-0.273929im     -0.150904+0.0640366im      0.124298+0.111498im     0.0978105-0.0796712im      0.103289-0.299691im     -0.119279+0.0526886im     0.188852-0.0360987im   0.0603282-0.0756938im      0.103602-0.00612716im     0.117654-0.0284031im  -0.0503559+0.0458086im    -0.152482-0.129369im    -0.00482782+0.0566933im    -0.0685998+0.0627167im     0.0162761+0.0416728im     0.0145701-0.145203im      -0.188367-0.0790905im    -0.0621925+0.0223547im     0.143654+0.0548908im     0.0703596-0.147079im      0.0609986+0.144333im      -0.074948+0.086217im   -0.0830417+0.089381im      0.0741229-0.213169im     0.0477962-0.011754im       0.125653+0.300008im       0.255252+0.0277737im     0.0240842+0.00872342im    0.071959+0.289198im
  0.00535867-0.126935im       0.111407-0.0212897im    -0.102443-0.239018im      0.0755534-0.135549im      0.155488-0.0482362im     0.0382699+0.177783im    -0.0540678+0.106766im      0.0720654+0.025996im      0.185739+0.0855998im   -0.0272241-0.103985im    -0.220782-0.0175284im     0.0803823+0.136051im      0.0722654-0.199174im    0.0685194-0.122471im       0.22718+0.153605im     -0.0238646+0.0822985im     -0.188875-0.131743im     -0.0410297+0.133525im      0.0391227+0.0475507im    0.00428625+0.0120842im      0.102467-0.0740538im    -0.145506+0.0190479im      0.190007+0.0588747im    -0.0657142-0.00525066im   -0.0543583+0.0207283im    0.157218+0.248865im       0.295626-0.014942im     -0.138764-0.212882im    -0.00537407-0.0708739im    -0.0230307-0.0191924im     0.0130672-0.05734im       0.325997-0.0956107im
    0.242523-0.124221im     -0.0176895+0.163919im    -0.0510902-0.158649im       0.116008+0.0105686im    0.0676317+0.134352im      0.0445109-0.0356021im   0.00466954-0.0903926im    -0.0292153+0.0164581im   -0.0117391+0.208595im    -0.0683216+0.0621086im    0.167071+0.216147im      0.0184935+0.105785im      -0.258179+0.178445im    -0.110916+0.0356889im   -0.0674356-0.00768918im    0.0918777+0.0057673im    -0.0692595+0.0208341im      0.197028+0.250379im       0.113317+0.201823im      0.0892207+0.101513im     -0.0684858+0.0913635im    0.0883134+0.131433im      -0.175639-0.103376im      -0.142404+0.11732im       0.0821898+0.201487im      0.11302-0.0967178im    -0.0230983+0.281121im    0.00186916-0.119405im      -0.130081+0.0182493im     0.0428865-0.250886im     -0.0363714+0.0453667im     0.132064-0.0100657im
  -0.0255203-0.0964796im     0.0492116-0.0571773im    0.0221258+0.0893774im     0.0712367+0.228827im     -0.104604-0.252048im       0.188042-0.0267207im    0.0357692-0.269907im       0.172767-0.283613im     0.0393297-0.174684im     0.0183288-0.0782529im   0.0361962-0.0577434im      0.046289+0.145361im     -0.0464949+0.175587im    0.0434055+0.0274798im    0.0469453+0.0117747im     0.0429902-5.43449e-5im    -0.188763+0.00250774im    -0.175791-0.20846im       -0.126434+0.0295902im      0.084696+0.170238im      0.0820434+0.143698im     -0.105882-0.111347im      0.0131148+0.0670402im    0.00394094+0.146689im      -0.202214+0.246744im    -0.150592+0.101875im     -0.0348574+0.157859im     -0.224886+0.0539427im    -0.0977701-0.0940433im      0.062649-0.034233im      -0.100665+0.160373im     0.0563785+0.00623658im
     -0.1375+0.0434988im     0.0393059-0.116611im      0.189696-0.170884im      -0.229692+0.0259923im    0.0104811-0.000633907im   0.0808109+0.0440027im    -0.112552-0.0570793im     0.0100072+0.153394im     0.0573099-0.012739im    -0.0869971+0.0724648im  -0.0550264-0.0441039im    -0.0954595-0.0187724im     0.0798351-0.0339005im  -0.0443566-0.209981im      0.197295-0.00972249im   0.00987037-0.123755im      0.0974167-0.112112im      0.0376723+0.227987im      0.0132116+0.209788im     -0.0607564+0.310009im      0.0312995+0.122796im      0.022213-0.143275im      0.0709857-0.0485141im     0.0993973+0.0904916im      0.183125+0.0401318im   -0.230888-0.251412im      0.0931839-0.0162361im    -0.211839+0.0261244im     0.0410441+0.263349im       0.282192+0.0168939im    -0.0287445+0.0780778im    -0.102027+0.0463977im
  -0.0214023+0.0804304im      0.057551-0.129086im     -0.174269-0.162994im     -0.0159282-0.11902im      -0.104889-0.0336747im      0.142583+0.111173im     -0.151576+0.0719103im     -0.010895+0.0184206im     0.135238+0.0823767im     0.192459-0.168817im     0.201587+0.098584im      -0.219697-0.00582599im      0.14687-0.0627465im   -0.140436+0.076525im    -0.0538307-0.105184im      -0.168376-0.012738im     -0.0211163+0.0220329im     0.0645631+0.124648im      -0.247361-0.0031964im     0.0492225-0.033294im       0.224065-0.00788315im   -0.130628-0.0657365im     0.0100981-0.110476im      -0.051878+0.228059im      0.0703961+0.213103im    -0.137555-0.152093im      -0.143458+0.0913141im     0.154126-0.0480204im    -0.0116344-0.239597im      -0.167879+0.265114im       0.093205-0.0739406im   -0.0353553-0.0513428im
   0.0777576-0.0585456im    0.00449559+0.0311069im    -0.191219+0.00977668im  -0.00738269-0.185651im      -0.21594+0.00202702im    -0.132372-0.00125807im   -0.236203-0.180855im       0.132198-0.0199606im     0.123349+0.00173612im   0.0940306+0.0736675im  -0.0421648-0.117418im        0.15898+0.0976151im     -0.153973-0.143511im    0.0669046+0.101907im     0.0328991+0.118304im       0.117326+0.242842im       -0.04159-0.260725im     -0.0100037+0.0478824im     -0.120998-0.0519673im      0.105598+0.0580231im     -0.118274+0.0229359im   -0.0611223-0.197252im      0.0989083+0.04808im      -0.0476997+0.000496942im    0.205566-0.145091im     0.217937-0.167011im     -0.0876202+0.172914im     0.0544279+0.342215im       0.068962-0.00921284im    0.0454398+0.00347172im    -0.119886-0.0894299im    -0.125899+0.0633651im
   0.0365783-0.0437978im    -0.0113211+0.146175im      0.111578-0.0925624im     -0.162205+0.0796253im    -0.113237-0.136im         -0.125874+0.00866387im     -0.1373-0.0916864im     0.0366121+0.177252im     -0.243126-0.162561im     -0.220606-0.108227im     0.159449-0.0176232im      -0.03723+0.0897955im      0.049633-0.0950086im  -0.0479036+0.196181im     0.0476195-0.0233432im     0.0213028-0.0962728im    -0.0520832+0.0858917im      0.116589+0.035127im      -0.174892-0.166036im      -0.020565-0.171749im      -0.103887+0.46646im      -0.186839+0.0776336im     0.0930124-0.0939891im     0.0705966-0.0227166im      0.136234-0.0720441im    0.075882+0.0368975im     0.0868514-0.105882im     -0.148942-0.108226im      -0.098559-0.113335im     -0.0567901-0.094453im      0.0359297-0.174127im      0.074705+0.0878077im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.10669379281808228 - 0.08855382652491728im
 -0.031932044984711055 + 0.18833430895136302im
   0.22398754710752872 + 0.012664791621880792im
   0.08086202499040315 + 0.14192047289234325im
  -0.07098086671225243 + 0.17055549944324877im
   0.10527981124579876 + 0.054070915512225204im
 -0.045086402296607236 + 0.07447804055973498im
    0.0519935369515839 + 0.20321434596884874im
   0.02981741519861758 - 0.26801826142343277im
  -0.14664004243928977 + 0.10563284813574392im
  0.042309009594165795 + 0.15381231182003177im
  0.056017868986622164 - 0.15629781335603413im
   0.06563373095787024 - 0.009482048891696977im
 -0.028066495431035354 - 0.2183692018426128im
  -0.11404903991769162 - 0.1476781650279409im
  -0.11318879462342793 - 0.07670646624305928im
   0.34156049864753746 + 0.020066517194020986im
    0.1523891104723993 + 0.006091557424943064im
   -0.0696936653807865 - 0.24859898909723138im
  0.019384671780508428 - 0.09868979059390998im
   0.14862765836223374 - 0.06409762764544877im
  -0.08625394668410939 - 0.026718302030937394im
 -0.050702433990771886 - 0.08537269440097166im
  -0.15702154459449694 + 0.027474876499506876im
  -0.05048994951398922 - 0.06292860065918075im
    0.1517196407255716 + 0.010696287180644158im
  -0.02047616790909523 + 0.07512068002339554im
  -0.12262457243277673 + 0.06299835748304908im
  0.052557482892363595 + 0.014150671500069207im
  -0.04556793013884563 + 0.10229825904508469im
    0.3579445458219415 + 0.0im
  -0.13219434182685671 + 0.015562352618167255im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 11:09">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
