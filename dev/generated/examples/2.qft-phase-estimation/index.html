<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.105194-0.0515362im    -0.0383158+0.0330854im      -0.21585+0.0082115im      0.27035+0.19725im       -0.192162+0.103896im     -0.0787776+0.0961126im     -0.0591512-0.0298606im   0.0996696+0.0398274im     -0.064257+0.166088im         0.2806-0.00386576im    0.197403+0.0437454im    -0.341697+0.0985522im     0.0222496-0.064947im     -0.0282909+0.0397762im     0.287769+0.068014im     0.00350479-0.104135im     0.0354779+0.0674875im  -0.0637087-0.0825769im     0.157575-0.134277im       0.096185-0.0414942im     -0.0100229-0.161355im    -0.0659761-0.186804im    -0.0982142+0.0160811im     0.0370318-0.103245im      0.117304+0.11958im      0.0878572+0.133213im     -0.120713+0.179856im     0.0181163-0.0639385im    -0.121739+0.12026im       0.104124+0.0503392im   0.0360601-0.0683508im      0.161123-0.159633im
 -0.0241457+0.0834123im    -0.0671155-0.135211im      -0.176424-0.0717455im     0.244631-0.0295685im    -0.0448233+0.112067im      -0.301874-0.187621im     -0.00391352+0.0945259im   -0.188265-0.0877209im      0.210764-0.166442im      0.0857799-0.088705im    -0.0629071+0.101052im     0.0373431-0.122583im    -0.00478138-0.0321271im      0.086522+0.0334119im     0.018771-0.0361731im     -0.207602+0.0744614im    0.0269345-0.0312572im   -0.143523+0.108063im     -0.015499+0.0134659im     -0.172593+0.0160244im     -0.0161402-0.0339075im   -0.0389344+0.0649193im    0.0701234+0.124209im       0.233825+0.104462im     0.0579585-0.0472474im    -0.191506-0.101703im   -0.00538599+0.0932837im    -0.142637+0.22793im     -0.0781895-0.251965im     -0.118985+0.0336745im    0.289845+0.014272im       0.185562-0.0842473im
   0.321279+0.0334909im     0.0328333+0.0939647im     0.0471897-0.415311im     0.0746528-0.0029201im      0.254612-0.0505106im    -0.0918668+0.0559924im    -0.00466655+0.0267905im     0.02303-0.0265537im     -0.086895+0.124308im      0.0275848-0.0958741im   -0.0284279-0.0646315im    -0.131967-0.0572141im      -0.15914+0.19688im     0.000375039+0.154146im       0.30106+0.00599079im    -0.112446-0.0444977im    0.0864849+0.0142638im   -0.115698+0.0305719im    0.0496742+0.0285418im      0.352056-0.00493786im     -0.183203-0.0639032im    0.0564584+0.153183im      0.169608-0.0110566im    -0.0435041+0.11568im      -0.106908-0.10153im      0.0281606-0.107119im    -0.0136895+0.0717773im     0.135859+0.0337159im  -0.00730801-0.111205im     -0.109663+0.0708664im  -0.0420669-0.00583395im    -0.151754+0.0424117im
  -0.192746-0.149098im   -0.000500547-0.0603995im     -0.135596-0.131027im     -0.204131-0.223223im      0.0866182-0.0502306im     0.0219196-0.09143im       -0.0977401+0.0734046im   0.0356086+0.143585im     0.00251512-0.113542im        0.16998+0.0244184im   -0.0376762+0.0567813im      -0.2573-0.039341im     -0.0332719+0.0967218im     0.0203952-0.0227835im     0.177503-0.145im         -0.139552-0.0184939im   -0.0481422-0.0223204im     0.14063-0.0128308im    -0.110729+0.007066im      -0.188306+0.214615im       0.0330336-0.22968im      -0.015291-0.00248248im  -0.0822923+0.110645im      0.0971244-0.0843448im    -0.193431-0.286814im     0.0136038-0.108405im    -0.0604077-0.0500987im    0.0391031-0.146551im      0.282138+0.0872573im   -0.0603765-0.173892im    -0.146252-0.121653im       0.165623+0.0629799im
 -0.0994124+0.162482im    -0.00909269-0.0829749im     -0.169037+0.0740401im    0.0326417-0.115897im     -0.0235753-0.427185im     -0.0652356+0.0999714im       0.164186-0.0927477im  -0.0125624-0.18667im      -0.0117265+0.0750453im      0.149735-0.211657im    -0.0914165+0.0932312im   0.00644057-0.0655958im      0.107226-0.148178im       0.100772+0.0474819im    0.0813895+0.0516761im      0.230724-0.0569442im   -0.0814725+0.113589im     0.173761-0.143868im    -0.0507761+0.0242241im      0.114479-0.0402841im       0.132558-0.0287813im    -0.269998+0.103774im     0.0101235+0.183445im       0.047019+0.0530711im     0.118504-0.206183im      0.153742+0.064005im     0.0228096-0.142773im     0.0524388-0.0230368im   -0.0118475-0.0320442im    -0.149515+0.138776im     0.113247-0.00662081im     -0.14295+0.143505im
   0.120872-0.142328im       0.140328-0.0611994im       0.10605-0.124842im      0.115695-0.075768im      0.0821477-0.0168897im    -0.0655158-0.285447im        0.183744-0.118106im     0.191739+0.205636im      0.0272455-0.290515im    -0.00124051-0.133494im     -0.144997+0.0339251im    0.0627382+0.114842im     -0.0700214-0.129604im     -0.0648306+0.0914381im   -0.0733994-0.260331im       0.127089-0.159804im      -0.13185+0.108727im    0.0732662-0.0407362im     0.207289+0.190239im    -0.00777964-0.057852im      -0.0953592-0.181464im    0.00704874-0.126869im      0.114238+0.00666749im   -0.0872527-0.253189im      0.198618+0.0326746im    0.0226236+0.050155im    -0.0250028+0.0744218im   -0.0467815-0.0173576im   -0.0093456-0.0616807im     0.146977+0.155832im   0.00206043-0.0242037im     0.0652092+0.12726im
  -0.268517+0.146428im     -0.0862117+0.0722709im     0.0873635-0.070575im      0.151578-0.0907598im      0.142575-0.311307im     -0.0171665-0.072987im       -0.309551-0.175924im    -0.173517+0.170433im     -0.0880432-0.0182209im    -0.0715336-0.0354968im   -0.0843715-0.237142im     -0.138839-0.0357823im     0.0321048+0.00710061im    0.0273457-0.0648937im    0.0308837+0.0232742im   -0.00581118-0.0735382im     0.074484-0.0346174im   0.0151277-0.152906im     -0.180998+0.263516im     -0.0336556-0.214265im        0.108703-0.00992892im    0.122204-0.0191289im   -0.0148724+0.0779298im     -0.137162+0.0483337im   -0.0325369+0.0532857im   -0.0745306+0.119534im      0.149875+0.176284im    -0.0684827+0.0615916im    -0.130623-0.13706im       0.158237-0.0503777im    -0.12507+0.00774798im    0.0671949-0.16179im
 -0.0599681-0.128367im       0.121041+0.203191im      0.0347241-0.0342359im     0.204057+0.0579661im     -0.081427+0.0826056im     -0.157609-0.119813im       -0.106609+0.24585im    -0.0479616-0.367859im      0.0844759-0.0245514im    -0.0111267-0.149019im     0.0622164+0.00793362im  -0.0746775-0.0754173im   -0.00303616+0.11262im       0.0225083-0.206453im     -0.205865+0.0380643im      0.101523-0.205006im    -0.0289951-0.0610954im      0.1988-0.0291128im    0.0689868+0.248791im      0.0980074+0.000617855im   -0.0751527+0.0485433im      0.18477+0.0285868im    0.0686862+0.00132492im    0.0798612-0.048838im     0.0254853-0.232252im     -0.111659+0.0970105im   -0.0596669-0.113373im   0.000464185-0.257852im   0.000658893+0.151826im   -0.00313632-0.0391712im  -0.0482834+0.0397778im      -0.11483-0.196381im
   -0.14713-0.0216894im     -0.141488+0.074122im     -0.0913672+0.118339im     0.0581421-0.136057im      -0.251519-0.0126154im     0.0507008-0.0110317im      -0.150596+0.0748009im  -0.0720963-0.0357868im     -0.126262-0.240949im       0.262712+0.108103im    -0.0238577-0.115228im      0.200808-0.0488047im     0.0197006+0.0981703im    -0.0232355+0.200915im     0.0277986-0.0257704im     0.0549233-0.0909613im    -0.176062-0.0307959im  -0.0541343+0.125149im    -0.0591438-0.148496im       0.148465+0.0232794im      0.0126804-0.0640769im     0.209235-0.117555im      0.409245-0.0131142im     -0.195962+0.190158im     0.0180075+0.101678im    -0.0226601+0.0635936im   -0.0696227+0.0262955im    0.0185986-0.100041im      0.111635-0.0640301im  -0.00762961-0.0397812im   0.0654976-0.198986im      -0.128135+0.141327im
   0.155069-0.0548749im     -0.146395-0.193881im      0.0939346-0.0207465im    -0.108763-0.0376001im    -0.0962062-0.0995652im    -0.0287065-0.17305im        0.0320954+0.102077im    -0.199305+0.0789618im     0.0270053+0.224297im     -0.0890318-0.294437im      0.138677+0.0725971im     0.047297+0.101361im     -0.0962657+0.00785311im    -0.196953+0.0129827im   -0.0555436+0.0953572im      0.161911-0.0629605im    -0.139807-0.0682734im   -0.035917+0.00922608im  -0.0605464-0.285869im      0.0131129-0.0530298im     -0.0087377-0.0734804im    0.0977832-0.336895im     -0.078161+0.134207im    -0.00192444+0.079654im     0.0195055-0.179148im     -0.251962+0.104984im        0.1123+0.10829im       0.262455+0.0128631im    0.0474214-0.0909104im   -0.0233283-0.0229229im   -0.109864+0.0891182im     0.0713034-0.0275068im
  -0.204382-0.029308im      0.0988586+0.00686374im      0.17939-0.0281091im    -0.212978+0.198719im      0.0226042-0.152327im      0.0144422+0.0938119im      0.0248669+0.0184865im   0.0472969+0.0313039im     0.0609121+0.17581im       0.0493071-0.126415im     -0.129867-0.429016im    -0.0207817+0.113427im     -0.0818144+0.0405445im    -0.0670115-0.0210247im   -0.0639031-0.0174943im     -0.127173+0.103265im     0.0258582-0.005073im   0.00220455+0.146808im      0.173954-0.0881571im    -0.0859179+0.222289im     -0.00467014+0.060957im     0.0553285-0.0241529im     0.143059+0.0806343im      0.120343+0.138627im      0.100826-0.251442im    -0.0381075+0.102519im     -0.136628+0.0512745im    -0.146249-0.0317183im    -0.159626+0.0678902im     0.145538+0.22838im      0.176967-0.12654im       0.0953525+0.0840393im
   0.118392-0.0202337im      0.136495+0.0134697im       0.11028+0.111809im    -0.0336569+0.215646im      -0.046425-0.0547376im      0.019265+0.21505im       -0.0129354+0.0602967im  0.00681948-0.0427967im     -0.196184-0.150221im      -0.185455-0.0708123im    -0.122587+0.0546099im     -0.25013-0.30396im        0.129309+0.00146753im   -0.0852381+0.0916354im    0.0347918-0.199115im      -0.037438-0.0956314im    -0.199398-0.0478347im  -0.0610351-0.00221805im  -0.0413297-0.0843957im    -0.0396317+0.0180758im     -0.0800291+0.115677im     0.0902298+0.106707im    -0.0472935+0.179974im    -0.00371586+0.032553im      0.133319+0.0322375im     0.064085+0.10053im       0.298741+0.226081im    -0.0148163-0.0600729im     0.304429+0.060539im   -0.00960419-0.0160061im    0.228878+0.0682358im      0.121863-0.0497715im
  0.0296893+0.0615171im     0.0278267+0.0132341im     -0.262754-0.205248im     -0.110119-0.0588554im      -0.11096+0.160572im       0.266076+0.0801777im       0.100757-0.202001im    0.0857874-0.0152976im   -0.00268802+0.0897581im    -0.0350799-0.0310775im    0.0558137-0.111631im      0.112611-0.107803im    -0.00458831-0.3546im        0.0334575+0.0255075im    0.0820675-0.0889436im    -0.0989439-0.0440755im   -0.0231491-0.298444im    0.0437604-0.177863im     -0.070738+0.166166im       0.103292+0.122794im       -0.109668+0.102628im      0.118561-0.0877871im   -0.0397363-0.0921676im     -0.040293-0.0616458im    0.0986858-0.200015im      -0.17453+0.209246im    -0.0648879+0.0403026im   -0.0206204+0.027862im    -0.0370087-0.130647im    -0.0407554-0.255869im     0.171187-0.019901im     -0.0370566-0.0264851im
 -0.0632728-0.0562428im    -0.0143458-0.0277804im     -0.122202+0.00744201im    0.160781-0.0124251im     0.0438082+0.0540445im       0.07435+0.0522398im      0.0691241-0.167283im    0.0343427+0.00740997im   -0.0106644+0.260477im      -0.124556+0.0632931im   0.00384732+0.166692im     0.0708573-0.0596773im     0.0512626+0.254762im      -0.179857-0.54675im      0.0853916-0.065798im       0.157926-0.0497863im    0.0104587+0.0953719im  -0.0864068+0.117588im    -0.0337579+0.170534im      -0.104243+0.185534im       -0.110228-0.0941733im    -0.102347-0.0539099im     0.213033+0.00917824im   -0.0522137+0.144484im     0.0788889+0.0158168im   -0.0111317+0.120312im     0.0441644+0.169324im    -0.0909892+0.107623im      0.118006-0.0355442im   -0.0646163-0.0219371im  -0.0226225-0.0774266im    -0.0084672+0.185985im
 -0.0130255-0.0730002im     -0.168928-0.229482im     0.00457968+0.0321469im    0.0821585+0.121925im      0.0768285+0.0616838im   -0.00177351+0.184164im       0.0143537+0.179463im    -0.268528+0.107426im      -0.128643+0.170881im         0.1256+0.30585im      -0.169173-0.0485004im     0.306675-0.0311092im     -0.175364-0.072532im    -0.00110463-0.0525916im   -0.0519524-0.192503im     -0.0868312-0.0304438im    0.0426753-0.0997143im    0.251475-0.217474im      0.118668+0.0261578im     0.0796669-0.100275im       -0.116098-0.232663im    -0.0447373+0.116121im     0.0467845-0.00722832im    0.0511405-0.0159409im    0.0483928-0.0340727im  -0.00877904+0.0118626im     0.188461+0.0183617im    0.0245261-0.146129im    -0.0247732+0.0706979im    -0.115685+0.118078im    -0.037778+0.0529591im      0.128752-0.077027im
  0.0809352-0.0796161im      0.169308+0.130206im       0.022704+0.0378936im   -0.0747788+0.192841im       0.196707-0.236333im       0.157412-0.00263486im    -0.0531829-0.182252im     -0.19519+0.0393568im     0.0612302-0.0989234im      0.185216-0.043865im     0.0610412+0.102839im      0.103707+0.0945752im     0.0737575-0.0521405im      0.153335-0.0668021im   -0.0105983-0.00425004im    -0.168038-0.314626im    -0.0450683+0.158497im     -0.10837-0.0971148im    0.0117645-0.140152im     -0.0608589+0.175182im       0.0553365+0.0153518im   -0.0772757-0.115998im       0.28061-0.153697im       0.156991-0.0866232im   -0.0142232+0.0430793im    -0.148009-0.0779828im     0.125784+0.0484135im    0.0309492+0.0643449im    -0.104849+0.189269im     -0.176037-0.162397im    0.0159984+0.0826243im    -0.0680679-0.159801im
  -0.115847+0.158814im      0.0956425-0.173026im    -0.00116498+0.0402958im   -0.0703514+0.0586852im      0.131788-0.046825im      0.0526694+0.0352648im      0.0199608+0.0494563im    0.140412+0.0891723im      0.160025+0.00949148im     -0.11835+0.0468685im      0.18599+0.230167im    0.00992282-0.140264im      0.0638778-0.0386374im      0.197387-0.0638086im  -0.00287037+0.0817917im     -0.138052-0.0722299im      -0.1501-0.382481im    -0.012823+0.232255im     0.0598193-0.00349177im    0.0430385-0.0420206im       0.193545-0.180946im     -0.017556-0.0415382im     0.183037-0.0944581im     -0.130146+0.03727im      0.0650974-0.116252im      0.156156-0.113357im    -0.0524612+0.166679im     0.0237174-0.182831im    -0.0075346-0.135238im      0.121973+0.223215im   -0.0843203+0.0892488im    -0.0851663-0.203295im
  0.0567957+0.0332798im     -0.106966-0.0418391im     0.0323586-0.00677872im   -0.003536-0.0904im         0.144916-0.0891385im      0.114847-0.0703473im       0.101388+0.149327im     0.145198-0.140929im      -0.175862-0.117365im      -0.136886+0.0633149im   0.00444725-0.126065im    0.00694712+0.0395937im     0.0646944+0.181118im       -0.11818-0.156541im     -0.111542-0.23851im      -0.0179046-0.121716im     0.0588967-0.0588341im   -0.182693-0.258447im     -0.114378-0.0951121im     0.0723935-0.0927752im       0.192097-0.160274im     -0.122053-0.0668929im   -0.0442966-0.136911im       0.244836+0.122436im      0.012732+0.0473176im    0.0733163+0.058931im     -0.312237-0.058195im      0.184682+0.0277109im    0.0154116-0.0617496im    0.0828467-0.0211699im    0.271116-0.0943402im     0.0367625-0.211864im
  0.0228494+0.111162im      -0.178266+0.11153im       -0.123204-0.166539im     -0.199298+0.113098im       0.110646+0.108707im     -0.0932876-0.187481im       -0.105898+0.0130799im   -0.155918-0.169633im     0.00282919-0.0173043im    -0.0282409+0.125975im    -0.0879635+0.0588412im    -0.184796-0.00111284im     0.120501-0.127146im     -0.0255263-0.0713391im  -0.00508955-0.210409im      0.0612211-0.00499321im    0.167375-0.0150347im  -0.0185062+0.00434836im   -0.206055-0.319258im      -0.104661+0.0119896im     -0.0252375-0.130068im      0.126403-0.0283385im    0.0818524-0.0846864im     -0.169518-0.157723im       0.13129-0.0990711im     0.126496+0.213433im     0.0153617-0.109956im     -0.155479+0.117344im     -0.057741+0.0837907im   0.00607629+0.250779im   -0.0453026+0.175051im      -0.172633+0.0878211im
  0.0337427+0.233077im       0.139423+0.0995861im     0.0742127-0.0585961im    0.0969523+0.13774im      -0.0536491-0.122316im      0.0852623+0.0143718im       0.249578-0.0320033im   0.0344633-0.0498085im     0.0132541-0.179119im       0.119637+0.119967im     0.0837213-0.103564im     -0.117848-0.0121418im    -0.0955873-0.0501794im    -0.0187448-0.0614039im   -0.0560422-0.00459459im     0.127696+0.0210022im     0.253069-0.111255im    0.0469172+0.181913im     0.0919766-0.0993389im     -0.286268-0.320372im       -0.137445-0.00125806im   -0.135218-0.0316311im      0.10882-0.0739442im     -0.187888+0.0359653im    -0.183566-0.116677im    -0.0803648+0.155813im    0.00261421-0.0367451im     0.139867-0.051235im     0.0908803-0.051581im     -0.272303-0.0644602im  -0.0352847-0.125388im       0.201382-0.0458265im
  0.0557698-0.315647im       0.117057+0.149663im      0.0780881+0.109784im     0.0379184-0.111515im    -0.00934591+0.00306791im     0.123797+0.177531im       -0.110728+0.0814775im    0.108439-0.0946542im      0.157758+0.0917351im    -0.0811945-0.111689im     -0.163075-0.0200481im   -0.0671117+0.0114307im      0.105275+0.05706im      -0.0124339+0.0888863im   -0.0954202+0.206949im    0.000579305+0.0393911im   -0.0678494-0.0524458im    0.131241-0.090757im    -0.0687049-0.0830644im    -0.0454313+0.00261926im     0.0146304-0.47207im     0.00464414+0.0598659im   -0.0198687-0.126407im      -0.280999-0.0646382im   -0.0893207+0.0015416im   -0.0162369+0.023479im    0.00142856+0.0281231im   -0.0899676+0.205395im     -0.164426-0.142268im      -0.22948-0.0103655im    0.184838+0.0189331im      0.123901-0.0147845im
   0.046598+0.0085859im    -0.0712408-0.238948im       0.234546+0.0200416im   -0.0164926-0.132049im      -0.139458-0.0404606im      0.049948+0.154672im      -0.0738396-0.0945808im   0.0290121-0.193279im     -0.0274716-0.0615923im      0.101762+0.102729im      0.029833+0.022444im     -0.101075-0.0615275im    -0.0676779+0.209035im    -0.00801255+0.151732im    0.00326891-0.0737803im      0.100248+0.0644073im     0.148203-0.142966im   -0.0872483-0.0253553im       -0.166+0.257769im      0.0242205+0.0287428im      -0.060621+0.0900043im    -0.100106-0.452745im     0.0439389-0.0438692im     0.0285084-0.186586im    -0.0306039-0.113368im    -0.0234458-0.189654im     0.0129872+0.106204im     -0.167917+0.0248599im   -0.0930568+0.188873im     -0.153562+0.173016im    0.0893448+0.145738im    -0.00944844+0.0208715im
  -0.116193-0.0793195im    -0.0776101+0.0361384im      0.174537+0.0719215im   -0.0788566+0.0634212im    -0.0774617-0.037824im      -0.325401-0.0017938im     0.00686652-0.0229889im  -0.0291087-0.0364471im      0.144092+0.0529814im     0.0178235+0.100189im     -0.155014-0.0573879im   -0.0504688+0.174716im     -0.0531705+0.0299745im     0.0404783-0.114144im      0.295133+0.00371883im     0.148712+0.0785337im    -0.195151-0.0977404im   -0.129247-0.206434im      0.019314-0.00393945im   -0.0836421+0.0144582im      0.0230226+0.211968im    0.00758864+0.0794764im    0.0424164-0.437365im     -0.0729553-0.172741im        0.1824-0.0994244im    0.0349002-0.117994im     0.0406943+0.0196388im     0.173005-0.0487216im     0.147784-0.239376im     -0.068111-0.0711741im   0.0554148-0.0459505im     0.0208176-0.0328402im
  0.0709963-0.0621498im     -0.094916+0.279899im     0.00303315+0.15137im      0.0584347-0.069184im      -0.125675-0.211864im      0.0696643-0.106429im        0.232932+0.19866im     0.0285102-0.197987im      0.0517663+0.101797im     -0.0473922+0.14622im     -0.0354924+0.0068087im    0.0893644-0.159364im      -0.159254-0.0147937im     0.0807402+0.0315788im     0.183728-0.121023im      -0.257924-0.11545im       0.145645+0.114813im      0.18921-0.011532im     0.0832686+0.0175215im    -0.0993898+0.209773im        0.143247+0.116383im     0.0101988-0.178029im     -0.136176+0.0443863im     -0.149306-0.0737929im   -0.0749971+0.0405267im   -0.0515022-0.0015095im    0.0286423+0.174385im     0.0638687+0.177734im     0.0804801-0.142316im      0.133525+0.192542im    -0.111187-0.0471716im    -0.0720062-0.0743172im
 -0.0316151+0.181436im       0.175624+0.0488868im     0.0487956-0.00819791im    0.176397+0.00263906im   -0.0698052+0.0533466im      -0.13621-0.120091im      0.00496504-0.0818333im    0.100573+0.076526im     -0.0787046+0.177701im     -0.0380823+0.173704im      0.299236-0.190732im      0.186318-0.00907958im     0.286002+0.207363im       0.293529+0.133932im    -0.0787806-0.12242im       0.0510666-0.00882989im   -0.196809-0.0151853im  -0.0476856-0.166184im     0.0340756-0.0482371im    -0.0848039+0.0549451im     -0.0131189-0.0854753im     0.191196+0.0451312im   -0.0799864+0.0382475im     0.0853004-0.0933426im    -0.129581-0.192045im     0.0531558+0.0426056im    0.0691775+0.0407447im     0.123165+0.238937im     0.0465821+0.108639im     -0.103723+0.125083im   -0.0279292-4.82722e-5im    0.0540316+0.139409im
  -0.102154+0.183718im      0.0815755+0.0958677im    -0.0969678-0.195304im      0.100005-0.135727im     0.00529685-0.0651741im     0.0298626-0.137467im        0.010876+0.189458im    -0.133927+0.0973904im   -0.00104464+0.181364im      -0.237265-0.00525952im    0.102427-0.0690091im   -0.0976767-0.177222im      -0.112149-0.0589597im    -0.0481462+0.0297148im    -0.124151-0.122245im       0.188305+0.017559im    -0.0809642+0.0172816im   0.0693851-0.0564196im   -0.0265662-0.171384im     0.00319018+0.21091im        0.0220313+0.116036im     -0.128211+0.00901706im   0.0778325-0.057246im       -0.17968-0.115885im     0.0488309+0.217986im    -0.0119152-0.345734im    -0.0317933+0.0802759im   -0.0190552-0.229987im     -0.211181+0.129543im     -0.124651-0.0525979im    0.160945-0.102247im       0.144053+0.0606698im
  0.0477255-0.0161859im     0.0111507-0.076896im       0.263156+0.0541898im    0.0924391-0.0778062im    -0.0105559-0.106576im      -0.151088+0.0584404im     -0.0832803-0.125541im    -0.090184+0.0304581im     0.0732534+0.233102im      -0.047943+0.108032im    -0.0592165+0.141109im    -0.0812529-0.0767494im     0.0639186-0.131733im      0.0212381+0.111867im     0.0288315-0.316159im     -0.0907312+0.0614954im    -0.247664+0.0507119im   0.0999275+0.142148im    -0.0114208-0.0194122im     0.0210462-0.0492898im      -0.096553+0.0607493im    -0.115293+0.0313838im    0.0561638+0.00676975im    -0.111743+0.10559im     -0.0331079+0.0547im       -0.154759+0.168018im     -0.510762-0.114726im    -0.0450161+0.120139im      0.046088+0.142143im    -0.0274844-0.134513im   -0.0947391+0.0467137im    -0.0224172-0.164817im
   0.199475+0.040915im      0.0183818-0.0261869im    -0.0559054+0.0625506im    0.0891254+0.0134755im      0.196031-0.0252032im     0.0467583-0.0197759im     -0.0758731+0.0492533im  -0.0862037-0.151276im      0.0304386+0.0262567im    -0.0452026-0.0456408im     0.118279+0.0955643im    0.0932505-0.00835341im     0.123507-0.0608795im    -0.0152926+0.284169im     0.0750678+0.018266im      0.0619021+0.392501im      0.111172+0.177168im    -0.167129-0.214827im     0.0659132+0.175755im      -0.216354+0.163864im         0.12346-0.113433im    -0.0135596-0.00451262im    0.114064-0.169052im     -0.0976712+0.141397im   0.000207043-0.0873397im     -0.11932+0.196542im     0.0169015+0.0561954im   -0.0229339-0.338069im      0.101639+0.0659189im     0.167463+0.0211908im  -0.0328357-0.0386527im      0.100372-0.00670064im
    0.11152-0.0574405im      0.299056-0.25516im      -0.0517522+0.144322im    -0.0667957+0.12353im      -0.0133564+0.0493691im     0.0611753-0.0523773im      -0.209883+0.280514im    0.0370274+0.167785im     -0.0227091+0.0265251im       0.12467+0.099534im    0.00296346-0.00440478im  -0.0100409-0.150348im       0.101725+0.113286im     -0.0287545+0.0272433im    0.0614053-0.0261514im      0.182373-0.101398im      0.132404+0.0612044im    0.032657-0.136415im    -0.0831204-0.0823437im     -0.104971-0.0484257im      -0.117733+0.168705im      -0.21159+0.101659im     0.0575114+0.0901625im    -0.0572802-0.151543im    -0.0571964-0.15302im      -0.131068+0.0264146im   -0.0945934+0.0720275im   -0.0276587+0.0584945im    -0.185104-0.272097im        0.2001-0.0676694im  -0.0107045-0.117478im      -0.264761+0.00688958im
   0.160308-0.0167157im      -0.20279+0.0775568im     0.0971283+0.158957im     0.0384605-0.0124183im   -0.00827967+0.0574945im    -0.0313031-0.246545im      -0.0117636-0.135285im    0.0232832+0.26546im      -0.0522985-0.0330311im    -0.0292101+0.0228471im    -0.150128+0.0937156im   0.00227996+0.100245im       0.364176-0.00134392im    0.0860582-0.133619im     0.0546875+0.0293533im     -0.045865+0.0614168im     0.237668+0.0206624im    0.197976-0.0167258im     0.130932-0.0613871im      0.119383+0.0163104im     -0.0451296+0.113468im     0.0761331-0.0866542im   -0.0835521+0.08308im       -0.155496+0.17267im     -0.0665686-0.230555im     0.0658372-0.146803im    -0.0623999+0.155348im   -0.00849298-0.218297im    -0.0512632+0.0630902im    -0.158305-0.0339714im    0.295607-0.0436334im    -0.0732502-0.0845822im
   0.097983+0.213682im     -0.0121556-0.156188im        0.11996-0.0285701im    -0.173782+0.0563935im      0.110892-0.0714809im     -0.155706+0.0166706im     -0.0945627-0.0501636im  -0.0317782-0.0815332im      0.237589+0.133744im      0.0794549-0.096577im      0.135619+0.132929im     0.0601364+0.0277226im    -0.0526801+0.221403im       0.104158+0.0279045im  -0.00551651-0.0542317im      -0.11183-0.14018im      0.0995839-0.0612513im    0.206646-0.0011714im   0.00489726+0.0363109im    -0.0403248-0.00330116im    -0.0743022-0.0666485im     0.140902-0.103361im     -0.144882-0.0087268im    -0.0477616-0.0886054im    0.0240871+0.313775im      0.106805+0.185325im      0.105188-0.117109im    -0.0832841-0.0947054im    0.0535571-0.0471596im    0.0279781-0.141183im     0.258906-0.403111im     -0.0406938+0.0898578im
 -0.0897398-0.147154im      0.0107214-0.137491im      -0.145001-0.0465627im    -0.149331+0.199926im     -0.0757706+0.0976041im     -0.128549+0.000137654im     0.133389-0.103472im   -0.0376575+0.0537435im     0.0305309+0.0881885im     0.0175792-0.212899im     0.0655042-0.184461im       0.03465-0.233004im      0.0470129-0.0314169im     -0.174697+0.109922im     0.0168681-0.169229im       0.146075+0.0365565im     0.101507+0.132126im    0.0769071+0.00660385im   0.0545417+0.157654im      -0.151052-0.106417im        0.153144-0.12675im       0.133591-0.0594623im    0.0654836-0.0983074im     -0.111713+0.146002im    -0.0753976+0.0355229im     0.127539-0.28266im      0.0474966-0.0513im       0.0556358+0.205988im     0.0901844+0.127746im    -0.0412305-0.038394im     0.022827-0.0904205im     -0.238453-0.323445im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
    0.1952467120210874 + 0.10676402202562583im
   0.06033806975218419 + 0.15858396986641493im
  -0.13258059056706606 - 0.13098640668569164im
 0.0013485470176703217 - 0.0012369644013710808im
  -0.03211962269773265 - 0.03755565179389022im
   0.04882752267193369 + 0.28099125330616115im
   0.02510143402827375 - 0.1036216837887078im
     0.156475838338859 + 0.14255519673842137im
  -0.14330192350097276 + 0.20763667225115287im
   0.17596883684987152 + 0.019415228427439576im
   0.07374946865427365 - 0.11079841084284099im
   0.02726423733656519 + 0.03838256361685722im
  -0.11797544854868419 + 0.04745947260996328im
   0.09649753508319849 - 0.029773126314978842im
    0.1023561941930549 - 0.02022469384693526im
     0.286864333580624 + 0.0im
  -0.02903282521844235 + 0.07601249435869607im
   0.11114599606651185 + 0.06477553814533255im
   0.07041956247616277 - 0.11074741914380787im
   -0.2011560527860547 + 0.11840977987686167im
  0.038415830422125555 - 0.10661617026939742im
    0.2581496165065285 + 0.12304425942826824im
    0.2709737249765922 + 0.07181270785324624im
   0.18985545780537344 - 0.04168390199006217im
   0.07789407978734385 - 0.07820990417429684im
   0.11104238057048933 + 0.009724033567421277im
  -0.08522109715740726 - 0.2199701503762839im
   -0.0790625136024898 + 0.19353071901004631im
  -0.08821632404677793 + 0.12147925332281348im
  -0.03736292284771757 + 0.051784270348280134im
  0.062488525865724176 - 0.0004889217902360257im
   0.22840336667217148 - 0.0021892568709613452im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 31 January 2025 16:40">Friday 31 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
