<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor Network Backend</a></li><li><a class="tocitem" href="../../../man/paulipropagation.html">Pauli Propagation Backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  0.0140591+0.101968im       0.15549-0.0323517im      -0.14839+0.0715348im   -0.00719381+0.316878im      0.0747302-0.167582im       0.0694253+0.0608623im      0.0643174-0.00479527im    -0.232365-0.0380419im    -0.0334935-0.178713im       0.183902-0.212953im       0.0880974+0.166071im     0.171004-0.0163708im      -0.376594+0.158417im    -0.0820231-0.0140123im    0.0653896-0.0447538im    -0.0122713-0.0572943im    -0.0721693+0.0382059im     0.0399942-0.168189im       0.119817-0.0922299im    -0.0167826+0.073394im       -0.101853-0.18544im     0.0115407-0.181333im      0.0385595+0.0830023im    -0.0504166+0.0186057im     0.0946752+0.08277im      -0.0197189+0.0493334im      0.0260102-0.0650755im     -0.211936+0.0530037im     -0.0373196+0.33876im      0.00723064+0.0304552im    0.162914+0.048241im    -0.0108698-0.0513209im
   0.167114-0.0245131im    -0.204788-0.100772im       0.173237+0.158279im      0.0130862+0.0958461im      0.169482-0.128601im       0.0386358-0.00544198im    -0.0460997-0.0951629im   -0.00588506-0.103023im     -0.0339847+0.192109im      0.0838129+0.160364im     -0.00186838-0.161951im    0.0412392-0.293415im       -0.034385+0.0322786im    -0.121976-0.122465im     0.0813537-0.025088im        0.17957-0.127258im      0.0321642+0.157048im       0.208007-0.0554676im    -0.0590164+0.0770471im    -0.0857868-0.140813im      -0.0653216-0.0759961im   0.0861732+0.0147156im    0.00622011+0.161861im      -0.313646+0.159002im      -0.210967-0.0123948im      0.074498+0.0380926im       0.226991+0.100143im       0.142621+0.00766386im    -0.0458543+0.0342943im     -0.148879+0.138252im   -0.0815267-0.138744im     -0.178023-0.0417294im
  -0.195989-0.195423im     0.0499888+0.092208im      0.0427499-0.0325913im     0.0254355+0.0779692im     -0.075121-0.149628im      -0.0282914+0.155547im        0.143411-0.127361im    -0.00383654-0.0727555im     0.0541295-0.112623im      -0.179397-0.18114im         0.171909+0.0632673im   -0.185105-0.00916777im     0.0830298-0.114537im      0.279332-0.12259im     -0.0607489+0.245589im       0.146604+0.0781051im    -0.0687685-0.0334897im    -0.0743825-0.123269im        0.19554+0.108189im      -0.176659+0.0947764im      -0.184796+0.0324605im  -0.0727646+0.0139145im       0.11342+0.208577im      -0.156988+0.00405139im    0.0737764-0.0806751im      0.158438+0.0298975im      -0.120818+0.00752733im     0.174039-0.0254649im      -0.170477+0.00783422im   -0.0546224-0.0453049im    -0.13533-0.0936836im   -0.0659418-0.258669im
  -0.112954-0.0252873im     0.291256-0.00196862im    0.0727736-0.123124im       0.115112+0.0634397im      0.145326+0.135606im        0.225391+0.178047im       -0.106348+0.0152177im    -0.0139955-0.0308623im      0.204321+0.0758422im    -0.0277311+0.354744im      -0.0157244+0.205756im    0.0209111-0.191727im       0.0896554+0.160969im      0.164351-0.0759681im  -0.00853714-0.258035im      0.0471111+0.164099im       0.063308-0.115362im     -0.0605525-8.19984e-5im     0.106116-0.147085im      0.0607087-0.0845117im      0.0776319-0.209432im     -0.12566-0.111636im       0.055027+0.0429414im     -0.087075-0.0311677im     0.0978916+0.0954102im     0.0396162-0.103405im      -0.0136801-0.187014im       0.166268-0.078094im        0.078502-0.0658526im     -0.104363-0.0768414im   0.0586967-0.0176594im     -0.13731+0.0829438im
  -0.213748-0.0163342im   -0.0892925-0.13959im      -0.0843096+0.300125im     -0.0368393+0.177428im    -0.00914695+0.209433im      -0.0386259+0.087266im       0.0626501+0.181929im      -0.144532+0.0531653im      0.284319-0.0408141im     -0.122147+0.00991444im   -0.00547479-0.116898im     0.015995+0.112278im       0.0866441+0.00435798im  -0.0407506-0.0951461im   -0.0764197-0.215431im       0.119264-0.182487im      -0.218581-0.0270697im    -0.0686733+0.0144982im      -0.02621+0.117671im      0.0142446+0.0737974im       0.111412-0.027166im    -0.290025+0.0221699im     0.0404193+0.184299im       0.106772+0.106769im    -0.00920119+0.186514im      -0.086644+0.20357im          0.19848+0.0774646im    -0.0625002+0.0582193im      0.0924893-0.11988im       0.0409582+0.056681im    -0.160064+0.0386215im    0.0918223-0.105041im
  -0.215552+0.0402674im   -0.0483359+0.00881098im   -0.0860115-0.0786597im       0.13858+0.0403847im    -0.0378461-0.0958858im      0.0886834+0.0883463im       0.143705-0.0588963im     -0.203144+0.108193im      -0.127333-0.077045im      -0.191008+0.129559im      -0.0294103-0.040421im    -0.148781+0.140183im       -0.236234-0.00473006im   -0.212765-0.0120049im    -0.172666-0.121743im     -0.0416854-0.0112531im      0.211183-0.145881im       0.168603-0.0919959im     -0.108786+0.150613im      0.0721828-0.0670228im     -0.0622127+0.14503im     -0.168911-0.0963224im     -0.295197+0.125034im       -0.12487-0.0680187im    -0.0879966-0.056642im       0.168737-0.13425im        0.0463917+0.0232174im    0.00710605+0.0406554im      -0.184936-0.206176im      0.0398425-0.0569064im    0.152268-0.0796857im    0.0480263+0.190598im
 -0.0366309-0.116871im     0.0632146+0.275854im       0.119947-0.0196871im     -0.256746-0.132686im     -0.0452571+0.0960157im      0.0534175+0.0358423im     -0.0326716+0.016821im     -0.0719162+0.16311im      -0.0149134-0.0303174im    -0.0144847-0.195467im        0.133496-0.032108im   -0.0413181-0.0496125im       0.234858+0.091432im     -0.216209-0.0486191im    0.0354348-0.0152659im     0.0843753-0.0373839im     -0.147142-0.107962im    -0.00545117-0.0536864im    -0.0952341-0.00835945im   -0.0203539-0.135696im       0.0205016-0.108446im     -0.15274+0.15119im      -0.0451793-0.0346487im    -0.0467713-0.368803im      -0.157227-0.01517im        0.177972-0.0885711im       0.144015-0.147829im        -0.2934-0.0095871im      -0.058394+0.179819im      -0.186764+0.0717434im  -0.0364509+0.0188475im    -0.178673+0.0790214im
   0.155025+0.149083im    -0.0724967-0.0587924im     0.0264966-0.148512im     -0.0920692-0.00440653im    0.0129557-0.0177468im      -0.131644+0.255271im        0.132566-0.177809im      -0.243056-0.2324im        -0.107497-0.0885697im    -0.0386725+0.00731734im     -0.159495+0.0545959im   0.0242353+0.0743009im       0.341572+0.182155im    -0.0535083-0.192183im    -0.0144978-0.164337im     -0.0100093+0.0375282im   -0.00315425-0.0607087im     0.0229737+0.138827im      0.0516198+0.0180276im     -0.121961-0.0564326im     -0.0828782+0.0121567im   0.0619079-0.0308193im      0.142177+0.0536003im     0.0876041-0.131178im      0.0655653+0.0156799im     -0.217057-0.166279im     -0.00338233+0.130184im      0.0586253+0.224449im       -0.146167+0.0772837im        0.2541+0.150191im   -0.0937374-0.0697915im   -0.0106668+0.109753im
  -0.197626+0.133933im      0.123262-0.271836im      0.0388339+0.0662689im    -0.0282481+0.042116im      0.0184381+0.0280546im     -0.0600838+0.0721143im       -0.17204-0.174181im      -0.158859+0.0172457im     0.0530212+0.315513im      0.0248119-0.0217586im      -0.036658+0.0127677im   -0.126592+0.0611858im      0.0986512+0.0909795im    -0.034574+0.210951im     -0.120897+0.136905im     -0.0620464+0.190158im      -0.165586+0.280714im       0.154487+0.0273811im    -0.0622708-0.099551im     -0.0232663+0.054497im      -0.0474736-0.0196823im    0.144921-0.138926im       -0.10692+0.0482347im      0.147138-0.0942633im      0.168954-0.0330574im      0.332567-0.0715784im       0.095533+0.0445422im    -0.0817564-0.161139im      -0.0603791-0.00530026im  -8.78975e-5+0.130778im    -0.172592+0.0399021im     0.107335-0.00819291im
  0.0939908+0.134746im    -0.0688038+0.0440232im       0.09268-0.181812im     -0.0675433+0.0477241im     0.0303386-0.158936im       -0.176691+0.0427977im      0.0778213+0.124954im     -0.0971154-0.0124518im      0.279263+0.0846314im     -0.127053+0.109889im         0.22276+0.230944im    -0.211096+0.0172391im     -0.0438398+0.245432im     -0.167016+0.0935372im     0.106847+0.12814im       0.0487879-0.0173509im     -0.215663+0.0251879im      0.210154+0.0612795im         0.216+0.119261im       0.104411-0.0361707im       0.126463+0.0345793im   -0.114344+0.205123im     -0.0302122-0.266584im      -0.104891+0.152545im      0.0285797-0.0666616im      0.037364-0.00765593im    -0.0743213+0.162263im      0.0474366+0.0935133im       0.105007+0.0215158im    -0.0245185-0.11476im      0.058886+0.0842995im    0.0616824+0.0302093im
   0.128869+0.100978im     0.0138115+0.153766im     -0.0379406-0.0946499im     0.0978522-0.0716597im    -0.0225051+0.00757095im     -0.133272+0.0989362im      -0.305724-0.216568im       0.190002+0.189401im      -0.017806-0.0809187im     -0.196155-0.0334427im     -0.0396655+0.0492092im  -0.0728324-0.244633im       -0.126183+0.021598im     0.0683667-0.120387im    -0.0742939-0.165287im       0.210565-0.177582im      -0.132361+0.00640848im    0.0699243-0.163035im     -0.0404013-0.175634im      0.0110728+0.0536676im        0.15129-0.170405im   0.00683093+0.0311289im      -0.10723+0.0142836im    -0.0139667+0.0574938im    0.00901947-0.0514825im     0.0388442+0.119374im       -0.197805+0.0534151im     -0.142842+0.0269458im      -0.176157-0.125583im       0.250882+0.201167im   -0.0750681+0.0659466im     0.169189-0.0290632im
    0.10358+0.0593212im    0.0394434+0.0734039im      0.148354-0.124073im     -0.0518243+0.0268918im       0.12242+0.0840165im     -0.0139752+0.0656468im     -0.0770093-0.0137449im     0.0198063+0.144978im     -0.0303987-0.0777393im     0.0638569-0.0323696im      0.0353924-0.310885im   -0.0338243+0.0644035im      -0.172444+0.0291399im    0.0246422+0.0684287im   -0.0937764-0.0388542im      0.260561+0.122837im      -0.183127-0.0824526im     0.0496498+0.155204im     -0.0300062+0.14141im      -0.0975172+0.246126im       -0.141103-0.117838im    -0.005086-0.128774im      0.0865805-0.239236im       0.103383+0.0216724im    -0.0802403+0.194379im      0.0449397-0.2335im           0.11944+0.0351838im     0.0411887-0.0945377im      0.0672141-0.0735173im      0.169274-0.161956im     0.152638-0.329923im    -0.0365499-0.173531im
 -0.0201748+0.186027im      0.132637+0.137089im     0.00252934+0.0199098im    -0.0399591+0.11533im       0.0231967-0.265569im     -0.00331154-0.0453297im      -0.172765+0.0434774im      0.168907+0.027478im      0.0491272-0.222393im       0.175648+0.0500981im      0.0756813-0.246929im    0.0578486-0.0319878im       0.171048+0.174318im     0.0394551-0.10966im      0.0565384+0.000746339im   -0.294113+0.048944im      0.0976245-0.151054im       0.146979+0.157313im    0.000999939+0.159669im      -0.040516+0.266174im        0.149133+0.0786521im  -0.0849207-0.0734786im     -0.124875+0.142575im      -0.168698-0.153598im      0.0485923-0.0379793im      0.121512+0.148573im     -0.00812862+0.114446im      0.0712603-0.126927im        0.161265+0.0559245im      0.125534+0.0315266im   -0.160266+0.0601343im   0.00245708+0.0404597im
 -0.0648434-0.0200384im   -0.0605757+0.239462im      -0.184929-0.0694786im      0.190556+0.18925im       -0.181314+0.0109107im       0.145136-0.066919im        0.140959-0.0756629im      0.233856-0.183718im       0.171537+0.0115537im      0.029559+0.0817847im     -0.0297863-0.16099im    -0.0764993-0.000983359im   -0.0897805+0.0727667im    -0.204181+0.141345im    0.00253946+0.0620154im      0.277973+0.167245im      0.0283771-0.126272im       0.168059+0.0785381im     -0.299381-0.106365im      0.0346315-0.0259682im    -0.00595944-0.0565694im   0.0740602-0.0389988im       0.20325-0.0111388im     0.0919121-0.115664im       0.188085-0.0235887im   -0.00148435+0.0348773im      0.0215948+0.0221631im     0.0418725+0.260114im      -0.0118103+0.076463im     -0.0802209+0.018182im     -0.17906+0.122143im      0.010008-0.0439041im
   0.175335-0.0521181im     0.162118-0.019787im       -0.14414-0.0677736im      0.124977+0.01831im        0.101547+0.0775925im   -0.000836586-0.0729183im   -0.000885374-0.0634115im    0.00190744-0.133118im     -0.0342054+0.0214151im    -0.0108144-0.0899353im       0.305434-0.0185069im     0.12286+0.0918043im      -0.078994+0.0551432im     -0.23679-0.254043im    -0.0111415+0.0181357im     0.0269395+0.238835im       0.102694+0.256843im      -0.134224-0.0870637im    -0.0229225+0.296081im    -0.00749694-0.184871im        0.183383+0.0567387im  -0.0742041+0.0313104im     -0.054263-0.119908im       0.041374+0.0233462im    -0.0367667+0.131181im      0.0539138-0.0405528im     -0.0258749-0.288564im      0.0826389-0.0637922im     -0.0174733-0.0967269im      0.183694+0.0832368im   -0.259491+0.0411106im    0.0536201-0.111441im
 -0.0657913+0.153199im    -0.0498784-0.206517im      0.0773077+0.0156071im     -0.132962-0.173453im      -0.082026-0.00482199im     0.0725707+0.284232im       0.0494922-0.036217im        0.16406-0.0918958im     0.0215853-0.182602im      0.0396182+0.039348im       -0.219158+0.0769456im  -0.0746172-0.0399532im     -0.0379506+0.11049im     -0.0903216-0.0629645im    0.0650407-0.0592399im      0.262278+0.170034im       0.104666+0.0501115im      -0.12011-0.202894im     -0.0944558+0.0181459im     -0.202943+0.0826083im      -0.035203+0.250168im     0.103614+0.20498im       -0.140485-0.0916516im    -0.0733472-0.0245338im     0.0356391+0.15174im         0.10504+0.261768im       0.0527242-0.106647im     -0.0388084-0.0575011im       0.179727+0.154896im     -0.0366944-0.151081im    0.0623165-0.0231899im     0.163085+0.0241676im
  -0.162744+0.00202526im  -0.0539324+0.0363748im     -0.288736+0.199513im      -0.193894-0.0298167im     0.0200145-0.147039im      -0.0881106+0.266699im       -0.187757+0.0664812im     -0.151456+0.00168304im   -0.0478417-0.192013im      0.0877054-0.000244605im   -0.0406235+0.0406947im  -0.0393657-0.161499im       -0.149214+0.0195444im   -0.0383931+0.161476im      0.168176+0.0489423im    -0.0741181-0.0275307im     0.0547927+0.0386053im    -0.0085632+0.0394339im    -0.0723778-0.0605365im      0.138021-0.0974555im     0.00179761-0.0504444im      0.0549+0.162865im       0.309429-0.0394249im    -0.0492349-0.0862964im     -0.114088-0.0805812im     0.0214984-0.174956im      -0.0828384-0.14092im       0.0923373+0.000596289im      0.12679-0.264222im      0.0280912-0.0594286im    -0.24714-0.219952im      0.104181-0.000759538im
  -0.040974-0.118466im     0.0525546-0.0594196im     -0.162995-0.0870199im    -0.0989817-0.100464im       0.172544+0.0746854im      0.0435572-0.0713328im       0.374436-0.0427642im      0.127932+0.340736im     -0.0963911+0.0854744im     0.0210733+0.0269746im      -0.151138+0.11963im    -0.0737373+0.0781183im     -0.0597308+0.0660126im    0.0643456-0.0586593im     0.063495-0.144257im      0.0461787-0.0396097im      0.202002-0.0356317im     0.0673837-0.043783im      0.0779791+0.160557im      -0.016857-0.0634355im     -0.0307198-0.221481im    0.0422335+0.0273847im      0.127118-0.0324083im   -0.00810813+0.0462449im     0.0736745-0.234817im       0.140354-0.0441051im      0.0938306+0.218194im     -0.0806121-0.129109im         0.26219+0.13611im        0.156709+0.0640366im   -0.231855+0.0269852im    0.0271172-0.0838667im
   0.207838-0.0265509im   -0.0381255-0.216452im      0.0180356+0.00230137im   -0.0483138+0.169337im       0.112192-0.0165425im      -0.306038-0.0299675im    -0.00219438+0.0374053im     0.0564521+0.106868im     -0.0322876-0.0891306im      -0.04607-0.0524682im      0.0669937-0.0495767im   -0.101219+0.0164013im      -0.113151-0.0558844im    0.0639505-0.0288429im    -0.181351-0.15577im       0.0674281-0.0954102im    -0.0112825-0.199067im     0.00144999-0.118401im     -0.0219531-0.11486im        0.168277-0.0727444im       0.043627+0.162463im    0.0907549+0.0217006im     0.0498149+0.0706673im      0.144296-0.229461im     -0.0566621+0.178766im       0.141073-0.185603im      -0.0643583+0.00745151im     0.372538-0.0997396im      0.0468612+0.240316im      -0.209555-0.0353334im    -0.11256+0.211809im     0.0471013+0.0610717im
   0.194261+0.0210601im     0.173479+0.0975626im     0.0339005+0.210096im      0.0517203-0.221674im      0.0140281-0.248221im       -0.103489-0.00618802im      0.288216+0.102466im      -0.151032+0.0378757im      0.114983+0.0149334im     -0.288711+0.211797im       0.0197747+0.0354714im    0.204851+0.0306938im      0.0854221-0.0305033im   0.00393831-0.135439im   -0.00676144+0.127071im      0.0265866-0.0850193im    -0.0683214-0.10841im       0.0490079+0.0130178im     -0.268025-0.0861051im    -0.0531992+0.211365im      -0.0414316-0.094183im     0.226792-0.143753im     -0.0297138+0.00673406im   -0.0136694+0.131136im     -0.0181156+0.033341im      0.0656715-0.107781im     -0.00447817-0.240111im      -0.103445-0.0526651im      0.0379497+0.00743417im   -0.0505424-0.109478im    -0.142929+0.00444831im    0.152258+0.0536081im
 -0.0380571+0.00091919im    0.049882+0.234375im      -0.112605+0.157666im      -0.135866+0.185266im      0.0348014-0.081491im      -0.0759777-0.235614im       -0.120772-0.180004im     -0.0303064+0.164755im      0.0677265-0.200946im      -0.143702-0.0431883im      -0.157995+0.154367im   -0.0664381-0.0936798im       0.152841+0.0655059im   -0.0188902-0.126179im    -0.0654123+0.0453845im      0.135478+0.183836im      0.0478711+0.249016im     -0.0759594+0.0648277im     -0.163286+0.194895im      0.0912551-0.138222im       0.0295888+0.031211im     0.132016+0.0186317im     0.0386742+0.143844im       0.105729+0.17536im       0.0945173+0.106627im     -0.0960975-0.0912146im      0.0176025+0.199531im      -0.022301-0.161588im      0.00722552+0.0111483im    -0.0766046-0.189719im     0.204485+0.00992143im  -0.0993861+0.161955im
  -0.161978-0.131335im      0.112521+0.00599607im    0.0753704-0.118225im       0.134362+0.0187421im     0.0117714-0.107123im        0.128675-0.031289im       -0.110769-0.0156014im     -0.133924-0.0160327im    0.00485404-0.0158437im   -0.00972613-0.0810779im     -0.0665032-0.0194653im     0.02207-0.208721im        -0.01181+0.0413363im     0.110501-0.12386im      0.0345386-0.0105542im     0.0207213-0.0633097im      0.044264-0.107233im      0.0295014+0.337143im    -0.00243643+0.0272924im      0.119881-0.0988572im     -0.0733191+0.120723im    0.0914779+0.272344im      -0.180316+0.0149495im     0.0919986+0.072867im      -0.051712-0.0503589im    -0.0750521-0.186918im        0.268844-0.079787im    -0.00507081+0.0385139im      0.0140645+0.158615im     0.00219663+0.0710556im    0.066996+0.129856im      0.407339-0.330838im
   0.166801-0.0157795im     0.186772-0.0259512im     0.0361154-0.00347225im    0.0156813+0.0256119im     0.0749176+0.0268162im       0.288519-0.00460917im      0.176256-0.0435301im    -0.0902991-0.0634308im     0.0580914+0.121247im     -0.0218035-0.0311888im       0.064009-0.123724im    -0.205013-0.182821im       -0.143775+0.119582im      0.126951-0.0302806im   -0.0411061+0.137185im      0.0395036-0.0704901im    -0.0109267+0.115405im        0.03446-0.0857382im     0.0989976+0.0752752im    -0.0738496+0.176006im        0.136718+0.106653im     0.114413+0.113799im        0.19917+0.217677im       0.207786-0.306178im      -0.252672-0.0720419im     -0.161324+0.0501157im     0.00349874+0.0631832im     -0.105819-0.0357097im      0.0799721-0.206255im      0.0376311-0.0569575im   0.0938609+0.0951479im     0.111112+0.232779im
   0.078529+0.0457866im    0.0724506+0.0317028im     -0.027188+0.313719im      0.0283361-0.241428im      0.0538153-0.110142im        0.071822+0.117529im        0.136342-0.110308im      0.0615482-0.0212861im     0.0446474+0.030702im      0.0674853-0.0316344im       0.189024+0.0654936im    -0.28021-0.0355271im     -0.0221147-0.185493im     0.0552896+0.139804im     0.0220227+0.0443792im      0.101989+0.0585569im     0.0524944-0.0929179im    -0.0790181+0.0966955im      0.076829-0.0170529im      0.413227+0.0312401im      0.0554528+0.043815im    0.0469742+0.0220343im     -0.154925+0.0275153im    -0.0860718-0.0420198im      0.159518+0.251675im      -0.113318-0.0125688im       0.190236+0.030276im    -0.00459233+0.0185561im    -0.00283029+0.0932543im      0.257792+0.223601im    0.0206943-0.0727944im    -0.191767+0.0521121im
 -0.0813607-0.033018im    -0.0306717-0.0520584im    -0.0373445-0.171448im      -0.020761+0.059671im      0.0985002+0.142919im       0.0240435+0.0869997im     -0.0246967+0.102791im      -0.050891+0.118541im      -0.172587-0.130148im      0.0290735+0.0653081im      0.0312013+0.0282648im    0.152316-0.0242395im       0.128182+0.158054im     0.0925403+0.0258717im   0.00176748+0.492284im       0.186758-0.00574824im    0.0280492-0.189954im      0.0722094+0.0305282im     0.0218349-0.0298693im       0.15796-0.189347im       -0.154394+0.035046im    0.0870542-0.15295im    -0.000634608+0.0381071im     0.0555866+0.143783im       -0.22735+0.242945im       0.136733+0.235864im      -0.0189385+0.00984397im    -0.023728+0.0536375im      0.0811999-0.0955043im      0.162734+0.118764im   -0.0222237+0.175269im    -0.0407464+0.133857im
   0.229447+0.0289779im    -0.165611+0.0330509im     -0.273194+0.0203223im    -0.0770779+0.0251533im      0.125447+0.135588im      -0.0697089+0.00795444im     -0.155495-0.0321167im     -0.174999+0.0368199im    -0.0996912+0.00109264im   -0.0873034+0.239264im        0.014773-0.241364im    -0.269205-0.077353im      -0.0743505+0.0074912im     0.199955-0.0915657im    0.0334657+0.0232993im     -0.154952+0.197043im     -0.0704294-0.168274im     -0.0770092-0.0674137im     0.0898816+0.177417im     -0.0500754+0.0277522im      -0.179283+0.0150344im   0.0507751+0.0410479im    -0.0180358-0.0745088im   -0.00485615+0.0755917im       0.26355-0.105817im    -0.00536745+0.105221im        0.147336-0.212284im      -0.190331+0.119861im      -0.0060562-0.0025149im     -0.199189+0.0517776im  0.00347507+0.147946im    -0.0361272+0.019869im
  -0.219936-0.0231813im    -0.219936+0.162089im      0.0266661-0.00471757im    0.0319121-0.153874im      -0.200616+0.101757im      -0.0712328-0.109897im      -0.0771693+0.158925im    -0.00502854+0.000205587im  -0.0719097+0.147995im      0.0828329+0.0605513im       0.260956+0.0347904im    0.192865+0.0206291im     -0.0254225+0.0961528im    0.0149877-0.167614im     0.0282295-0.195765im       0.112531+0.0123992im    -0.0427454+0.129828im      0.0986978-0.103096im       0.155415+0.15305im        0.174903+0.166694im       -0.329209-0.0879429im    0.272088+0.0882799im     0.0341408+0.12275im       -0.081187-0.186871im       0.164893+0.113563im     -0.0328208-0.0305544im     -0.0272184+0.00781153im    0.0908154-0.0444644im      0.0388812-0.0528189im     0.0560352-0.0140584im   0.0345676+0.0569758im      0.15184+0.168511im
   0.144587-0.155953im      0.083671-0.0364634im    -0.0740947+0.0877097im     -0.250722-0.274721im      0.0241592-0.0769329im       0.276247-0.0229828im      -0.144772+0.0860624im      0.102928-0.0281437im     0.0684731-0.140358im      -0.264234-0.0873818im      0.0114731+0.0454157im    0.198228+0.0689088im     -0.0835493+0.0501224im   -0.0331917+0.0491039im    -0.103598-0.0690738im    -0.0468907+0.0746294im     0.0657741+0.0157471im      0.315394+0.00387196im     0.127721-0.0379521im     -0.120742-0.000120261im   -0.0699805+0.188334im   -0.0918676-0.0271385im      0.211132-0.0378551im     0.0464929+0.0711428im      0.158732+0.13313im        0.101078-0.0557693im      0.0669268+0.13798im       0.0777298+0.052091im      -0.0369447-0.125922im      -0.144977+0.319826im     0.114544+0.063537im     0.0309535-0.0337701im
  -0.139704+0.116996im     -0.138086+0.000979686im   -0.139826+0.12154im        -0.13712+0.015034im      -0.039572+0.00499023im      0.102636+0.16984im        0.0531268-0.10323im        0.119458-0.11503im      -0.0563258+0.151943im     -0.0598619-0.112332im       0.0283172-0.175102im    -0.064196-0.00438832im      0.169734-0.00116332im    0.132304-0.143467im     -0.168578+0.0631628im     -0.021941-0.102107im       0.183432+0.0730154im      0.268702+0.00610489im    0.0411916+0.130823im        0.16126+0.057978im        0.142701-0.261107im    -0.116374-0.0388439im     0.0414054-0.175585im       0.156222+0.159331im      -0.110225+0.00883106im    0.0226923+0.000507691im    -0.190431-0.244567im      0.0857271-0.0110793im     0.00234896+0.27435im      -0.0962601+0.0192697im    0.201043-0.0680507im     0.146361+0.105597im
   0.240466+0.027079im     0.0979075-0.0668663im     -0.219484-0.0222571im     -0.044481+0.212269im      -0.404019-0.0970149im     -0.0476808+0.0216995im      0.0430194-0.0104333im    -0.0185138+0.0435925im       0.18595+0.20148im       0.0388883+0.13767im       -0.0649163+0.0267273im    0.139684+0.00817267im   -0.00717744-0.0192441im     0.153482+0.0291612im   -0.0971752-0.0927307im     0.0567168-0.15884im        0.063221-0.0161773im    -0.0469425+0.234923im     -0.0141003+0.11346im       0.0111521-0.126247im       -0.163581+0.12796im    -0.0088609+0.205625im       0.115957-0.0677507im    -0.0512065-0.118715im     -0.0390592+0.0498989im      0.258214+0.134798im      -0.0742445-0.0927277im     -0.125767-0.193359im       -0.104377-0.00944478im     0.150913+0.0820535im     0.15264-0.0894832im    -0.141908-0.0385659im
  -0.123817-0.136755im     0.0275226-0.0383598im     0.0878946-0.0677288im      0.155486+0.0307169im      0.330489-0.167653im        0.049656+0.128446im       -0.116566-0.035359im     -0.0271283-0.0793809im     0.0223653+0.0671699im    -0.0351209+0.00930374im      0.114766-0.0755579im    0.158791+0.128511im        0.148942-0.0555244im    0.0610669+0.138737im     0.0259628-0.237706im      -0.028707+0.0532497im    -0.0587054-0.166948im      0.0847756-0.250946im      -0.170655+0.196877im       0.220064-0.0280334im      0.0657495+0.205519im     0.214225+0.145285im       0.198883-0.0387992im     0.0984535+0.0817029im   -0.00751372-0.0564159im     0.0241081+0.129696im       -0.176662+0.0946551im     -0.287133-0.00595517im    -0.0663003+0.0861861im     0.0130829-0.0525119im   0.0262094-0.116293im    -0.0874264-0.0514644im
  0.0497838-0.0224964im    -0.217971-0.0635725im    -0.0624443+0.0150556im     0.0661376+0.0260666im      0.046697+0.0467041im       0.169456-0.0951018im      0.0577271+0.0443961im      0.196632-0.119039im      0.0708039-0.241537im      -0.290793+0.0574769im    -0.00934121+0.0468142im  -0.0503419-0.115281im       0.0434116+0.0155476im    -0.111188+0.220026im      0.156671-0.142696im     -0.0535688+0.0900955im     -0.260634+0.0390045im    -0.0756339+0.164398im       0.191735+0.0908262im      0.086701-0.0745564im      -0.156252+0.0106im      0.0540215-0.254539im     -0.0280758+0.0529829im      0.048156-0.0662947im     -0.226785-0.154345im      0.0235391+0.0617085im     -0.0213599-0.127199im     -0.0175266-0.291803im        -0.12198+0.193001im      0.0886057+0.0358873im  -0.0676809-0.0997345im     0.140496+0.0885103im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.07779987800485332 - 0.1026173799943416im
  -0.11781444854224517 - 0.1272934134295426im
 -0.022127673031829928 + 0.2377327520547155im
   0.12683214940989626 - 0.04288804817365827im
   0.06669261143825678 + 0.052100895874235165im
   0.11326598696412116 - 0.1265870530298099im
   0.20489843456255996 - 0.08655335745876191im
    0.0465681856951449 + 0.10135147708108254im
   0.04630712505089229 - 0.12127317460581137im
  -0.00843172366867237 + 0.18155434247822985im
    0.1566145445404118 - 0.046409201868242385im
  -0.07787536884051505 + 0.17103206279529265im
   0.09363720553098667 + 0.014187609166028882im
   0.14645688751780347 - 0.005237912444190113im
    0.2216695151066931 + 0.09683637933836964im
  -0.05842144460847512 - 0.04508216092430889im
    -0.094495610345531 + 0.034188317736905345im
  -0.02505835861641824 + 0.001737385237327277im
   0.22678557658201426 - 0.12039778366451519im
  0.014757682635838112 - 0.1732745916464653im
  0.030926146044455843 - 0.2677485382023139im
  -0.08729763824367806 + 0.05845776703085982im
   0.10583497136347249 + 0.19723748304559796im
    0.3436518275579703 + 0.0im
  -0.24096095031354275 - 0.004731981307313754im
  0.005547839745077415 - 0.09018964473384203im
  -0.06998999352355627 - 0.0601046644203474im
    0.0288751501127793 - 0.06518500655177488im
 -0.024278609917684907 + 0.08411987021466985im
  0.059575430440201596 - 0.016973907532820683im
  -0.14074620260793053 + 0.23973901228720276im
 -0.020338732464321926 + 0.21529704652308124im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Monday 17 November 2025 03:07">Monday 17 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
