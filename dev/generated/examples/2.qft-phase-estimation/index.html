<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
  -0.0650626+0.272272im      0.141631-0.0602658im    -0.162172+0.0450587im   -0.0589709-0.0486948im    -0.0710608-0.179848im     -0.0873197+0.0105978im   -0.0822874-0.00755132im   0.0566636+0.0359336im     0.213621-0.0566526im   -0.0892806+0.158435im     0.0812016+0.0449116im    -0.176878+0.147685im        0.271017-0.180431im     -0.0338975+0.061891im     -0.00721799-0.0183982im     -0.095329+0.0693935im   -0.101755+0.131589im    -0.0836621-0.173358im      -0.08258-0.107969im     -0.226156+0.0989423im     0.127993+0.197986im      0.0941965-0.112812im    0.0833476+0.0595065im     0.210122+0.246365im      0.0372905-0.0792442im    0.0800498+0.22241im     -0.0364426+0.188842im    -0.0221735-0.0858284im      0.262857-0.0264618im  -0.00921983-0.0494861im    -0.0358968-0.122683im     0.0340026-0.059456im
  -0.0262116+0.0727653im   -0.0145047-0.0166776im    0.0421324+0.0287367im   -0.0860078-0.270487im       0.126905-0.277261im     -0.0873145-0.17318im     -0.0961805+0.0754978im    -0.165739-0.0877096im    -0.122837-0.16869im       0.215989-0.0542338im   -0.0461708-0.140594im     0.0570171+0.0654523im       0.114846-0.0203963im      0.040944+0.074431im        -0.21034+0.122342im      0.0656263+0.0158466im   0.0811836+0.0206863im    0.0609346-0.102999im       0.13072-0.0378053im   -0.0915971+0.136448im     -0.191478+0.0509355im     0.0628909+0.0543824im   -0.194012+0.068717im     -0.107966-0.0853855im     -0.116256-0.0453837im     0.113278+0.0537772im     0.136014-0.116321im       0.23118+0.231519im       0.213881+0.0382641im    -0.113687+0.124264im     -0.0918818+0.207623im     0.0288555+0.223206im
   0.0115346-0.166652im    -0.0646712+0.0817775im    -0.239815+0.118637im      0.337238-0.0820786im     -0.249035-0.190921im     -0.0283833+0.0420187im    -0.161537+0.0752191im     0.221083-0.0656051im   -0.0781593+0.0907294im  -0.00684102+0.0795365im   -0.0578916-0.0229159im    0.0647499+0.039385im       0.0344566+0.0605449im     -0.105816+0.21516im        -0.115019-0.254352im      0.0674031+0.0920356im    0.153129-0.0943345im   -0.0644177+0.175162im      0.111469-0.0559419im    -0.108782+0.00393619im    0.020288-0.121903im     -0.0570974+0.081356im    0.0316114+0.233706im     0.0360749+0.101874im     -0.0475043+0.0430005im   -0.0395726-0.135821im     0.0255076+0.014806im      0.131302-0.123046im       0.049085+0.0991524im    0.0202318-0.0694007im   -0.00294447+0.257515im      0.112763-0.242234im
   -0.221506+0.111425im     -0.222856-0.0507711im    0.0490261+0.13596im      -0.186757+0.242982im      0.0877003-0.172086im       0.264131+0.0303731im    0.0109291-0.0728406im    0.0826565+0.0441024im   -0.0362567-0.0785935im   -0.0155867-0.0243123im     0.131335+0.186679im     0.0515478-0.162586im        0.157321-0.0902173im      0.141176+0.0901129im     -0.0340162+0.0205029im      0.229798+0.243673im    0.0682267-0.0545568im   -0.0405446+0.0536289im   -0.0299193+0.227571im     -0.109332+0.0462194im    -0.118511-0.0432444im    0.00130191-0.237377im   0.00536396+0.0117339im   -0.0449866-0.201972im       0.109684-0.143376im     -0.113024+0.0173037im   -0.0516006+0.16381im      0.0915052-0.215781im     -0.0679432+0.143674im     0.0315571+0.0567098im     0.0864448+0.149936im    0.00912478+0.0358658im
  -0.0452682+0.219192im     -0.174919-0.207075im    -0.0104124-0.0962939im    0.0302097+0.00950389im    -0.111625-0.0451517im      0.105947+0.192469im     0.0869667-0.144716im     -0.159147-0.0544518im     0.041897-0.164936im    -0.0910722+0.0397187im    0.0327737-0.181863im      -0.23088-0.0794691im      -0.237257+0.117167im     -0.0846499+0.00809071im    -0.0961692+0.0230244im   -0.00525154+0.123824im     0.189406+0.109286im     0.0484242-0.115249im     -0.160862+0.0419114im     0.171827-0.178827im     -0.189584-0.0137389im      0.131656+0.214251im   -0.0838043+0.06894im     0.00977405+0.17823im       0.0814387-0.114071im    -0.0320164-0.0930354im      0.14081-0.0413236im    -0.112212-0.0663287im       0.18926-0.116483im      0.150478-0.0754218im      0.133958+0.19789im     -0.0878067-0.0742729im
   0.0630226-0.0474677im      -0.1534-0.135387im      0.170854+0.00506267im  -0.0760062-0.0538729im    -0.0320808-0.0639872im      0.120053+0.211396im    -0.0341235+0.0321354im    -0.120402+0.0178281im     0.171104-0.0168036im    -0.145466-0.00113269im   -0.220931-0.29489im       0.368174-0.0961844im       0.139499-0.0838712im     0.0561507-0.141575im       -0.163935-0.177518im     -0.0372967-0.26989im       0.13358+0.014179im     -0.209966-0.00502908im     0.10728+0.0504234im   -0.0106927-0.195481im     0.0969161+0.0401054im     -0.171856-0.076743im    0.0863336+0.0683846im    0.0299689+0.151859im      0.0452375+0.0188906im    -0.105935+0.145357im      0.107674+0.0801326im    0.0365945+0.0289791im     0.0320037+0.18328im      0.0304837+0.0326894im     0.0570162-0.0976259im   -0.0626708+0.117717im
   0.0682317+0.0116625im    -0.218643-0.0162893im     -0.15249+0.137864im     0.0464127+0.159278im       0.236456+0.142828im      0.0589869-0.0492856im    -0.153379-0.0720307im    -0.203716-0.0250291im    0.0345639+0.259256im    -0.0104798-0.127383im      0.199922-0.202263im     0.0529817-0.0216595im      -0.052361-0.137897im    -0.00243677-0.0934866im      -0.120307+0.135827im      -0.111581+0.0955218im   0.0379786-0.122582im     0.0375044+0.0941139im   0.00216533-0.0910898im    0.0339518+0.134313im     -0.117458-0.0733482im       0.22403-0.0195419im   -0.086357-0.0358905im     0.162237+0.188354im       -0.17083+0.316051im     -0.103539+0.0874648im     0.114855+0.101323im     0.0888673-0.19861im      -0.0101321-0.0181569im   -0.0902571-0.103826im      -0.143454-0.0610109im     0.116205+0.0216525im
   0.0217764-0.0179523im    0.0558507-0.0888901im    0.0217239-0.0861201im     0.309628-0.106098im    -0.00440034+0.0213619im     0.0623039-0.0196342im    0.0746859+0.105545im    -0.0726965+0.139012im     -0.229035+0.136889im     0.0358239-0.0838926im   -0.0774026-0.0191221im    -0.158473-0.0064453im       0.222868-0.296487im       0.093017-0.0656237im     -0.0389232-0.215184im     -0.0583454-0.0349426im   -0.032127+0.0989986im    0.0715928-0.0440989im   -0.0235908+0.190015im     0.0478922-0.0615746im   -0.0565242-0.00223938im    0.0337002-0.172827im    0.0635403-0.19124im      0.0848532+0.0488126im     0.0964065-0.0518205im   -0.0792072-0.204059im     -0.105592-0.258841im    -0.0409596-0.261186im       0.127624-0.0614727im  -0.00838211-0.0617129im     -0.209273+0.119632im    -0.0827192+0.266852im
   0.0360468-0.090334im     -0.036054-0.327345im      0.137765-0.13563im       0.123703-0.0835638im    -0.0811523+0.0999716im    -0.0548893+0.0347346im     0.188113+0.0466468im    -0.246379-0.0131105im   -0.0627757+0.0678813im   -0.0792694-0.147786im     0.0614099+0.201608im     -0.172591+0.114777im       0.0123472+0.167024im      -0.121819-0.128924im      -0.0339857-0.0609147im      0.208864-0.0197337im   -0.117222-0.0490765im    -0.113363+0.389945im     -0.130136+0.155485im     -0.153401+0.0395862im   -0.0690642+0.0785196im    -0.0304599-0.138247im    -0.083236+0.0673088im      0.11669+0.00429578im   -0.0186577+0.049527im      0.121288+0.241268im     0.0798393+0.017032im     0.0503722+0.0801453im      0.112528+0.0806602im   -0.0844105+0.117156im      0.0263725+0.0229831im     0.135976-0.127797im
 -0.00361158+0.0927404im   0.00972305+0.127355im      0.149528+0.0410081im    0.0495437-0.0756902im      0.047168+0.125369im       0.127455-0.0565801im   -0.0450126+0.0528616im    -0.138988-0.166587im    -0.0886593-0.0328305im    -0.245554-0.215942im      -0.17322-0.189911im     0.0145972-0.0967172im      -0.146521-0.00935221im   -0.0739275+0.139207im       0.0216025-0.168727im      0.0448364+0.227139im    -0.197488+0.308377im     0.0263243-0.0277397im    0.0947936+0.0230443im    -0.347712+0.15272im      0.0103557+0.167491im      0.0017633+0.0633377im   0.0499779-0.131388im     0.0718565+0.0421689im    -0.0800341-0.00368009im    0.020077-0.139661im    -0.0381909+0.102728im       0.11655+0.0141837im     -0.185982-0.078931im       0.25929+0.130308im      0.0490552-0.0331702im    0.0447846-0.047748im
 -0.00461988+0.0638365im    -0.073866+0.103976im    -0.0558058+0.0969225im   -0.0525342+0.0828968im     -0.110157-0.0644548im     -0.235103+0.0465214im   -0.0340282-0.00414211im   -0.216472-0.0383192im     0.222472+0.0119im        -0.08173+0.139584im     -0.142291+0.0749841im    -0.143708+0.0616881im      -0.238434-0.111985im        0.12932+0.272664im      -0.0588085-0.00495688im    0.0281922-0.230278im    -0.101454+0.0193251im    0.0295631+0.287786im    -0.0128449+0.0107978im    0.0164365-0.240138im     -0.194961+0.0551889im   -0.00120348-0.0794888im  -0.0924267-0.0207654im   -0.0619636+0.0261022im    -0.0843494-0.206801im     0.0460116-0.100632im     -0.101888+0.13483im       0.215648-0.0872106im      -0.16556-0.0385376im    -0.114256-0.0200386im     -0.237998-0.0708925im    -0.120713+0.116353im
   0.0775451-0.20979im       0.137448+0.223478im      0.102995-0.0151005im    0.0512861-0.0162644im      0.221865+0.0186457im     -0.170774+0.025064im      0.082453-0.11036im       0.011438+0.0512582im    -0.143098+0.0331394im    -0.218205+0.00626841im    0.186806-0.0810172im  -0.00463236-0.108331im        0.105985-0.0146784im     0.0484397-0.144054im      -0.0766641+0.0472801im      -0.18844+0.0240632im    0.051161-0.0333594im    -0.163399+0.145057im    -0.0529151-0.183489im    -0.0357301-0.0019387im   -0.0382735+0.0377356im     0.0466221-0.136348im   -0.0315958+0.042235im      0.122893+0.0184713im     0.0401436-0.346448im      0.127342-0.240547im      0.158846+0.246302im     0.0283205+0.0576696im      0.029676-0.0814982im    -0.115301-0.045715im       0.268198+0.183188im     -0.135692+0.0383339im
   -0.258319+0.0644205im    -0.191354+0.0901216im   -0.0481499-0.288835im    -0.0617496-0.0635404im    -0.0245367+0.0160666im     0.0111076+0.0377484im    0.0681784-0.0875298im    -0.176237-0.0756999im  -0.00825197+0.113329im   -0.00209196+0.0559895im   -0.0256311-0.0690123im    0.0167788+0.0110141im      -0.173322-0.0230867im      0.152675+0.018214im        0.366039-0.059565im     -0.0244544+0.114605im     0.040419-0.0976931im    -0.172776-0.0081925im     0.118456-0.13123im     -0.0615355+0.0472533im     0.184127+0.104928im      0.0397877-0.119287im     0.216822-0.116328im    -0.0351603-0.0580021im     -0.147481+0.0435635im   -0.0769654-0.0467864im    0.0110368-0.0321342im   -0.0459603+0.0995921im      0.190584+0.150275im     -0.242083+0.00750792im    -0.165921+0.239232im     -0.198914-0.144391im
   -0.118227-0.141748im     -0.139697+0.0520756im   -0.0978652+0.0301027im    -0.135866+0.032309im      0.0111196+0.0365299im     -0.254571+0.0419391im   -0.0818934+0.0743324im    0.0429461-0.117589im     -0.037359-0.0787367im     0.108465+0.193692im     0.0324204-0.118403im    -0.0271702-0.0424739im     -0.0333959+0.255178im      -0.107085-0.389539im       -0.187912+0.147139im       0.321998-0.0186075im   -0.189603+0.19428im     -0.0872223-0.0600858im     0.131279+0.103093im     -0.043892-0.063142im      0.112376-0.0187014im     0.0462994-0.015964im     0.181922-0.197614im     0.0513298+0.0642908im     0.0996331-0.0827552im   -0.0676795-0.170631im    -0.0341476-0.0106628im    0.0815505-0.163241im      0.0879226-0.04192im     -0.0814778-0.0271281im     -0.103714-0.00430274im    0.164818-0.00639836im
   -0.166487+0.00840429im    0.197583-0.0229988im     0.163943+0.0182273im    -0.147636+0.30073im       -0.191892+0.0525957im    -0.0172468-0.171719im    -0.0812043-0.00863955im   0.0164955+0.0166231im    0.0295901+0.196719im     -0.198424-0.176715im    -0.0279614-0.154935im    -0.0865089+0.188465im     -0.00637449+0.0204139im     -0.031244-0.0138102im      -0.188013-0.0383496im    -0.0175352-0.0953761im    0.157635-0.087059im      0.249699-0.0966572im   -0.0967882+0.0492875im    -0.220641-0.185211im        0.2288-0.132988im      0.0837018-0.0336631im    0.102974-0.0520806im   -0.0661242-0.185492im      0.0832265-0.00759534im   0.0141765+0.0594231im     0.175681+0.0056365im     0.104951+0.116039im      0.0338691-0.117405im    -0.0444769-0.14329im       -0.107952+0.203011im      0.062143-0.0369017im
   0.0668494-0.119688im     0.0677539-0.171184im    -0.0153928+0.15733im      0.0202297+0.0975914im      -0.12106-0.000775361im  0.00358018-0.216899im      0.312665-0.11303im     -0.0338168+0.0265366im    0.0630355-0.0540315im    0.0123283+0.0758185im     0.085136+0.114381im    0.00612916-0.254995im       0.0273934+0.0219442im     -0.231293-0.00562635im     0.0465933-0.0609486im       0.10883+0.0344005im   0.0657834-0.03914im       0.065013-0.218512im      0.208544-0.0567618im   -0.0803858-0.0119676im   -0.0394643+0.226615im      -0.218776-0.0226856im  -0.0375606+0.0783656im    0.0685997+0.0929967im   -0.00801965+0.161105im     -0.193422-0.0533943im       0.1301+0.0553601im      0.16596-0.000118862im  -0.0718192-0.27763im      -0.214067+0.0233614im     -0.113435+0.0227595im    -0.277136+0.0217842im
   -0.127506+0.0656434im    -0.020422-0.0211137im    -0.059791-0.242451im      0.198775+0.0899921im     -0.032019-0.239797im       0.191978-0.130527im      0.121187+0.212915im      0.149203-0.0743891im   -0.0693865+0.101875im      0.110807+0.0263064im    0.0844296-0.134394im     0.0740227+0.051936im      -0.0692937+0.073908im       0.118361-0.0216176im      -0.207423+0.189359im     -0.0545098-0.0628262im    0.150828+0.127368im    -0.0345286+0.110895im     -0.201655-0.00146086im  -0.0296526-0.0509611im     0.122889+0.250864im      0.0177578+0.136798im   -0.0499199-0.143681im     0.0641088+0.0530679im      0.128529+0.154677im      0.135157+0.0121796im    -0.204506+0.107315im      0.104766-0.0286233im     -0.207295-0.027806im     -0.195693+0.144828im       0.102482-0.0491029im    -0.180143-0.0138184im
   -0.113723+0.146589im      0.162559+0.00728839im  -0.0687726+0.113585im    -0.0111446+0.0418496im      0.103849+0.0868749im    -0.0127023+0.0643658im    0.0308408+0.0994137im     0.103408-0.110569im      0.125521+0.0508742im    -0.118892+0.0202502im    0.0514513+0.121631im      0.140077-0.0100413im      0.0262788+0.0816884im     -0.122437+0.130328im      0.00410549+0.00479999im    -0.022151+0.0600289im    0.173023-0.0585075im    -0.108847+0.295867im      0.181281+0.187201im      0.162782+0.0838603im    0.0167134+0.363528im       0.136661+0.0605302im    0.206274-0.107255im     -0.163022+0.169951im       0.105412-0.00363032im   0.0868192+0.00293774im    0.214872-0.153932im     -0.142947+0.0739265im    -0.0466617-0.0985484im    0.0253452-0.0347996im    -0.0705233+0.131934im      0.152083+0.278431im
  -0.0398272-0.123953im     0.0481953-0.0402672im     0.127742+0.0227548im     0.116965-0.105478im      -0.203053+0.012099im      0.0931438+0.0893547im   -0.0682251-0.112925im     0.0701827+0.240447im     0.0767047+0.184572im      0.182625-0.00463965im  -0.0412873-0.129886im    -0.0493422-0.17006im        -0.008496+0.198228im       0.204147+0.104684im       0.0786233-0.0237332im     -0.161926+0.0956631im  -0.0752911+0.123815im    -0.0454551-0.0196361im     0.233075+0.187939im      0.205524+0.123624im      0.011575+0.00857492im     0.126977+0.0247073im  -0.0947148-0.187266im    -0.0669777-0.0573787im     0.0288957-0.195408im     0.0181756+0.274424im     0.0838543+0.170784im      0.242576-0.020377im      0.0681905-0.209436im     -0.112836-0.0506748im       0.01967-0.0744497im     0.107672-0.10526im
   -0.142961-0.128083im     -0.185438+0.0361484im     0.138836-0.0140703im    0.0400863+0.143685im      -0.142603-0.0816826im     -0.147453-0.152363im     0.0285754-0.0514245im    0.0313021+0.133947im      0.185272-0.293665im      0.120021-0.263988im     -0.114359+0.0413684im    0.0262137+0.076818im       0.0238584-0.0249048im     -0.208581+0.000941059im    -0.233286-0.19124im       -0.130853+0.0208042im  -0.0624119-0.0635307im    0.0436371+0.0171205im    -0.095614+0.0777934im      0.19368+0.248927im     0.0841893+0.132732im       0.224576-0.0986628im  -0.0230315-0.113284im    -0.0528553+0.100971im      -0.196192-0.0213679im     -0.11955-0.19653im     -0.0731929+0.0679602im    -0.132778+0.0910073im    0.00770961+0.133273im    -0.0888214-0.0485116im      0.103513-0.0675645im   -0.0475683-0.0521718im
   0.0731453+0.00437218im   0.0609316-0.0310674im    -0.200199-0.0939462im   0.00416386+0.049544im       0.051471+0.0140083im     0.0449733+0.20185im      0.0735605+0.00585148im    0.152097-0.023725im     0.0836048-0.0130163im    0.0817458-0.363021im    -0.0194783-0.172226im     -0.106875-0.0942205im      -0.173379+0.2097im        0.0239467+0.0295623im      -0.107223+0.0908788im     0.0668662-0.0109632im   0.0855911-0.0739382im     0.130906-0.00731437im  -0.0136785-0.133692im    -0.0393423+0.302295im    -0.0383771-0.00635153im    -0.237119-0.259641im      0.18246+0.123404im     0.0924684+0.108503im      0.0313984-0.279907im    0.00587248+0.127908im     -0.150836-0.13195im      0.0729732+0.0581881im    -0.0451522+0.0647766im    0.0294303-0.177491im      -0.153147-0.0360935im    -0.102538+0.120754im
   -0.291575-0.0803745im   0.00284049-0.111706im     -0.168972-0.0845591im   -0.0422131+0.117992im     -0.0263024+0.243348im      -0.181074-0.120082im     0.0357106+0.224952im    -0.0274639+0.244066im      -0.16373-0.185926im   -0.00348775+0.0939342im    -0.114326-0.253949im     0.0441966+0.0168159im       0.087535-0.117237im        0.16649+0.0438206im       0.204165-0.103294im       0.166264+0.0489411im    0.151645-0.0809537im      0.18416+0.0715354im   0.00327813-0.0550967im     0.032424+0.0485782im    -0.216346-0.010662im     -0.0939922+0.133845im   -0.0104897-0.00310416im    0.152033+0.15729im       0.0961675-0.0754464im   -0.0371282+0.0625599im   -0.0257057+0.215453im    -0.0991676+0.147457im     -0.0670205-0.0342004im   -0.0348306+0.0404462im     0.0424739-0.0319569im     0.185172+0.0258705im
   -0.297627-0.0764294im     0.101713+0.0646815im     0.023802+0.070066im      0.115894+0.0423572im     0.0299584+0.00244395im    0.0340747-0.0364633im    -0.148878+0.102365im     -0.194625+0.106648im      0.138301+0.10127im      0.0926101-0.153037im      0.141624+0.248858im       0.15792+0.00913117im     -0.230019-0.0565953im    -0.0810614+0.00379945im      0.134059+0.00460077im     0.174291-0.0321859im    0.092262+0.0712275im   -0.0380869-0.184508im     0.0880283+0.116083im     0.0322272-0.0992382im     0.122692-0.0974586im    -0.0257586+0.123576im   -0.0602717+0.0593269im     0.352564+0.116454im      -0.117289-0.136926im      0.237566-0.019063im    9.53194e-5-0.113677im      0.118523-0.0251805im     0.0701186+0.120804im     0.0121769-0.110355im       0.226543-0.0446036im   -0.0914462+0.165682im
   0.0949139+0.0506005im     0.037192-0.10809im        0.16107-0.0601683im    -0.112584+0.135513im      0.0181316-0.0680455im      0.143916-0.154469im      0.185446-0.0905515im     0.238559+0.132824im    -0.0405384+0.238816im     0.0102421+0.0555504im    -0.148288-0.0309961im     0.138038+0.0727759im      -0.035648+0.0943475im    -0.0106713+0.18652im        -0.015821+0.0996475im      0.156832-0.0311581im    -0.30708+0.160626im    0.00420964+0.073924im     0.0664659-0.0798492im    0.0525568+0.00485566im  -0.0352664-0.26607im        0.194566+0.0623614im    0.105713+0.172091im      0.146817+0.26461im       -0.122611-0.0824368im   -0.0100597-0.0690502im    0.0557994+0.0585732im    -0.179261+0.0344626im     0.0790818+0.0608124im    -0.079896+0.20577im      -0.0943938+0.118972im    -0.0516796+0.147693im
   -0.171751-0.00785197im  -0.0619579-0.00439169im   0.0719158+0.217414im      0.192839-0.0694601im     0.0151155+0.253153im       0.218047-0.0712549im     0.093138+0.122272im    -0.0171585+0.171258im      0.118094+0.0860907im     0.132549+0.221968im     0.0256131-0.0755175im    -0.222294+0.000874508im  -0.00876005-0.0182051im    -0.0730341+0.0120386im     -0.0695831+0.174093im      0.0298465-0.0409187im   0.0533778+0.00442323im   -0.165785-0.0817738im    -0.129719-0.114633im     0.0931623-0.0248038im     0.070945-0.00652982im   -0.0621875-0.279286im    0.0912864+0.0808423im     -0.20051+0.0578604im    -0.0937664+0.0850477im    0.0728089-0.17487im     -0.0660874+0.147032im      0.162979+0.270407im      0.0540022+0.0508161im     0.292633+0.0756495im    -0.0483613+0.0592319im    0.0960195+0.0566371im
    0.101954-0.168742im      0.148368+0.153201im      0.187808-0.121683im     0.0287479+0.0648809im       0.14877+0.111469im      0.0510926+0.0175471im     0.086718+0.0413783im     0.124001-0.165992im      0.115979-0.153324im    -0.0632615+0.160063im     0.0302037-0.0935764im   -0.0044828+0.150519im      -0.0921341-0.0945509im     -0.107003-0.0775003im      0.0684702-0.0890477im     0.0915843-0.0156778im    0.202613-0.185089im     0.0678828+0.0219131im    0.0498237+0.106301im     0.0985825+0.0508282im    0.0163116+0.0405155im      0.253482+0.0603598im    7.435e-5+0.0873313im     0.082641-0.0416941im     -0.100402-0.100177im     -0.137577+0.217048im     -0.288291+0.0267816im     0.239651-0.1688im          0.20955-0.0802209im     0.159775+0.273533im     -0.0876112+0.0478825im   -0.0823086+0.00234619im
   -0.121499-0.0112606im    -0.051231+0.0613412im    0.0766573+0.164974im    -0.0486581-0.0803864im     -0.217127-0.230272im      0.0723494+0.00070119im    0.167095-0.0586069im    0.0278912+0.0153899im    -0.180504-0.0530913im     -0.15466+0.0966925im    0.0943374+0.049967im    -0.0398223+0.346323im        -0.14243+0.0650482im     -0.065791-0.177652im       0.0594386-0.0713751im     -0.168587+0.0217798im   0.0981229-0.0322719im    0.0272059-0.0253744im      0.20375-0.182748im     0.0438496+0.071434im     -0.272197-0.181414im      0.0623907-0.169297im     0.130895-0.264184im     0.0897958+0.121079im       0.129991+0.0426615im    0.0571769+0.0896595im    0.0944675-0.09987im       0.132331+0.0111249im      -0.17461+0.122052im     0.0964202+0.082498im      0.0307822-0.148219im    -0.0219536+0.0697538im
  -0.0684251-0.0215209im    0.0829846+0.145042im      0.175557-0.159496im    -0.0704436+0.107346im       -0.03488-0.0562712im     0.0606536+0.301434im    -0.0294552-0.161837im    0.00688999-0.16652im       0.113154+0.101254im      0.097858+0.0239794im   -0.0990366+0.0144033im    -0.228858+0.0596883im       0.100007+0.00347246im      0.14085+0.00436357im    -0.0737626-0.0446037im     0.0777138-0.0273659im   0.0177836-0.259748im    -0.0529848-0.110091im      0.186199+0.169824im    -0.0540755+0.17855im     -0.0985602-0.0357425im    -0.0945117+0.0473379im   -0.175528+0.0304621im     0.196977+0.103173im       0.167657+0.289107im      0.168445-0.317218im    -0.0473869+0.133703im    -0.0802844+0.148438im       0.013917-0.0789805im   -0.0192457+0.0329626im    -0.0473062-0.0525842im    0.0780815+0.067212im
  -0.0634575+0.132976im     -0.129576+0.207171im     0.0684252-0.108282im    -0.0919914+0.0267426im    -0.0225558-0.112249im      -0.118718-0.12255im       0.108591+0.291712im     -0.197656-0.0767292im    0.0470448+0.153321im     0.0353811+0.0956686im     0.181258+0.0163663im   -0.0232399-0.0539018im       0.178795+0.176405im      0.0496508-0.0452207im      -0.117153-0.137236im      -0.243166+0.113272im   -0.0802219-0.0711301im    -0.068797-0.088889im    -0.0553401+0.192806im      0.160023+0.0235443im    0.0120714-0.121495im      -0.174947+0.0404898im   0.0663352+0.18446im       0.188622+0.0411451im     -0.167323-0.156082im     -0.115182+0.112765im       0.02602-0.0807137im    -0.052691+0.0719157im     -0.253655-0.153636im      0.161674+0.0833527im     -0.149097+0.0877585im     0.025316-0.0752472im
   -0.102351-0.0638242im     0.154867+0.307481im     -0.176642-0.062368im    -0.0555443-0.088117im     -0.0532115+0.110972im       0.236568-0.0596818im     0.281068-0.217267im    -0.0659796-0.10803im      0.0203263-0.149136im    -0.0113815+0.0578617im    0.0562477-0.0959387im    0.0729119-0.0621527im     -0.0461544-0.107984im      0.0276161+0.0591447im      -0.042261-0.147973im      0.0634966-0.201302im   -0.0131411+0.159529im    -0.0787307-0.118503im     -0.230065+0.130057im    0.00890207+0.0695334im   -0.0307113-0.0742845im     0.0818939-0.126182im   -0.0572784+0.151837im     -0.065591+0.0946686im   0.000806224-0.00193744im   0.0682961+0.050869im      0.111168-0.17937im      0.0411007-0.0736899im      -0.12841+0.0252626im    -0.287716-0.0130822im     0.0075022-0.010234im      0.341173-0.0724852im
   -0.148299+0.203797im    -0.0882549-0.0192232im     0.179617+0.135684im      0.103637+0.104739im     0.00151377+0.0719242im    -0.0623093-0.0194279im    0.0401249-0.100106im    -0.0452436-0.203084im     -0.096196+0.0102752im    0.0464592+0.142046im     -0.183161-0.024055im    0.00190311+0.0383394im       0.020157+0.0224857im     -0.050501-0.206606im       0.0789819-0.0836969im     -0.162205+0.111693im   0.00112185+0.255479im      0.132562+0.186946im      0.113381-0.0503113im    0.0869461+0.0960614im    0.0780439-0.0519849im    -0.0110854-0.0381909im   0.0147033+0.428659im    -0.0173935-0.120027im      0.0882907+0.0884102im     0.042467+0.0720217im    -0.265479+0.00170009im   0.0538403+0.016249im      0.0116435-0.0591111im    -0.192983-0.269961im       0.141252-0.00328879im   0.0111447+0.192362im
    0.109638+0.169542im     0.0396026-0.0679971im    0.0349522-0.153142im     -0.203555-0.214095im      -0.149823+0.0856267im     0.0534714+0.0082016im     -0.30852+0.123168im      0.168896+0.017535im    -0.0807211-0.0177326im   -0.0153369+0.113314im     0.0828635-0.0218503im    -0.107725-0.242727im       -0.048004-0.0741142im     -0.288767-0.0828821im       0.136001-0.0253905im    -0.0404334-0.231218im   -0.0757939-0.04807im       0.117498-0.00977449im  -0.0367785+0.166092im     0.0845165+0.0921391im   -0.0703427+0.0100479im      0.117924-0.0946752im  0.00732727-0.0213283im     0.133886+0.0473205im    -0.0342171+0.0946341im    0.0392941+0.0131502im   -0.0187237+0.159763im      0.134267+0.0624393im     -0.251367+0.190142im    -0.0882663-0.107508im      0.0568927+0.303933im      -0.08531+0.0529133im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
 -0.028480367737750027 + 0.06587296053559852im
   0.03076697416843033 + 0.18669372007582677im
   -0.1305713138442019 + 0.14984049124493506im
  -0.05372207150265932 + 0.17142219726935432im
 -0.015364141996367292 + 0.17621442373703264im
   0.19773846676253623 + 0.035465582603854386im
   0.03518361294889115 - 0.26041362645543803im
  0.000651476359449274 + 0.15419157201852246im
  -0.08127271605846297 + 0.1314821995307743im
  -0.20127666051612214 + 0.06678963996845796im
 -0.031694520416183175 - 0.19982180142910097im
 -0.014082345767620859 - 0.19112735653470972im
   0.10958638968385725 + 0.08304709935485713im
   0.07410305122317361 - 0.12621437908322655im
   0.03080548453125538 + 0.1276143494239484im
   0.25076456912530704 + 0.047619604983202335im
   0.09579775858832115 - 0.09050056029810666im
   0.14059719912866253 + 0.1581439764213391im
 -0.024192280981977725 - 0.2215463661507987im
 -0.040580520730085876 - 0.042630843920896534im
  -0.08389039935417127 - 0.07423051595986216im
  0.020420204583176005 + 0.05449782785436781im
   0.15989698254086093 - 0.05106184135976841im
   -0.1335407604231901 - 0.0010830505610334995im
 -0.029227048240297027 - 0.06810173762308788im
  -0.14426929453481105 - 0.004639121617261745im
   0.31904287684957616 + 0.0im
  -0.12197954173579431 - 0.07307714166707764im
    0.1104750727448665 + 0.010316337064671527im
   0.17136432404294513 + 0.04588290893903883im
   0.03454968739192982 - 0.26665133394923274im
  -0.07243360667067243 + 0.08173912039959592im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Monday 16 June 2025 00:17">Monday 16 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
