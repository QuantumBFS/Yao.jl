<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    -0.020193+0.302699im     0.0948721-0.138678im      -0.17447+0.102443im      -0.0542841-0.0873441im     0.0869922+0.132339im       0.16583+0.0143445im      0.139902+0.0870967im   -0.0224574+0.0540926im     -0.158143+0.0280912im    -0.142911+0.194023im     -0.0635663+0.0385491im    -0.0945102+0.056293im        -0.21597+0.009238im     -0.12017-0.0841649im    -0.0685812+0.174653im    -0.0747283+0.00650579im     -0.213177+0.18im            0.196775+0.0157467im     0.0408006-0.149749im    -0.0528288+0.0017998im   -0.0586974-0.0809111im      -0.113681+0.00323382im     0.100068+0.216254im     -0.0703037+0.0541991im     -0.297578+0.195176im    -0.0192577+0.189926im     -0.0349605-0.0187164im    0.0473167+0.245122im       0.0834483+0.176004im     0.00541067-0.0720626im    -0.0166635+0.116307im      -0.0795969-0.112672im
     0.218615+0.0273578im    0.0803166-0.239464im    -0.0626781+0.190912im          0.1956+0.0250929im     0.0144811+0.194977im      0.153746-0.0987665im     -0.214902+0.124426im     -0.137788-0.141184im      0.0256088-0.062445im    -0.0889776+0.00816936im     -0.10214-0.148771im       0.132581+0.0772415im      0.0294847+0.134356im     0.123208-0.35843im       0.0739933-0.0351017im     0.130384-0.0342792im    -0.00612047+0.0140046im      -0.105944-0.040446im    -0.00165031+0.0938014im    0.0289522-0.0883776im   0.00624166-0.0489853im     -0.0999437-0.305054im     -0.0247346-0.0196474im     0.0808454-0.0890818im     0.0124223-0.022934im     -0.105688-0.00550288im     0.194004+0.0531443im     0.146368-0.247434im       0.0804998+0.0122223im      0.103234+0.0529309im      0.187363+0.162623im       0.0687202-0.0851166im
    0.0702091+0.0128012im    -0.106288+0.053465im    -0.0270844-0.00801998im    -0.0245404-0.0117495im     0.0268376-0.145887im    -0.0273918+0.0309711im     -0.131134-0.176481im     -0.197482-0.0908457im     -0.143639-0.039962im     -0.384649+0.0105566im     0.0902543-0.00634987im    -0.154288-0.00695312im      0.175432-0.0323099im   -0.137023-0.00401716im     0.118757+0.128082im     0.0597353-0.0970625im     -0.0726569+0.0134754im       0.061117-0.131012im      0.0190417+0.124298im      0.161027-0.100073im       0.28431+0.219208im        0.050506+0.0218122im     0.0517724+0.0614527im     -0.170987+0.129883im       0.162797-0.106462im    -0.0356792+0.337349im      -0.218576-0.132053im      0.151197-0.033652im       -0.168301-0.0178144im     0.0722908+0.0589839im      0.115108+0.0892079im    -0.00312431+0.0136007im
 -0.000457165+0.135429im    -0.0617187-0.0995649im    0.0249492+0.152338im       0.0130096+0.0474756im     -0.193465+0.159213im    -0.0983874-0.0474013im     0.0621852+0.0451975im   -0.0131019+0.284731im      -0.157409-0.0894233im    0.0931704-0.150447im      0.0024339+0.190829im      -0.117016-0.134352im        0.289198+0.0203733im   0.0732153+0.0983872im     -0.012774-0.0195267im     0.130614-0.151078im      -0.0121821+0.20422im        0.0259378-0.156208im      -0.210377+0.0432717im     0.118029+0.137152im    -0.0218373-0.00412853im    -0.0196333-0.201924im     -0.0303631+0.180831im       0.209045-0.164245im    -0.00317343-0.0579273im     0.178078+0.00571251im   -0.0376987-0.0786698im     -0.07396+0.123538im      -0.0978868+0.211534im      0.0811261+0.0732685im     0.0593257-0.0744207im       0.216829+0.174637im
    0.0493393-0.193018im     -0.186491+0.152045im      0.118258+0.0672696im     -0.0387613+0.0389978im     -0.134278+0.0541045im     0.314513-0.0773408im    -0.0352762-0.0236652im   -0.0748663-0.0675611im     -0.281615-0.0531132im   -0.0872935+0.0482919im    -0.0475173+0.196466im        0.11335+0.00782775im     -0.151129+0.0284654im   0.0470785-0.0863978im     -0.104341-0.0316319im    0.0316286+0.130468im      -0.0436043-0.0786247im     -0.0935686-0.0668264im      0.156952+0.0186616im    0.0968737-0.0642839im   -0.0256259-0.00600169im   -0.00108248-0.0820403im    -0.0715954+0.0257404im    0.00568067+0.12037im        0.119856+0.251718im    -0.0579204-0.265641im     0.00215139-0.0379393im     0.124898+0.201955im       -0.227688+0.118884im       0.241743-0.0932885im    -0.0941792-0.244719im       -0.113077+0.149282im
    0.0365833+0.0308661im   0.00977378-0.0807387im    -0.298019-0.025602im        0.059832+0.102603im     -0.0495327-0.13697im      -0.338854+0.128608im         0.1122-0.243917im    -0.0315668+0.0598214im    -0.0107918-0.134244im    -0.0408838+0.0360559im     0.0236548+0.0771163im    -0.0190338+0.109675im       0.0837061-0.0290823im  -0.0257587-0.070537im     0.00236602-0.156824im     0.0719719+0.0646023im     -0.0956246-0.0611937im      0.0599416-0.0476223im    -0.0624219-0.0828367im    -0.125675-0.184223im    -0.0669658+0.134767im       -0.216687-0.0643825im      0.043008-0.0425503im     -0.102773+0.0469274im     0.0511191+0.215646im     -0.055669-0.0498021im      0.165064+0.325293im    -0.0394967-0.0706108im      -0.152442+0.0700386im     0.0102128-0.364118im      0.0597176-0.12421im          0.16458+0.0143223im
     0.147441+0.100395im      0.249459+0.0860079im   -0.0685001+0.186736im        0.105619+0.0933305im      0.200109+0.0908004im    0.0682956-0.100484im      -0.156557-0.0205193im    -0.126729-0.0977528im     0.0104575+0.0462071im    -0.150588+0.110791im      0.0213668+0.27786im      -0.0384962-0.0512124im       0.137952-0.103643im     0.171967-0.0455698im     -0.022295-0.0233413im    0.0563544-0.000720667im     0.127663-0.209693im        0.147945+0.00522618im   0.00218137-0.193393im     -0.141662+0.187139im     0.0910981-0.0821273im      0.0461715+0.103421im     -0.0461839+0.0338683im     -0.161456-0.11099im         0.20539+0.0718313im    0.0599274-0.171712im      -0.246808+0.0282803im    -0.344354+0.0520058im       0.111716-0.0191365im    -0.0703487-0.0492376im      0.101266+0.000956103im    -0.013483+0.0513112im
    -0.176591+0.0399254im    -0.087222-0.0758176im     0.202432+0.171697im       -0.124701-0.0838491im    0.00589291+0.128693im     -0.189295-0.179313im      -0.107266-0.0617049im  -0.00661894-0.0950658im    -0.0600553-0.236385im      0.298115-0.0217109im      0.146758-0.00928616im    -0.057858+0.0856548im      -0.219124-0.149018im     0.132889+0.187022im       0.230915+0.151135im      0.102825-0.0175727im      0.0151345-0.0718333im      0.0389131+0.0852709im      0.196181+0.0691439im   -0.0801542-0.160981im     0.0950315-0.0657451im     -0.0769769-0.0827172im     0.0369786+0.222062im    -0.00859913+0.0252892im      0.171415+0.15443im     -0.0173847+0.00112275im    0.0380342+0.00255843im   -0.149903+0.0212577im      -0.165711-0.0427267im    -0.0297959+0.00234362im    0.0813588+0.230724im       0.0084927-0.159681im
    -0.123766-0.0528893im     0.134079-0.036615im     0.0486103+0.0259176im     -0.0756952+0.0265724im    -0.0294037-0.0837832im    0.0278475-0.00870273im    0.0728456+0.0709209im    0.0932662+0.234856im     -0.0344881-0.261048im    -0.0508444-0.0308134im     0.0812361+0.123867im       0.144011-0.111756im       -0.129873-0.0884523im   0.0886838-0.140555im        0.03657-0.203758im     0.0155127+0.145279im        0.146242+0.170407im       -0.229759-0.213747im      -0.144987-0.154457im     -0.333235-0.225458im      0.145983+0.166253im        0.129174+0.0304753im    -0.0821857+0.0534177im    -0.0289518+0.023004im     -0.0566928+0.0446607im    -0.185942+0.0423747im     -0.225853-0.12044im      0.0929814+0.0255452im       0.164101-0.0906631im     0.0407362+0.0940356im      0.106156+0.0085882im      0.0621031-0.123183im
    -0.248752-0.0960499im   -0.0437453-0.0259165im     0.142092+0.119667im       -0.197065+0.0620426im       0.07001+0.0159658im    0.0277579+0.0840785im      0.224999-0.0206227im   -0.0563272-0.0660483im    -0.0653466+0.24849im     -0.0954145+0.0684411im      0.147723+0.0593023im      0.174058+0.166831im       0.0239743+0.0381688im   0.0977924+0.0808787im    0.00401985-0.0133455im     0.110202-0.0934367im       0.114562-0.253667im       0.0221806-0.0664288im     -0.134391-0.159419im     0.0621227+0.151508im      0.141677+0.00793507im     -0.159554-0.174818im      -0.193267-0.155153im     -0.0820501+0.101094im      -0.318582+0.0163048im    0.0146568-0.0414737im     0.0794127-0.141985im      0.108059-0.0323771im     -0.0982701+0.00695253im    -0.167351-0.0383454im      0.207768+0.143085im        0.145085+0.0332094im
     0.234984-0.0023603im   -0.0331193+0.308688im     0.0128724+0.077044im       -0.025602+0.117495im      0.0499142-0.0624564im   -0.0455981-0.144164im    -0.00213534-0.0868793im    0.0113013+0.0396626im     0.0853995-0.147503im    -0.0600887-0.0304119im     -0.120111-0.216957im       0.145056-0.0305316im       0.102303+0.0565309im  -0.0758798+0.0525673im    -0.0803276-0.0383232im   0.00661691-0.315521im        0.293546-0.0874951im    -0.00605579-0.0701077im    -0.0088539-0.0836564im   -0.0376848-0.113646im     -0.114849-0.113833im        0.018295-0.178682im      -0.246183+0.135713im      0.0652471+0.100822im     -0.0390416-0.0164754im    0.0107881+0.187653im       0.047611+0.0767988im    0.0203536+0.360299im       0.0152647-0.0374365im    -0.0754437-0.14991im       -0.147822+0.102504im      -0.0640127-0.169539im
   0.00536982+0.101689im     0.0801666-0.0112095im    0.0561232+0.0817092im   -0.000254825+0.112199im       0.112133+0.0577291im    0.0125122+0.0794078im      0.108906-0.0656572im     0.164522-0.149479im      0.0162463-0.292415im     0.0336796+0.223211im       0.210633-0.00839077im    0.0174337-0.0520078im      -0.135574+0.156982im    0.0145621-0.0297247im     -0.104378+0.0976576im     0.139345-0.149491im      -0.0761925-0.110125im        0.173196-0.106027im      0.0992832+0.199477im     -0.086901-0.1897im      -0.0448245+0.101516im      -0.0901802+0.175555im     -0.0967292-0.0292495im      0.163415+0.00557678im   -0.0787028-0.328959im      0.185267-0.066462im    -0.00388768-0.112818im      0.035789+0.000805027im     0.165084-0.0878146im      0.151029-0.151153im       0.076028-0.106516im      -0.0198701+0.276287im
     0.173157-0.0730296im    0.0670295-0.0785736im    0.0686797-0.285602im        -0.18875-0.0298168im    -0.0886035-0.089618im    -0.0751228-0.0268583im     0.0159941-0.299835im    -0.0689523-0.100002im      -0.212208+0.03828im      0.0249574+0.0802067im     0.0359862+0.07574im        0.244431-0.0949439im   -0.000975578-0.249791im     0.104741-0.186328im      -0.129246+0.0182854im     0.201795-0.0625441im    -0.00978222+0.283416im      0.00477682+0.195319im       0.151996-0.176637im      0.133196+0.0187649im   0.00589123+0.105259im      -0.0792058-0.0812845im    -0.0393639+0.0972116im     0.0275837+0.0705487im    -0.0479332-0.0579699im     0.186122-0.0158886im     0.0900365+0.0948046im    -0.114003-0.0145235im       0.207347-0.0680492im    -0.0515416+0.200231im     -0.0277615+0.0817005im     -0.0319079+0.0595183im
   -0.0660861-0.0413906im    0.0819231-0.0610139im   -0.0137156+0.210238im       0.0880197+0.0952215im    -0.0561619-0.070594im    -0.0711588-0.00108415im    -0.119535-0.0166045im    0.0104669-0.102451im      -0.116718+0.0761132im   -0.0634624-0.164393im      -0.124888-0.0812539im     -0.250906-0.029899im       0.0911243-0.117937im    0.0190501+0.192368im       0.134981-0.149318im      0.375805+0.175349im       -0.051391+0.0528375im     -0.0707453+0.100067im       0.050539-0.115141im      0.186209-0.0379132im     -0.12528-0.187582im        -0.18318+0.169408im     -0.0744741+0.0491673im      0.135352+0.165766im      -0.147589-0.0208077im     -0.11269-0.019157im     -0.0927195-0.0932795im      0.15126+0.0749567im       0.224038-0.231025im    -0.00169001-0.114667im      0.0545653-0.165291im      -0.0682309-0.0574473im
     0.067807+0.0692236im    0.0616298+0.0904368im    0.0135288-0.0716523im      -0.141469-0.175579im       -0.14413-0.144438im   -0.00107459-0.0949419im     -0.263694+0.115204im     0.0462284-0.185144im       0.192703+0.0841075im    -0.141434-0.134048im      0.0702833+0.176287im        0.27892-0.0465131im     -0.0646194+0.134017im   -0.0368877+0.216539im     -0.0928421+0.0059459im     0.118618+0.0323771im      -0.123725+0.00455199im    -0.0150657-0.217397im     -0.0527353+0.157885im    -0.0912887-0.0153053im    0.0579732-0.0340763im      -0.220949-0.209529im       0.364597+0.0991576im     -0.015247-0.0467112im     -0.171127+0.00502036im  -0.0252511+0.0125085im    -0.0402041-0.0133227im    -0.139242+0.058758im       0.0475751-0.154462im     -0.0765271-0.0779004im    -0.0556516-0.131408im       0.0747306+0.00603238im
    0.0972233-0.0620172im    -0.201493-0.141066im     0.0572176+0.00766419im     0.0347643+0.179917im      -0.318306+0.242522im    -0.0526512-0.131452im      0.0358739-0.147567im      0.116298-0.0061975im      0.114293-0.0960699im   -0.0436222-0.0974474im    -0.0264498+0.176218im     0.00439031-0.0433064im     -0.0994474-0.0317437im   -0.109092+0.044673im      -0.131983-0.160204im     -0.236169-0.17222im        -0.208097-0.0439181im      0.0193773-0.0354768im      0.165063-0.115251im      0.153839+0.0438821im     0.141251-0.0981087im       0.152138+0.00904368im    0.0793056-0.143231im      0.0474267+0.0108495im    -0.0436358-0.0402731im    -0.202454+0.0257298im     -0.129671+0.0447762im    -0.004697-0.0290718im       0.172565-0.0203303im     -0.183969-0.196052im       0.220107+0.166765im       -0.100215+0.0567769im
      0.17919+0.00257354im   0.0374368-0.195888im     0.0370337-0.167334im      -0.0568935-0.296539im      0.0539478+0.135593im      0.108444+0.170047im      0.0710671+0.106845im     0.0443904-0.00995696im   -0.0370425-0.0911424im    0.0864567-0.0265448im    -0.0287622-0.00650117im   -0.0815142-0.197308im        0.138555+0.189337im   0.00802961-0.0465531im   0.000712514-0.0418471im    0.0702894+0.0960691im       0.146305-0.244654im        0.100147+0.129584im     -0.0970937-0.0972103im       0.1965-0.352231im       0.21757+0.00662266im     0.0564594-0.0482132im      0.117457+0.00894696im     0.146953+0.218594im      0.0150608+0.0441846im    0.0777802-0.0928173im     -0.131194-0.0184149im   -0.0252704+0.0278266im     -0.0210116+0.109769im      -0.306046-0.0815322im    -0.0447876-0.0722117im      0.0211185-0.08657im
   -0.0432833+0.0104714im    0.0630214+0.065877im     -0.241142-0.106986im       -0.187104-0.0685099im      0.245142+0.0994065im     0.150592+0.0124507im    -0.0889845+0.0946585im      0.14125+0.208508im     -0.0579828-0.00766605im   0.0150728+0.134817im      -0.037428-0.0702197im   -0.00374833-0.0363096im     -0.0914501+0.0149836im  -0.0928642+0.165318im      -0.087806-0.291424im     0.0832192-0.0829469im      -0.070371-0.000909835im    0.0446325-0.117269im       0.302046+0.0530927im     0.179337+0.216174im    -0.0639838+0.249826im      -0.0579573-0.0630272im    -0.0783036+0.0770022im      0.138965-0.0599813im      0.194157+0.0363755im   -0.0254717-0.0803566im    -0.0648653+0.114663im      0.107966-0.0245223im     -0.0874181-0.203422im      -0.122528+0.0388624im      0.190209+0.00895627im      0.158315-0.147528im
    -0.113083+0.0489867im    0.0739467+0.00808599im   0.0120464-0.0488123im      0.0474637+0.126268im      -0.107423+0.123559im      0.151541+0.0235962im       0.27137+0.101757im   -0.00902529-0.223558im      -0.143186+0.170737im     -0.117407+0.052551im       0.101162+0.0645438im    -0.0782928-0.182887im        0.078788+0.0672591im  -0.0639565+0.114358im       0.263963-0.22855im      -0.117739-0.104852im      -0.0120811+0.0659962im     -0.0647245-0.212509im     -0.0441076+0.0791658im    0.0253848-0.170161im     -0.150032+0.0170977im       0.124591-0.0264887im   0.000932772+0.255763im      -0.165111+0.175176im       0.107147-0.0507468im     0.014516-0.0727088im      0.312055+0.097183im       -0.2257-0.0750543im       0.072266-0.142137im     -0.0407513+0.0442944im    -0.0207142+0.0508746im     -0.0924541-0.0413621im
     -0.11877-0.0362im       0.0876977-0.0423996im    0.0166675+0.141428im       0.0221131-0.303723im      0.0737898-0.268728im      0.298067-0.0162751im     -0.130866-0.122092im     0.0902603+0.120894im     0.00706368+0.0279282im   -0.0588166-0.290921im       0.289784-0.0635662im     -0.114974-0.176858im     -0.00547384+0.059604im    0.0692167-0.034532im     -0.0639094-0.135399im      -0.10023-0.148037im      -0.0517882+0.0074748im      -0.146027+0.0527066im     0.0762748-0.103344im        0.0452-0.116652im     -0.110343-0.100071im      -0.0653828+0.0569967im    -0.0410094-0.118865im      -0.019423-0.0605046im     0.0123577+0.162225im      0.196699+0.136417im      0.0749962+0.107795im     -0.072622-0.000455148im  -0.00952567+0.037452im      0.0686451-0.120363im        0.10322+0.223171im      -0.0239954+0.242006im
    -0.063834-0.00302197im   0.0256635-0.0140895im    -0.294126+0.0926935im     -0.0304523+0.0467447im   -0.00352609-0.0875624im    0.0626182-0.0988999im      0.134986-0.115131im     -0.280641-0.0256813im     -0.175697-0.189053im     0.0054944-0.0348922im   -0.00700736+0.0572742im      0.132963+0.12835im        -0.274657+0.0821289im   -0.070789+0.0688674im     0.0412506-0.0898454im   -0.0659731-0.132761im      -0.0139832-0.0809735im      -0.201968+0.251834im      -0.167295+0.0554623im     0.162562-0.07754im      -0.159514-0.161301im       0.0688405-0.028847im       0.153952-0.0387139im     -0.130348-0.140494im       0.132554-0.12958im       0.191309-0.0198921im     -0.132694-0.200422im     0.0462985-0.0169848im      0.0992904-0.0413361im     -0.167918+0.0212124im    -0.0741494-0.0930296im       0.225222-0.0738535im
    -0.141025-0.0291885im   -0.0295527-0.319041im      0.026739-0.18602im          0.19401+0.0707212im     0.0221646+0.0201461im     0.182453-0.00267268im   -0.0981302-0.0495138im     0.069205+0.030789im       0.215399-0.0207121im   -0.0196241+0.00741127im   -0.0439648+0.0870914im    -0.0255454+0.0632184im      0.0370171+0.0923443im   0.0235822+0.194984im       0.257721+0.0220345im   0.00518149-0.222277im      -0.0468305+0.0864359im     -0.0031276+0.191299im      0.0908263-0.103046im      -0.17537-0.00107011im    0.138396+0.159654im       -0.154354-0.254556im      -0.171969-0.0492482im     -0.224938-0.0555255im      0.104176-0.0233808im    0.0985153-0.00759713im   -0.0210321+0.0187005im     0.154536+0.225359im        0.100758+0.0209943im    -0.0483164+0.035997im     -0.0914755-0.261153im       -0.131179+0.0303585im
  -0.00427854+0.103063im     0.0837348+0.119506im       0.21068-0.0701106im     -0.0176276+0.248536im      -0.164462-0.0851735im     0.388855+0.122774im     -0.0518655-0.039878im      0.135097+0.0869831im    -0.0332533-0.167466im      0.189394+0.116478im    -0.00149466+0.112761im      -0.106757+0.137369im        0.175862-0.0461727im  -0.0918195-0.142137im      0.0561765+0.0245254im   -0.0574733+0.0688214im       0.129653-0.00275053im      0.139348+0.0683234im     0.0399668-0.126629im      0.032441-0.0258524im    -0.196279-0.101438im       -0.252376-0.0963324im      0.226405-0.0977367im     -0.063691+0.0227071im     0.0472023-0.107148im      -0.16977+0.182685im     -0.0275435-0.0451918im   -0.0588527-0.0464942im       -0.13673-0.192093im     -0.0628855+0.0502966im   -0.00356085+0.0407908im       0.185291+0.0330398im
      0.16603-0.0195627im    -0.114168+0.0929472im   -0.0910001+0.0208207im     -0.0985749-0.0448576im     -0.106814+0.0963678im    0.0477759-0.0263606im    -0.0225062-0.0221292im    0.0392415+0.075487im      -0.038258+0.13087im       0.131323+0.0959522im     -0.230546-0.0618576im    -0.0710375+0.0284355im      -0.157604+0.135806im      0.13168-0.0268196im      0.148337-0.0371042im    0.0650246+0.0589907im      0.0134868-0.0902856im      -0.249091+0.0644332im     -0.131063+0.159877im      0.024494-0.0870032im    0.0580274+0.164499im       -0.226063+0.211914im      -0.131685+0.121215im      -0.201291-0.116891im      -0.111049-0.114996im      -0.17638+0.122261im     -0.0908943+0.205883im      -0.15503+0.155486im     -0.00133507+0.0315402im     -0.171698+0.095127im      0.0785113+0.0953537im     0.00358082+0.366548im
     -0.13564+0.0493238im    0.0483158-0.234504im    -0.0538899-0.205269im      -0.0279916-0.104583im     -0.0742848-0.0575756im   -0.0407421-0.150749im     -0.0787145-0.206577im    0.00370778+0.208074im      -0.119936+0.0635127im    -0.125932+0.153581im     -0.0126376+0.169799im      0.0946723+0.0393753im      0.0976158+0.146088im     0.178425-0.0390348im      0.060543+0.03145im     -0.0285668+0.150245im        0.239758-0.0947858im      0.0834189-0.163595im       0.178825+0.174515im     0.0858593-0.0450169im    0.0132566-0.294504im        0.101437+0.200896im     -0.0685799+0.00690408im    0.0378756-0.27069im      -0.0136075-0.0827084im   -0.0807257+0.143074im        0.25337-0.054795im      0.056961+0.122311im      -0.0307947-0.0647555im    -0.0725798-0.0784378im     0.0351161-0.0870624im     -0.0730083-0.10432im
   -0.0570259+0.154156im    -0.0526347+0.0531963im     0.142359+0.0425017im       0.191725-0.00367169im    0.0866432-0.160517im     -0.113176-0.0616229im   -0.00773839-0.126209im      0.104537-0.114201im       0.136349-0.0619941im     -0.20536+0.0837965im      -0.10545+0.184114im      -0.135815-0.147218im        -0.19977+0.0673449im   -0.325516-0.138474im       0.121977-0.123803im      0.155262+0.0439604im      0.0990179+0.111167im      -0.0943596-0.0585855im       0.10749-0.0277487im  -0.00200115-0.00432382im  0.00609323-0.108454im      -0.0578814+0.0305985im   -0.00877918-0.0816603im      0.084516-0.0605889im     -0.101706-0.0855117im    0.0830007-0.273368im      0.0173887+0.0674935im    0.0502601+0.0495439im      -0.242659+0.19278im       -0.231307+0.253492im     -0.0470666+0.152741im       0.0840339-0.00962282im
     0.121685-0.074315im      0.207493-0.218931im    0.00760999+0.0914466im     -0.0497839+0.0718662im     0.0228962-0.0563667im    -0.117061-0.0435im        0.0346038+0.0128865im    0.0224246-0.0495045im    -0.0648562+0.0573658im   -0.0378027-0.104285im     -0.0238041-0.140747im     -0.0442817-0.0937056im      -0.223819-0.106095im   -0.0136363+0.0865959im    -0.0451904-0.113668im     -0.132684-0.0476697im       0.249849-0.0268558im       0.238689-0.114742im       0.220612+0.142697im     -0.042052+0.00452727im  -0.0721396-0.0843499im     -0.0434729-0.133345im      -0.077132-0.0198011im     -0.069441+0.130675im      0.0163858+0.146295im     -0.181715+0.191149im     -0.0571772-0.103676im    -0.0236286-0.181501im       0.0274071+0.20945im       -0.120881+0.203472im      -0.136531-0.240204im        0.143145+0.306052im
    -0.462159-0.0126009im    0.0846131+0.0518421im   -0.0757852+0.016986im       0.0554415-0.240153im     -0.0438109+0.0537898im    -0.117565-0.0526224im    -0.0708181-0.0880806im     0.101175-0.213808im      -0.109116-0.0192575im      0.18843+0.117589im      -0.311914-0.0778845im    0.00984412+0.0572477im       0.158455+0.0375614im   0.0286423-0.192812im      -0.121907+0.00338763im    0.012235-0.253848im       0.0865632+0.0850387im     -0.0102047-0.236166im      -0.039191+0.0751643im    0.0735357-0.0189373im   -0.0587355-0.000237266im   -0.0101762-0.0416246im      0.149786-0.235939im      -0.114314+0.168065im      0.0811165+0.0775573im   -0.0327978-0.0393749im      -0.17547+0.0321049im   -0.0504065+0.133768im        0.127807+0.042913im      0.0182926+0.0537633im     0.0714916-0.018587im      -0.0589188+0.0334124im
         0.21-0.0439737im     0.113786+0.0904082im    -0.116446-0.00779119im    -0.0657247-0.254053im    -0.00179733+0.0819645im   -0.0530094-0.0885202im     0.0503282-0.187872im      0.294508+0.136529im    -0.00514029+0.0185438im    -0.156844-0.0126635im    -0.0672108+0.145796im     -0.0972151+0.0465443im      -0.102038+0.0871865im    0.151695-0.0488755im      0.288828+0.250347im     -0.048344-0.258617im       -0.123978-0.0404374im      -0.146047+0.0184209im    -0.0421176-0.142102im    -0.0760945+0.114057im     -0.106887-0.0574214im      0.0157545-0.0144069im    -0.0318201-0.0860853im       0.13445+0.293636im     -0.0132608-0.0607951im    -0.131098-0.0476558im     0.0563808-0.152432im     -0.115782-0.154341im       -0.122579-0.0959902im     0.0958293+0.0626719im    0.00726334-0.159384im       0.0740187-0.0770964im
    0.0326125-0.120356im     -0.092892+0.0583918im    -0.133475-0.160292im       0.0453219+0.114048im     -0.0277308-0.225454im     0.0183332-0.0323233im     -0.055719+0.159837im     -0.105945-0.0495381im     0.0453355+0.0522706im     0.167705-0.105556im       0.108256+0.30048im       -0.339428+0.0981703im      -0.103545+0.130131im     0.190405-0.187702im      -0.144399+0.0872785im   -0.0146548-0.0317378im       0.100784+0.153195im      -0.0113452-0.0429337im     0.0668258+0.255073im    -0.0417434+0.0537281im    -0.132186+0.0457523im     -0.0464332-0.0900238im     -0.198567+0.0800175im    0.00788823+0.208814im     -0.0716058-0.0215768im    0.0874389+0.00616727im    -0.103816-0.0811401im   -0.0282621-0.0765157im      0.0381424+0.0889384im     -0.226695-0.152745im       0.144833+0.0385293im     -0.0933116-0.192779im
     -0.17962-0.0153288im    -0.204422+0.026603im     0.0255874+0.0940213im      -0.125785+0.0188239im     0.0898274+0.0272162im     0.189495-0.11728im        -0.11811-0.127357im     -0.175465-0.00928544im    0.0811948-0.180025im    -0.0654554+0.0109445im    -0.0143406-0.0027165im    -0.0468757-0.249404im      -0.0259267-0.110372im     0.120214+0.0247865im      0.130471+0.0807155im    0.0337762-0.00247975im      0.177987-0.124161im       0.0159477+0.0205994im    -0.0196956-0.0540441im   0.00431754+0.167307im     -0.204776+0.266885im        0.134225+0.0282245im      0.259617+0.0216651im     0.0648526+0.0519537im     -0.240027-0.12936im     -0.0704759+0.0895866im      0.107894+0.272937im     0.0139238-0.12074im         0.121983+0.247385im      -0.051175-0.0453367im     0.0568978-0.231553im      -0.0194245-0.0843858im
    0.0531972-0.059685im      0.199163+0.15973im       0.123062+0.0985915im      -0.206833-0.229654im       -0.21796+0.243218im     0.0217894+0.0022581im      0.101892-0.250711im     -0.217992-0.0413628im      0.200138+0.0214059im     0.150451-0.083102im      0.0210462-0.0457952im     -0.254798-0.0377411im      -0.115261+0.0676158im   -0.051904-0.166308im     -0.0209132-0.163933im     0.0119487+0.0597129im     -0.0484052+0.0177417im       0.132052-0.198953im     -0.0212521-0.105591im    -0.0230634+0.07357im      0.0738101-0.0347688im      -0.119784-0.0196236im     -0.117981+0.0272681im     -0.193592-0.184845im       0.014215-0.102256im      0.162679+0.0539262im   -0.00785404+0.0267142im     0.177262-0.102803im      -0.0457933-0.0655813im      0.025642-0.0114013im    -0.0895116-0.184757im      -0.0972902-0.183698im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  0.037728374877508436 - 0.043265998042561926im
   0.09174601101688998 - 0.11736855913607495im
   0.14160974420236444 + 0.27604309443052866im
  0.031639717415639035 - 0.015272476107312203im
  -0.05015801499965944 - 0.22316344065530147im
  -0.07056219892598556 - 0.14824994331653893im
    0.1444294871329078 + 0.08246404808971258im
   -0.2037113585098972 + 0.028382948823112958im
     0.043948577842159 - 0.04365407672545498im
  -0.10582841723887432 + 0.17159601288924387im
   0.06340401152848427 + 0.1756082268330875im
   0.15399988737572848 - 0.045893823488710385im
  0.030270450394097495 + 0.07302524032924002im
   0.04861919473521634 - 0.13531358695873627im
  0.010313128751383446 - 0.11104635970916263im
  -0.06518089573087303 + 0.0320151279940024im
   0.18125831818419866 + 0.045982454728317565im
   0.36156524935880624 + 0.0im
 -0.015538850874051106 - 0.023992914625906456im
 -0.025730746329262547 - 0.2012397716508163im
   0.07832411134217387 - 0.07025111182786337im
   0.03067257977974322 + 0.02027307064135656im
  -0.15803298502398033 + 0.03198476866315072im
 -0.005110853301110052 - 0.1952833565877727im
    0.2495559032501169 - 0.009435164966040799im
 -0.007278358834312382 - 0.3306990329347442im
   -0.0994634750865164 + 0.22029374211074976im
 -0.011240259979940976 - 0.03430117835447728im
    0.1189955846674306 - 0.021802186723307193im
 -0.016432812770434613 - 0.005116209376816418im
   0.11838876847900603 - 0.08453052359067456im
   0.12846219722323177 + 0.09813682767481396im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 28 February 2025 11:19">Friday 28 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
