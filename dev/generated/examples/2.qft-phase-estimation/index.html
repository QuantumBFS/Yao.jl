<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
 -0.0440403+0.207995im      -0.0457287-0.350864im      0.197432-0.0245984im   0.0908576+0.0697212im    0.0510242+0.0372093im     0.179099+0.0466897im    -0.0299555-0.206855im      0.0103503+0.0169972im    -0.0710795-0.0437829im       0.19559-0.13728im      -0.00943725-0.0736987im      0.271001+0.0152386im     -0.044346-0.132274im     -0.0318399-0.0494127im   -0.0269952-0.180692im     -0.0986677+0.0071337im    -0.0923616-0.0566316im    -0.0105857+0.129234im      0.0300721-0.00322255im    -0.139688+0.138221im    -0.0421688-0.0945347im    -0.254496+0.276039im       0.136665+0.134598im      -0.037559+0.0286648im      0.080681-0.250848im      0.0530071-0.146367im     -0.131345-0.0800915im  -0.0918367-0.0752548im    0.00217853-0.166702im       -0.186204+0.094503im     0.00394507-0.125555im      -0.055157+0.0691864im
   0.141654-0.198734im       0.0612213+0.269404im      0.128317+0.0150568im   -0.129868+0.0278373im     0.125531+0.103357im     0.0548263-0.0543604im   -0.00509406-0.154435im      -0.139376+0.0114051im      0.176291+0.0721461im     0.0717739-0.0724159im       0.219787-0.129418im       0.027771+0.150562im       0.176283-0.0334243im     0.0573189-0.0757467im     0.106834-0.00999936im   -0.0631974-0.160323im      0.0869673+0.0572506im     -0.070706-0.00352413im    -0.156719+0.0586825im     -0.120842-0.0115873im   -0.0444989+0.129319im     -0.103044+0.210041im     -0.0241781-0.0658158im     -0.299099-0.0718603im     0.0572809+0.0282493im    -0.0183581+0.0405622im   -0.0305542+0.0401867im   -0.209987+0.0133038im     -0.267936-0.170866im         0.28442+0.216622im     -0.0187741+0.0909864im     0.0644526-0.101489im
   0.133563-0.00871471im     0.0699336-0.105432im    -0.0460862-0.0613984im  -0.0791461+0.0601578im     0.194642-0.0177209im    0.0660271-0.0946638im    -0.0311909+0.149921im       0.070502+0.114257im       0.105437+0.0162254im  -0.000246768+0.30161im       -0.0302633+0.2225im       -0.0811713-0.107839im      -0.114881+0.0275963im    -0.0315664+0.0599073im    -0.122285-0.0320447im      0.189561+0.250688im       0.026491+0.0695294im    -0.0927379+0.112278im      0.0631255-0.16161im     -0.00091157+0.19095im       0.154851-0.102482im     -0.177924-0.0111837im     0.0279738+0.00996219im    -0.172597+0.0108695im      0.153612+0.0536065im      0.117593-0.072948im     -0.118672-0.106564im    0.0218478+0.144943im     -0.0171505+0.0680353im      0.0726028+0.310912im       0.183978+0.241018im      -0.174058-0.202523im
   0.127758-0.071213im        -0.20625-0.0667291im     -0.12762-0.0657997im   0.0254158-0.0763507im     0.229781+0.050109im     -0.260428+0.143234im     0.00768548+0.100848im      0.0405726-0.0193791im    0.00158598-0.191632im      0.0201044+0.168185im      -0.0838421+0.0292668im      0.112494+0.0907468im    -0.0965719-0.0803061im     -0.251706-0.0247608im    -0.206681+0.0904146im    -0.0960636-0.230705im     -0.0241099-0.107205im      -0.048595-0.0476918im     -0.144718+0.01773im       -0.207945+0.062508im     0.0570323-0.101096im     0.0382856+0.0836405im      0.104687+0.0762669im     0.0748964+0.102321im     0.00504596+0.000412457im  -0.0407092+0.0527044im     0.165498-0.0258503im   0.0629753-0.161678im        0.15799-0.275475im        0.158154-0.0932339im     -0.102046+0.152374im       0.133251-0.26995im
  0.0466298+0.00816034im     -0.152707-0.00631237im  -0.0248778+0.16773im     -0.215425-0.21671im    -0.00394774+0.0762253im     0.142896-0.149489im       -0.14128-0.031744im      0.0414019+0.025096im      0.0992881+0.098347im      0.0595274+0.00335125im     0.0213748+0.0130381im     -0.176945-0.102074im      -0.255297-0.1578im       -0.0863785-0.266774im     0.0477947+0.109418im    -0.00808731+0.0171836im     -0.200729+0.00538882im    -0.128342+0.0298856im     -0.190457+0.336473im      0.0431364-0.161986im      0.122855-0.189667im    -0.0307592+0.0514523im     -0.220635-0.0401384im    -0.0659497-0.00476428im   -0.0752021-0.107418im       0.295824+0.0461683im    0.0484756-0.0387633im      0.1128+0.144218im      0.0277642-0.08608im       -0.0292615-0.108939im      0.0467942-0.132681im     -0.0439634+0.0128644im
 0.00344488+0.0555411im     -0.0193091+0.0649266im     -0.10852+0.061191im   -0.0760926+0.0769203im     -0.11673+0.118203im     0.0247216-0.188292im       0.113639+0.00262591im     -0.16796-0.0743638im     -0.126839-0.0755013im     0.0736362-0.0592037im       0.190918-0.0203323im     0.0154194-0.0810808im      0.216755-0.197694im      -0.183533-0.0787908im    -0.367156+0.0252222im      0.262426-0.0116465im     0.0809098+0.0850636im    0.00436277+0.014132im       0.242465+0.213757im       0.150173+0.0950639im    0.0461412+0.0490386im    0.0174231-0.138647im       0.176531+0.138647im      -0.246649+0.0719815im   -0.00784459-0.0998414im     -0.082009+0.180188im      0.115533+0.0729593im  -0.0146051-0.00946651im   -0.0568783-0.118131im       -0.206555-0.111285im       0.106576+0.0703732im      -0.02007-0.0478107im
 -0.0187048+0.000240898im    -0.115384+0.0359604im    -0.105819+0.201734im    -0.220949-0.0557424im    -0.139911+0.0349553im    -0.120753+0.315428im       0.096667-0.162545im       0.101059-0.134514im      0.0653796-0.183203im      -0.225145+0.0182047im      -0.132499-0.0701652im    -0.0132912-0.0303556im      0.228674-0.152299im       0.113813-0.00877275im  -0.0123448-0.0198155im      0.217028+0.0392553im     -0.145416+0.0183097im     -0.015616+0.368192im       0.131272-0.0698363im    -0.0937836-0.0881988im    -0.040245-0.0650368im     0.202773+0.155642im      -0.124926+0.00268622im    0.0299727+0.16378im       0.0331034-0.00863497im      0.02852+0.0983289im    -0.130329-0.0672847im   -0.124701+0.0761969im     0.0458712-0.00537205im     0.0171542+0.17331im       -0.129757-0.00799838im    -0.128341-0.0357645im
 -0.0556371+0.275189im       0.0321784+0.0663409im    -0.155213-0.127613im     0.057036-0.1157im      -0.0528121+0.13791im       0.175999+0.0401856im      0.155771+0.167822im     -0.0707387+0.159487im      0.0348781-0.138634im      0.0457579-0.133399im        0.013985-0.0168598im    -0.0396393+0.0935069im      -0.14415+0.0164163im     0.0236203+0.0308753im     0.132356+0.0706855im     -0.129839-0.0816937im    -0.0564724+0.113644im       0.172702+0.186041im       0.066083-0.0862204im     0.0943304+0.211607im     0.0333749-0.242138im    -0.0304634+0.142982im      -0.264074+0.0061366im      -0.15648+0.080988im      0.0927667+0.223902im     -0.0236255+0.105614im      0.290206+0.261625im    -0.126573-0.0831531im     0.0637401-0.00700656im    -0.0103212+0.0459712im   -0.00923416+0.102567im    -0.00583017+0.103697im
   0.427901-0.0520226im     -0.0982964-0.0212016im     0.100092+0.0231222im   -0.010326-0.0279101im    -0.133747-0.03252im      -0.116033+0.134575im      0.0146569+0.0973974im      0.120462-0.0551985im      0.110205+0.0329113im     -0.119086-0.0676242im       0.125836-0.0590878im      0.261488+0.0108678im     -0.058206-0.24065im        0.016651+0.0933986im    0.0505102-0.0719991im    -0.0373017-0.0808562im     -0.230148-0.106361im     -0.0448095+0.10064im      -0.0423579+0.0864978im     0.0972126+0.0800392im    -0.263342+0.110949im     -0.184133-0.201135im    -0.00605108+0.0818827im    -0.0710706-0.0718308im    -0.0287448-0.000328648im   0.0443647-0.108321im      0.164168+0.146247im     0.150058-0.0176284im    -0.0248103+0.291573im     -0.00417208-0.00248937im     0.097293+0.189959im      -0.110802+0.0734796im
  0.0927288-0.137301im        0.124499-0.271238im      0.065328+0.116006im    0.0750251-0.0212935im   -0.0938172-0.0222369im  -0.00514289+0.0901516im     -0.178095-0.0613563im     -0.226467-0.0864822im    -0.0474586-0.142616im       0.230977-0.104499im       -0.123901+0.0943229im     0.0331084+0.021572im     -0.0361992-0.0861409im    -0.0149218-0.0408874im    0.0718421+0.196145im     -0.0751088+0.289254im     -0.0676527+0.0295562im      0.044738+0.0217608im     0.0734356-0.0539017im      0.073283-0.225722im     -0.202525-0.173234im      0.198232-0.0907519im   -0.00429433-0.0587149im     -0.275212-0.033452im      0.0552438+0.0852415im     -0.133305+0.0315358im   -0.0101534+0.0497678im    0.143953-0.141039im    -0.00798567+0.0208375im      0.0922963+0.134456im       0.122553-0.0528063im      0.248372-0.203558im
   0.140232-0.262451im        0.004713-0.0594517im   0.00893622+0.0793822im  -0.0472022+0.0778606im    -0.122578-0.0593341im     0.237671-0.176403im      0.0418292+0.307405im       0.117639-0.161404im     -0.0458012-0.108402im     -0.0366743-0.163347im       0.0551234-0.22294im      -0.0468777+0.208683im      -0.160554-0.00804793im     0.175952+0.0597444im    -0.104402-0.0994284im    0.00674052-0.128339im     -0.0384468-0.0454116im    -0.0635507+0.0279223im    -0.0165235-0.164887im      -0.195499+0.0371044im    0.0481451-0.233087im     0.0887505-0.111481im       0.122453-0.143575im      0.0223252-0.039583im      0.0246508-0.00469806im     0.013626+0.033025im    -0.0783608+0.0078033im   -0.249027+0.228458im      0.0799921+0.000317452im    -0.175454-0.0743452im     0.0575089-0.0434841im      0.184396-0.136507im
  -0.071671+0.00701189im    -0.0910489+0.140385im     0.0405465+0.0535106im   0.0569169-0.215152im    -0.0604804+0.071967im     -0.190214-0.0964864im     -0.163307-0.0849491im       0.01562-0.0503683im     0.0710587-0.0241981im    -0.0257283-0.0839286im      -0.135127-0.0513316im    -0.0647135-0.13161im        0.145223-0.187327im       0.030686+0.308249im     0.0152531+0.126183im     -0.0296516+0.0417965im      0.151003+0.213635im    -0.00886794-0.177094im     -0.0066818+0.0908621im     -0.280583+0.30022im     -0.0455437-0.182265im    -0.0269682-0.0654877im     0.0326773+0.175825im    -0.00453296-0.164487im       0.163054-0.0134006im     0.0635729-0.0684021im    0.0264969+0.0176314im  -0.0995257+0.0527191im      0.197254+0.0870572im       0.125805+0.0369294im      0.231519-0.216284im      0.0233923+0.0701201im
   0.109004+0.0304519im    0.000505815-0.0828298im     0.267135+0.0688066im   0.0210621-0.101005im   -0.00861262+0.0558755im    0.0521151-0.016229im      -0.137956-0.0720452im     0.0264439+0.00565958im    0.0226624-0.0757788im      0.165842-0.0679752im      0.0112677+0.219703im    -0.00772956+0.0608714im     0.0282353+0.236845im       0.287054+0.151966im     -0.236602+0.140041im     -0.0880213-0.154501im      0.0097512-0.0176663im   -0.00444135+0.000670124im    0.294539+0.189322im    -0.00387701-0.137863im     0.0815286+0.151904im    -0.0448288+0.156516im     -0.0951345+0.0674612im      0.188738-0.0205361im     0.0981498-0.0415697im    -0.0625465+0.0849768im     0.195673+0.121799im    0.0158058+0.269539im      0.0838594+0.087561im       0.0208955+0.00571398im   -0.0919859+0.0398011im     -0.143744-0.244964im
   0.151725-0.095811im      -0.0683475-0.135206im       0.18566-0.054277im   -0.0333676+0.0522806im    -0.172037-0.0807016im   -0.0220155+0.0920511im       0.21511-0.259599im     -0.0133715-0.0742191im     0.0838348+0.0700357im     0.0268695+0.180406im      -0.0255785+0.0913148im    -0.0951274-0.00375668im   -0.0883994+0.122686im      -0.141129-0.00840032im     0.17403+0.119746im      0.0256906+0.0925125im     0.0960733+0.0389737im     -0.108483-0.0985208im    -0.0111349-0.0377463im     -0.191953+0.145377im      0.189918-0.0831147im     0.116994-0.104569im    -0.00649463-0.125705im      -0.152201+0.168551im      0.0400493-0.32433im       -0.168764-0.0314042im     0.306896+0.0807141im   -0.120617+0.103534im     -0.0602067+0.0794486im     -0.0882076-0.0267336im     -0.170371+0.0595713im     0.0223187+0.196736im
  -0.135296+0.0377329im       0.182684-0.06125im       -0.10645+0.234911im    0.0977704-0.218264im    -0.0803482-0.185223im    -0.0437027-0.0243017im     -0.103811+0.269079im     -0.0634181+0.023199im       0.156905-0.156341im       0.140371+0.0807406im     -0.0376896-0.0608093im     0.0268205+0.0022593im     0.0942688-0.0608722im    -0.0268909-0.175554im      0.106669+0.00808703im     0.134334-0.00423674im    -0.073401+0.33628im       0.0496687-0.10119im       0.0297395-0.0548635im    -0.0962029+0.00216929im   -0.202314+0.101986im     -0.171562+0.133308im       0.172815-0.182271im       0.181945+0.00532281im    -0.136687-0.178628im      0.0355029-0.03941im       0.239497-0.0698764im  -0.0197935+0.131896im     -0.0945593-0.0219698im      -0.021081+0.0650738im    -0.0773217+0.195775im      0.0207703+0.0479082im
  0.0226499-0.0809145im    -0.00333795+0.152168im    -0.0437531-0.0777933im    0.231159-0.298902im    -0.0873704-0.0437567im     0.110247+0.0642704im      0.121079+0.148245im     0.00473404-0.00347341im    -0.143244+0.140594im       0.143245+0.0994893im      0.0298091-0.07096im       -0.163964+0.135606im     -0.0484793-0.104205im       -0.23957-0.0630984im   -0.0453768+0.114175im      -0.133725+0.170231im       0.221955-0.155739im    -0.00228798+0.371255im      -0.025949-0.0271771im     -0.108148-0.0981931im   -0.0928061+0.173928im    -0.0481977+0.0164429im      0.014683+0.340488im      0.0412499-0.011475im    -0.00454069-0.0698802im    -0.0895984+0.00531213im  -0.0424213-0.0564749im  -0.0166541+0.224932im     -0.0318821+0.101606im       0.0136886+0.0916189im     -0.063741-0.0970513im     0.0476496+0.00696781im
  0.0851123-0.0970674im       0.118149-0.0173695im   0.00588913-0.120394im     0.153972-0.0841219im    -0.137669+0.130859im     -0.181627-0.0658624im     -0.148162-0.078324im       0.077541-0.0518148im     -0.242258+0.0187822im     -0.153114-0.000190636im      0.23198+0.195251im     -0.0834739+0.185754im    -0.00771208-0.133278im      -0.176669+0.0936283im    0.0386262-0.104462im     -0.0422705+0.0964306im    -0.0867639+0.100357im       0.108806+0.0982974im     0.0516001+0.13883im       -0.027585+0.0128525im   -0.0115254+0.0308275im   -0.0498371+0.118768im    -0.00826335-0.407331im       0.076154+0.0624975im      0.352427+0.11732im      -0.0317447-0.0102338im   -0.0984994-0.0785678im    0.080135+0.129629im      0.0279375-0.196883im      -0.0315679-0.111712im     -0.0109915+0.080417im    -0.00452993+0.152474im
  0.0814588-0.236737im       -0.208936+0.0493737im    0.0697732+0.245345im     0.175398-0.028699im     0.0303215+0.187524im      0.149154+0.129869im      0.0382957+0.00160003im    0.0293271+0.186378im       0.111227+0.0753522im     -0.018627+0.0187463im      -0.164373-0.0446742im     0.0640983+0.212999im      0.0737687+0.00675131im    -0.045116-0.225877im    -0.0566864-0.184835im      0.0992894+0.184511im       0.157458-0.0378691im    -0.0694884-0.0250633im      0.192297+0.0395644im      0.116518+0.124058im      0.112896-0.179419im    0.00918799+0.0383465im      0.172777-0.115094im        0.23737-0.112907im      0.0850711+0.174145im      0.0252236+0.0076719im     0.146555+0.12879im      0.103766-0.129146im      -0.177053+0.0179685im      0.0880611-0.0145861im     0.0120863-0.176839im     -0.0906792+0.0657769im
  0.0753087+0.0908291im      -0.227285+0.190756im    -0.0595486-0.109185im   -0.0426659+0.0301743im   -0.0340331-0.103341im    0.00271486-0.0923726im     0.0315218+0.0811901im     -0.132586-0.00145407im    0.0446308-0.0275562im      0.158814+0.0387461im      -0.164445+0.109501im        0.23371+0.294106im      0.0460377-0.153922im       0.257139-0.00282374im   -0.119071+0.0889839im    -0.0811353+0.184735im        0.26103+0.00917289im     0.129954+0.009978im     -0.0209676+0.167596im     -0.0309004-0.143132im     0.0746597+0.0682483im   0.00557822-0.0755227im    -0.0430307-0.226212im     -0.0283706+0.234214im     -0.0129338-0.0715932im      0.253203-0.193084im    -0.0706238-0.0929099im   -0.109921-0.151856im       0.139988+0.0826248im     -0.0640307+0.0313348im     -0.019937+0.108085im      0.0247132+0.102196im
   0.177805-0.0917124im     -0.0385571+0.0409303im    -0.122534-0.228909im    0.0742492-0.137381im      0.170473-0.275836im    0.00213716-0.0654269im      0.199416-0.217287im      -0.151021+0.083999im      -0.142669-0.0962666im      0.107881+0.0153132im     -0.0665617-0.0715501im    -0.0705783+0.0339586im      0.019151-0.112642im      -0.078614-0.0517162im     0.273099-0.212616im      0.0757523-0.185244im     -0.0925899+0.170879im      -0.009219-0.0118267im      0.276343+0.0306077im       0.13114+0.0348624im    0.0723098+0.0536103im    0.0602934-0.081285im     -0.0553324-0.0596565im     0.0673786-0.197904im       0.039959-0.148544im       0.172074-0.02427im      -0.110328+0.125248im    0.0159778+0.0152534im      0.179968+0.0685801im    -9.99531e-5+0.0520104im    -0.0716326-0.0902357im     0.0163622-0.248745im
  0.0418024-0.165637im       0.0678625-0.0491375im    -0.121152+0.0403857im    0.067228-0.331997im      0.161246+0.0812907im    -0.012948-0.0701571im     0.0231358-0.0332417im     0.0184214-0.324418im     0.00128875+0.0125867im      0.175641-0.0398305im     -0.0492037+0.274653im     -0.0816983-0.125699im       0.045491-0.00446448im      0.13439-0.108669im    0.00125716-0.185717im     -0.0494563-0.199422im      2.7831e-6-0.124603im      0.0065365-0.0945845im     0.0777575-0.113182im      -0.172929+0.163501im    -0.0303152+0.101436im     0.0800784-0.0147926im    -0.0495398+0.0411582im     -0.115795+0.303759im     -0.0469208+0.232426im       0.140737-0.0758028im   -0.0213299+0.014188im    0.0714958-0.0925804im     -0.235527+0.0819924im      -0.210228+0.00663769im  0.000656929-0.0778569im    -0.0361935+0.0929064im
  0.0279729-0.00624697im    -0.0251046+0.108466im     -0.165306-0.182382im    -0.210176+0.137603im     -0.225524+0.0648214im    0.0343351+0.071094im      -0.243366+0.0812397im    -0.0552276-0.0289665im     -0.207852-0.0453013im      0.113658+0.0482348im      -0.293835-0.135513im      -0.141978+0.0733665im     0.0512839+0.137268im      -0.166386-0.0841841im    0.0343094+0.019409im       0.106379-0.0894822im    -0.0730142-0.333621im     -0.0437537-0.240071im     -0.0203788+0.0176633im    -0.0369778+0.01125im      -0.144414+0.11289im     0.00770651+0.22072im     -0.00106284-0.0453208im   -0.00825268-0.06276im        0.259766-0.0648618im     0.0716822-0.0296732im     0.111335+0.0698311im  -0.0188275-0.0201026im     -0.015602+0.114525im       -0.136505+0.177445im       0.152659+0.0125152im     -0.119985+0.0171836im
   0.114687-0.00362696im       0.02021+0.0416798im    0.0594894+0.0624447im  -0.0639898-0.0812968im     0.169834+0.104788im    -0.0807623-0.133646im      0.0154238-0.0193326im   -0.00199981-0.005777im      0.0758977-0.152629im       0.158537-0.204405im       -0.296504-0.139215im      -0.106012-0.0528869im    -0.0652406+0.121429im     -0.0355884+0.00336934im  -0.0398949-0.0262093im    -0.0815757+0.13285im     -0.00619242-0.00829989im    -0.236528+0.107307im      0.0558535-0.144125im     0.00703366-0.0258493im   -0.0618842+0.163236im     -0.107736-0.215276im     -0.0787537-0.037561im       0.125606+0.0478608im      0.103065-0.160775im     -0.0509554+0.250753im     -0.226543+0.187381im   0.00397754-0.0495182im     0.0507793-0.208761im       0.0769838-0.102626im      0.0836008+0.260608im     -0.0354987+0.318765im
  0.0632153-0.0121067im       0.138415-0.0129163im    -0.218137-0.136979im    -0.111794+0.048776im     0.0578473+0.158374im     0.0854778+0.0893532im     0.0673153-0.205412im       0.139933+0.152389im      0.0923083-0.235647im    -0.00879869+0.0746355im       0.213698+0.132406im      0.0566714+0.203564im     -0.0907513-0.00212057im   -0.0804675-0.0406758im    -0.198544+0.138778im      -0.103033+0.159106im     0.00649331+0.177125im      -0.147726-0.173102im     -0.0453464-0.0762199im      -0.15944+0.031009im     -0.268162+0.097426im     0.0252484+0.0580931im     0.0311343-0.0803117im     0.0469324-0.0499671im     -0.230339+0.00599149im    0.0797697+0.181916im     -0.126237+0.169333im   -0.0137949+0.0189382im      0.059132+0.191268im       -0.109526-0.0105651im     0.0228621-0.240716im      -0.095745+0.0319484im
   0.064684+0.203248im      -0.0194106+0.106846im     -0.104209-0.0261021im  -0.0514337+0.187628im      0.208254-0.219753im    0.00934147+0.103353im     -0.0631312-0.0605743im     0.0412529-0.0232792im      0.258331+0.1576im         0.115283-0.17009im        -0.020236-0.0228846im    -0.0310335-0.0607137im     -0.061281-0.0305144im    -0.0167809-0.0977689im   -0.0917112-0.125719im      0.0177702-0.0319116im     0.0846361+0.0122946im       0.14621+0.212887im     -0.0320936-0.00933313im    -0.224728+0.0424675im   -0.0776896+0.146057im     0.0639662-0.160049im       -0.06396-0.248555im      0.0251532-0.0487993im      0.136875+0.051553im      -0.225891+0.0951377im     0.257439-0.13432im      0.195029+0.100861im      0.0633278-0.0969289im      -0.128334+0.0654816im      0.179285-0.250926im     -0.0175848-0.0675985im
  -0.064319-0.0232451im      -0.392283-0.023231im     -0.201835+0.211702im    0.0250071+0.102132im    0.00807264+0.0210701im    -0.229539-0.118185im     -0.0729064-0.0100218im     -0.233722+0.17957im       0.0861955-0.223571im      0.0575237+0.149698im       0.0590227+0.144769im       0.138797+0.0150906im     -0.171792+0.0436611im     0.0537752+0.0173527im     0.163234-0.0575768im    -0.0664469-0.0707939im     -0.048409-0.096209im      0.0885581+0.0411427im     0.0584288-0.109902im     -0.0298038-0.0522706im    0.0627062+0.11304im       -0.01314+0.0434347im     0.0651334+0.0978745im     -0.175543-0.224795im       0.133629+0.0616591im    -0.0870767+0.137066im     -0.100148-0.0921655im  -0.0649888+0.250044im      -0.134305+0.116052im       -0.105249-0.127511im     -0.0222027-0.0557933im     0.0552707+0.175446im
   0.181417+0.235968im        0.023956+0.176976im    -0.0975202-0.0362332im  -0.0159909-0.104994im    -0.0369192+0.16639im       0.146784+0.0594511im    -0.0880515+0.0111851im     -0.261804-0.289487im      0.0514628-0.168832im     -0.0915573-0.0297569im     0.00375963-0.0398492im      0.224304-0.0514515im     0.0863686+0.172842im      -0.186778+0.109031im     0.0717951+0.00380038im  0.000681302+0.00311401im     0.058964+0.126533im      -0.146841+0.052491im      -0.111039-0.240546im      0.0532653-0.166256im      0.206222-0.0661783im    -0.141921-0.0220614im     0.0581166-0.06543im         0.04679+0.0981691im     0.0690824-0.048819im     -0.0212117-0.222969im    -0.0273948+0.0298895im    0.147131+0.126im         -0.118793+0.0566503im      0.0376962-0.211651im      0.0138405-0.19305im      -0.0766428-0.154708im
 -0.0837999-0.0582637im     -0.0830143-0.170239im    -0.0343396-0.105984im    -0.224563-0.102635im     0.0545788+0.0966841im    0.0950798+0.0445806im     0.0148076+0.150108im       0.245038+0.139036im    -0.00780127-0.265327im      0.0218138+0.124302im       0.0279419-0.0265832im    0.00923815-0.120738im       0.275195-0.00266436im    -0.085197+0.0834603im    0.0675922-0.0107446im     -0.241407-0.0599135im    0.00460596-0.113619im       0.207626-0.0247854im     0.0823505+0.148396im      0.0543368-0.118354im     0.0783504+0.00388545im   -0.107673-0.350991im      0.0322586-0.142283im     -0.0122001+0.0364065im    -0.0417793-0.042221im     -0.0922808-0.145319im    0.00386783+0.116601im   -0.0321009+0.138736im       -0.14364-0.161646im       0.0631768+0.253241im      0.0100876-0.194565im      0.0410462+0.0900546im
  -0.146751-0.0694104im     -0.0257579+0.0737113im   -0.0652079+0.0301057im    0.148492+0.120448im     0.0812865+0.218682im    -0.0764206-0.0471522im   -0.00980164-0.00750253im     0.254124-0.201344im       0.140278-0.190154im    0.000442173-0.213398im      0.00926761+0.117047im        -0.1295+0.0329224im     -0.132258-0.2074im      -0.00125341-0.0137175im     0.234831-0.0259794im    -0.0425165+0.0540664im      0.184561+0.0531654im     0.0754605-0.0209078im     -0.220795+0.0553481im      0.154832-0.112736im      0.150765+0.0336172im    0.0655837+0.0245285im     0.0720553+0.0720392im     0.0880234-0.102855im      0.0618092-0.206387im      -0.147344-0.0333829im   0.00983452+0.106964im   -0.0161458-0.11018im      -0.0527041+0.0819032im      -0.260807+0.173539im     -0.0176337+0.163132im       -0.19049-0.225404im
     0.0374+0.0580122im      0.0333547-0.11368im      -0.244018+0.10791im    -0.0179532+0.050823im   -0.00396193+0.246856im    -0.0726737+0.044695im     -0.0445323-0.0589113im     0.0782423-0.0568913im    -0.0926449+0.10967im      -0.0185826-0.0885921im      0.0398932-0.00248472im    -0.114219-0.148119im      0.0101167+0.250195im     0.00629317-0.246535im    -0.0326348+0.0628903im     -0.135999-0.105753im       0.150273-0.0164141im      0.164271+0.25514im        0.137422+0.0895133im     -0.094169+0.111057im    -0.0711025-0.067115im     -0.135904-0.0892706im     0.0856174-0.198265im     -0.0500934-0.158035im     0.00368935-0.218593im       0.108932-0.0731203im   -0.0628249-0.0860919im   -0.138399-0.162835im       0.015504+0.320368im        0.207541-0.152157im     -0.0546833+0.103346im       0.102929-0.10907im
  -0.142527+0.0318373im      -0.131177+0.0077733im    -0.155044+0.103487im     0.141296-0.0975053im    0.0838997-0.0845021im     0.341081+0.00743709im     0.062451-0.198971im     -0.0108937+0.193928im     0.00587177-0.156116im      -0.337654-0.101082im       0.0040071-0.0225118im     -0.192649+0.11147im      -0.0102225-0.00172376im     0.126071+0.0619611im   -0.0469905+0.163135im      0.0559881-0.0923596im    -0.0177498-0.0932153im     -0.152384-0.0441643im     0.0673643+0.061349im      -0.149983-0.00592198im  -0.0867556+0.0904839im   0.00312744-0.00354417im    0.0218741-0.0202852im      -0.12142+0.037377im      0.0842151-0.0883616im     -0.121661-0.322848im    -0.0290459-0.0202742im    0.310904-0.0208974im    -0.0594638-0.0205348im     -0.0235717-0.0273031im      0.123635+0.232693im       0.146594+0.0116699im
   0.101207-0.0124262im      0.0473651-0.023886im    0.00457494-0.0943729im  0.00660527-0.130154im      0.190766+0.101092im     -0.144624+0.150444im     -0.0874501-0.065475im      0.0769023+0.110247im       -0.21183-0.0435835im      0.134378-0.128553im       -0.170018-0.17077im      -0.0363238+0.259465im     -0.0240711+0.0475989im       0.11063-0.130551im     -0.134078+0.141689im       0.243528-0.00784915im    -0.210369+0.213139im      0.0943587-0.0554788im     -0.161733+0.0512616im     0.0538674+0.0565996im      0.16293-0.00700282im  -0.0686662-0.176995im      -0.077896+0.0742183im     -0.120978-0.0658568im    -0.0654978+0.107572im      -0.275449-0.184787im    -0.0369692-0.237473im    -0.126648+0.0838742im     -0.131786+0.101064im      -0.0683285-0.0730894im    -0.0777484-0.0247021im      -0.13304+0.068537im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.04810616041387562 + 0.140629721928466im
  0.007374269142813522 - 0.0005447698760569328im
   0.03993132348319381 - 0.3056489201765449im
  -0.09515467982573636 - 0.10567892062532698im
  -0.11141803844352542 + 0.04658613110306935im
   0.09368823167902478 - 0.08417442421023069im
  -0.19926872944914373 + 0.061454402794939786im
   0.12361357306960996 - 0.02305841681748056im
  -0.04935222414370857 - 0.10882194248114174im
 0.0012489156827031958 + 0.08303480789644953im
   0.01612816514183743 + 0.1794295441202713im
   -0.1227163644332199 - 0.005576853357268534im
   -0.0782096727010537 - 0.017951509231539344im
    0.1906078159581745 + 0.10338868255755782im
      0.20929694159754 - 0.03544934880962677im
   -0.2308681625605697 - 0.044160641028242284im
 -0.013586251039618944 + 0.00806511920123873im
    0.3449717694927627 + 0.0im
 -0.016108315714049193 - 0.07397795806774725im
  -0.19503193070030142 - 0.11762829039865286im
   0.04034953185434327 + 0.0011207535237957693im
    0.1287651901771414 - 0.02490891334605988im
   0.14573993184135914 - 0.02408167442048636im
  -0.10216669757309199 - 0.05416976501807814im
   -0.0588405129326586 + 0.08772539995414548im
  -0.22496907925689028 + 0.026046852024680323im
  -0.17206321181969209 - 0.22829242158356045im
   0.06801369651624171 + 0.06554116201006718im
   0.13923428893864823 + 0.18943936249965063im
  -0.24143392743655648 + 0.07907082345212134im
  -0.19002312170813615 + 0.059224726669878824im
  -0.08307693013123969 + 0.008414406498235591im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Tuesday 11 March 2025 02:17">Tuesday 11 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
