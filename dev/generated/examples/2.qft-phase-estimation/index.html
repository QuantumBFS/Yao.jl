<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   -0.218431-0.177594im     -0.118955-0.133448im       -0.14969+0.125196im     -0.0630903-0.0454156im       0.117994+0.0391016im   -0.0369054+0.0213122im    0.0122788+0.0474512im    -0.0614238-0.124217im       0.195608-0.0961im         0.143841+0.0979173im   -0.0771254+0.0734649im     -0.039768-0.10949im        -0.198752-0.104265im    -0.0206213-0.0578418im   0.000740557-0.00619663im  -0.00172455-0.132337im       0.0350976-0.0772853im     0.0753752+0.0746633im   -0.00579697-0.128385im     -0.0266923+0.325344im       0.135476-0.121761im    -0.0384127-0.151544im         0.14942+0.146295im    -0.230961-0.00593829im     0.150891-0.167391im      0.0690796+0.022463im      0.379088-0.00911779im   0.0375757+0.0188907im      0.211138-0.101737im      -0.105514-0.0942525im     0.151546+0.0742558im    -0.0699147+0.15874im
   0.0139413-0.137562im     0.0428089-0.11883im       0.0570675-0.0505037im    -0.0719385-0.0296437im       0.245539-0.0320803im     0.113232-0.0604896im     0.148121+0.184892im      -0.207762+0.0441261im      0.122577-0.0408026im     -0.088676+0.050736im     0.0702167+0.0553995im      0.143711-0.0732682im     -0.0510858-0.0938389im   -0.0354516+0.00370047im    0.0454826+0.282972im     -0.0718124-0.201612im      -0.0751603-0.0547572im    -0.0962021+0.128908im      -0.192025+0.00720463im    -0.062394-0.0573692im   -0.00219491-0.153806im      0.196169+0.147435im        0.173585-0.0195556im   -0.021659+0.00243232im    -0.163151+0.0860898im     -0.174306+0.140365im      0.041318+0.0321635im     0.109161+0.164324im      -0.225797-0.084798im       0.107312+0.0102111im    -0.347501+0.0857633im      0.232083+0.0347596im
    0.253538+0.106481im    -0.0318185-0.123589im    -0.00522549-0.191287im     -0.0274687+0.218425im       -0.300535+0.0311469im    -0.201063-0.118858im     0.0998389-0.00435871im    0.0712812-0.109275im     -0.0189018-0.0748709im   -0.00406377+0.0544812im    -0.123263-0.0788693im    -0.0538077+0.138467im       0.0776246+0.170641im      0.211711-0.242547im       0.272946+0.18844im      -0.0360901-0.0168014im     -0.0426811-0.0308317im    -0.0226421+0.0467284im     -0.175827-0.00858128im   -0.0237265-0.0868459im      0.051173-0.014095im     0.0279173-0.0731932im    -0.00761036+0.0484241im    0.104262+0.101573im        0.16565+0.0926751im    -0.0200218-0.0482887im     0.338181-0.130626im    -0.0753713+0.0656263im     0.0847045-0.115786im      -0.133766+0.0846872im    -0.170889-0.0854558im     0.0201003+0.0865893im
   0.0390163-0.0421212im  -0.00247003-0.142279im      0.0869878+0.0279995im     -0.122271-0.0786466im     -0.0665064+0.11377im     8.52539e-5-0.23302im    -0.00564378-0.151545im      0.0397899-0.0187564im      0.106647-0.0594022im       0.20887-0.107199im     -0.324214+0.033223im       -0.34999-0.0666696im      -0.083296-0.0827053im     0.136362+0.0455081im     0.0435954-0.0274275im     0.0644705-0.0728329im     -0.0850991-0.0169914im    -0.0468453+0.192737im    -0.00670243+0.144861im       -0.12294+0.0533458im     -0.162637+0.0884614im     -0.19715-0.0837566im      0.0327889-0.0335863im  -0.0654052+0.0779126im    -0.0212101+0.0132132im     -0.153843+0.0482896im     -0.26578+0.0582288im    0.0895942-0.0244338im     -0.206781-0.186142im       0.227873+0.0392439im   -0.0471405-0.0879989im     -0.231884+0.134813im
  -0.0239837+0.193482im     0.0552287-0.178882im      -0.149234+0.113752im      0.0925397-0.102138im      -0.0711236-0.0244096im   -0.0560675+0.163157im    -0.0136862-0.10935im       -0.244549-0.123714im       0.218051-0.159833im      0.0112465-0.0380908im     0.207417-0.104033im      -0.326733-0.00145461im     0.0741854+0.0734128im     0.067504-0.0740558im     -0.013303-0.0596031im     -0.153413-0.0101257im      0.0910857+0.113404im       -0.20764+0.140065im      0.0705627-0.0461718im     0.0514144+0.0362151im     0.0674444-0.0901886im     0.240809+0.183508im      -0.0535661+0.252176im     0.274445-0.0893701im    -0.0870666+0.00819107im     0.179794-0.128721im    -0.0631372-0.00156682im    0.134517+0.023824im      -0.106904-0.00628254im    0.0333381-0.0139001im    0.0038555+0.070944im      -0.139291+0.0316469im
  0.00332487+0.272681im     0.0221324+0.0677361im     0.0779332-0.100014im     -0.0525008-0.00953785im      0.109534+0.0474797im    -0.263411-0.0573598im    0.0905127+0.023129im      -0.178108+0.0177949im     -0.196224+0.199222im      0.0166398+0.0368071im    0.0497871-0.140008im      -0.151458-0.0225856im     -0.0329069-0.0377382im    -0.156857+0.00756114im   -0.0100036-0.13126im        0.127418-0.181164im       0.0897296+0.289844im       0.298971+0.0638805im     -0.125506-0.0020387im    0.00463677-0.0542579im   -0.00501855+0.0704981im     0.274592-0.0343532im      -0.156611+0.229776im    -0.192613+0.11983im      -0.0190729-0.0977288im     -0.156622+0.078748im     0.0168283+0.0302672im   -0.0612447-0.00643849im     0.113128-0.161878im        0.19542+0.064536im     0.0595395+0.0745865im     0.0614678+0.0232996im
    0.137571+0.128626im    -0.0212464-0.256742im      -0.175153-0.100971im      0.0195516-0.0297021im      0.0723424-0.152718im     -0.139591-0.0216222im    0.0250168-0.169057im       0.127308+0.0691818im      0.165238-0.22824im      -0.0915619-0.106901im      0.168701-0.0337076im    -0.0505055-0.11103im        0.0268889-0.0950233im    0.0357759+0.016417im      0.0381279-0.0474685im       0.30624-0.0395584im     -0.0112596+0.185011im      0.0387141-0.0797437im     -0.120031+0.0114103im     -0.131294-0.0301966im     0.0175382-0.0146846im    -0.253331+0.117438im        0.201489+0.0874139im   -0.188596-0.160272im     -0.0739771-0.13802im       -0.176217-0.0831233im    -0.013553-0.084708im     -0.170056-0.0736025im    -0.0969634+0.206843im      -0.122286-0.0489315im    0.0347761-0.0908742im      0.185968-0.150405im
  -0.0868451-0.156015im    -0.0906534+0.164033im      -0.234276+0.112663im       0.251905-0.15386im        -0.116407-0.10647im     0.00318796-0.322275im   -0.00713963+0.0288401im     0.0198791-0.102936im     -0.0274769+0.0225822im     -0.124012+0.148626im    -0.0631978-0.0907452im    -0.0424646+0.0616874im      0.0748687+0.0456873im     0.155675-0.0848671im    0.00148453+0.0802406im     -0.121088+0.0188626im      -0.160529-0.0862729im      0.193942-0.21274im       -0.225654+0.0629564im      0.168881-0.0598894im      0.305559+0.0534406im   -0.0344451-0.00892467im     0.0255193+0.283828im    -0.150759-0.0221702im     -0.152774+0.0292978im    -0.0160816+0.00261253im   -0.163754+0.0312875im     0.154797-0.0938025im     -0.107534+0.0654017im     0.0839551+0.0162327im    0.0545279-0.000814992im   0.0338107+0.056678im
  -0.0806457-0.060078im      0.135696+0.0843187im     -0.157985-0.187369im      0.0716592-0.0984061im   -0.000867727+0.0552633im    0.0700013+0.0907619im    0.0524351-0.102764im      0.0441894+0.0467672im     -0.115632-0.0481411im    -0.0174021-0.228962im     -0.248751+0.0122121im     -0.219561-0.0423857im       0.131576-0.0308072im       -0.122+0.112724im       0.110053-0.00956905im     0.041749+0.172581im       -0.059748-0.0217444im      -0.15113-0.00557413im    -0.034734+0.00614892im  0.000418728-0.0144306im      0.187668+0.137819im       0.30757+0.199585im       0.0341958-0.193467im    -0.213133-0.0220112im    -0.0335429+0.150906im    -0.00256683+0.020153im      0.181584-0.125897im     0.0127931+0.190095im     -0.0341016-0.0504521im     0.0307657-0.245984im      0.231993-0.163153im       0.126858+0.114707im
   -0.226493-0.166911im      0.207389-0.0143231im     0.0500242-0.0138378im     -0.156024+0.0206844im      -0.357128+0.125314im     -0.202824-0.0109542im    -0.141016-0.00699126im   -0.0581294+0.23608im        0.027311-0.265686im     -0.0329713+0.181895im     0.0898529+0.00575705im    0.0912593-0.074526im        0.145049+0.0384395im   -0.0222351+0.0128851im    -0.0536826+0.0279909im     0.0173283-0.248524im       0.0331403-0.112856im      0.0101717+0.0706236im    -0.0332425-0.0455667im    0.00714357+0.0639056im    -0.0390296+0.0858276im    0.0228778-0.100758im       -0.134444+0.0848707im   0.0865263-0.130352im     -0.0059778+0.00119043im    0.0159487+0.221668im     -0.180354-0.0077353im    -0.124293+0.144119im     -0.0879719-0.0934736im    -0.0932108+0.00111335im    0.234272-0.146775im       0.233691+0.0143223im
   0.0176333+0.0395381im   -0.0203153+0.251259im      -0.122477+0.0606021im     -0.196311-0.0279805im      0.0968914-0.0347013im    0.0528183-0.123279im     0.0465986-0.0589641im    -0.0666304-0.0295228im      0.130367-0.0538915im    -0.0136518-0.0367258im  0.000975908-0.0745785im      0.174371-0.0920526im      -0.161782-0.00869614im   0.0832483-0.0616333im    0.00662302-0.242922im      -0.405799-0.0312893im       0.199864+0.156584im       0.028103+0.0711168im    -0.0497102+0.033347im      -0.126592-0.128711im      0.0596272+0.0123621im   -0.0679429+0.00811751im     -0.128435-0.0395368im    -0.20533-0.139807im        0.19181+0.154594im       0.135566-0.173337im    -0.0500678-0.0478552im    -0.288349+0.178933im      -0.148059+0.00137381im     0.011137+0.0261738im    -0.101243-0.193211im      0.0152839+0.123391im
  -0.0705419-0.0379576im     0.129517+0.00324987im     0.214409-0.0861801im      0.198431-0.244829im      -0.0675735+0.110595im      0.196772-0.132393im     0.0192339-0.0634316im     0.0826787-0.0771892im     0.0359154-0.0723408im      -0.03959-0.159745im     0.0495723-0.196275im     -0.0785772+0.0237434im      0.0112415-0.0970803im    -0.163524+0.0203372im     -0.127041-0.141165im      0.0806436-0.207866im        0.139599-0.0849695im     0.0483938+0.107574im      -0.230408+0.355059im       0.116788-0.0177116im    -0.0143038+0.0784447im    -0.133948+0.000315788im    0.0408926+0.0155293im    0.136251+0.160379im       0.137353+0.0143161im      0.219864-0.115083im      0.126487+0.0853254im   -0.0341567+0.0346532im     0.0824444+0.0424554im     -0.147364-0.0727162im    -0.141001+0.167223im       0.185829+0.0390919im
    0.126399-0.113045im    -0.0241814-0.162767im       0.126404-0.0977079im     0.0444252-0.130645im      0.00814321-0.0673567im    -0.140415-0.0907043im   -0.0963162+0.234247im     -0.0246858+0.128906im      -0.184074+0.0172267im     -0.236741-0.127766im     0.0525568-0.191802im      -0.041396-0.14754im        -0.202032-0.0192806im   -0.0400909+0.0507516im     0.0688046-0.211159im      -0.132383-0.00689472im       -0.2241-0.0756772im     -0.233297-0.0843851im     0.0761131-0.239126im      -0.143942+0.0101705im     0.0393156+0.0527556im    0.0376251-0.0336279im       0.183419+0.115001im    0.0531939+0.161599im       0.199036-0.0928774im      0.198679+0.0702186im    -0.151718-0.16898im     -0.0323269-0.135066im      0.0618104+0.0575592im     0.0931547+0.00313816im  -0.0368275-0.0768659im      0.053028+0.174486im
   0.0284712+0.0321826im    0.0416036+0.198392im        -0.1327-0.131189im      0.0620476+0.154791im       0.0245261+0.279039im    -0.0561194+0.108149im     -0.145844+0.0377088im    -0.0868436+0.0431685im      0.177667+0.0310475im     -0.127117-0.0649024im   -0.0117627-0.118244im      -0.110725-0.00820636im     -0.267036+0.386927im    -0.0149419+0.113672im      -0.146109+0.110683im       0.206602-0.0425225im     -0.0514745-0.0267371im    -0.0688635+0.0428906im    -0.0411331+0.147474im     -0.0596452-0.0554497im    -0.0245366-0.217545im     -0.056979-0.00836524im    0.00559496-0.0316071im    -0.22351-0.164141im      0.0823378+0.199918im        0.14892+0.129904im    -0.0216875-0.035495im      0.149293-0.1717im         0.019835+0.0718879im     -0.007972+0.229169im     0.0196078+0.0641275im     0.0399681+0.0684964im
   0.0944594+0.30786im     0.00694965-0.102524im      0.0231495+0.116965im       0.186687-0.158492im       0.0190377-0.0549746im    0.0596792-0.0917222im     0.263455-0.0973055im     0.0956922-0.0159027im    -0.0238844-0.0609936im    -0.0373519+0.0625166im    -0.255103+0.105832im        0.14455-0.0605446im     -0.0234037+0.20375im     0.00833743-0.0461149im    -0.0809094-0.298559im      0.0963732-0.125582im       -0.100425-0.0738333im      0.152799-0.125366im      0.0830156-0.0919066im    -0.0850027+0.0912404im    -0.0693258-0.129844im      0.108739+0.0198089im      0.0672542-0.088799im     0.158344-0.176484im     -0.0397041+0.0247965im     0.0799232+0.212277im     0.0481364+0.173072im     0.0915887+0.228326im      0.0076444+0.0786471im   -0.00847641+0.199582im      0.045295-0.101476im      0.0835557+0.180448im
  -0.0671642-0.0384965im    0.0872091-0.0746971im     -0.189086+0.24103im      -0.0838185+0.0691917im       0.152616+0.00445517im   0.0612809-0.0902922im    -0.268105+0.0710329im      0.113211-0.0140105im     0.0727427+0.173223im      -0.102253-0.0688212im    -0.134711-0.165251im     -0.0802222-0.191056im      -0.0856062+0.0350345im    -0.135844-0.436456im     -0.0608581+0.0403028im    -0.0442134+0.0169082im      0.0480274+0.0674216im     0.0734363-0.0358328im     -0.145826+0.0212112im    -0.0561998-0.107104im       -0.25069+0.168971im     0.0894756+0.0535906im     -0.0135428-0.0999971im    0.257566-0.0621928im    -0.0295858-0.0617749im    -0.0416522+0.101713im      0.155242-0.00263401im   0.0895599-0.187064im     -0.0257679-0.0422629im    -0.0411751-0.0562177im    0.0792379-0.198549im       0.098838-0.0826944im
  -0.0445913+0.0076445im    0.0148383-0.136545im       0.147796-0.010852im       0.155697-0.0161828im       -0.16721-0.0659797im    -0.118448+0.269259im     0.0360744-0.0453217im     -0.164749-0.157391im      0.0372141+0.0914112im     -0.121897+0.0538865im   -0.0338312-0.12278im        0.227463-0.0906597im     -0.0106675-0.151649im     0.0953577+0.0251566im    -0.0919127-0.0120968im    -0.0416054+0.0918104im      -0.048685-0.0947963im      0.260407+0.166409im    -0.00420436+0.0723676im     -0.271551+0.24753im      0.00579658+0.0549606im   -0.0377671+0.118467im      -0.0835151-0.105163im    -0.068418+0.162772im      -0.153303+0.233049im      0.0286162-0.178533im     0.0925126-0.0434272im    0.0736989-0.284398im      -0.138795-0.0486555im      0.040621+0.0757989im    0.0754878-0.194872im      0.0876243+0.0272732im
   -0.113769+0.0971325im    0.0057955-0.24024im      0.00378227+0.0651012im     0.0543862+0.227661im       0.0110746+0.121914im     0.0589614-0.0324459im  -0.00360321-0.190587im      -0.298268+0.0484167im    0.00150172+0.154406im      -0.125989-0.021158im      -0.25109+0.220373im    -0.00458351-0.0902446im        0.07542-0.126376im     0.0864825+0.0561978im    -0.0377316+0.14448im       -0.153573-0.0381435im      0.0803543+0.0616224im    0.00104869-0.0443277im      -0.19735-0.0777336im    -0.0276078-0.139645im      -0.074511+0.124273im    -0.0712534+0.0426512im      0.0909945+0.0115015im  -0.0122359+0.0466203im    -0.0811457+0.0920108im      0.104479-0.0015915im    -0.211992-0.119256im     -0.101899+0.0439846im      0.346776+0.255173im      -0.112542+0.0232058im     0.070647+0.171681im      0.0218075+0.164434im
   0.0020579-0.0374878im   -0.0909862+0.0962007im      0.148761+0.0789888im       0.10228+0.153367im         0.17495+0.193264im     -0.143708-0.124464im     0.0352197+0.0690553im     -0.090863+0.171792im      0.0982702+0.00684452im   -0.0435016-0.0946756im    0.0188881-0.0855263im   -0.00774759+0.00244582im      0.236075-0.0926115im     0.307771+0.111902im      -0.184147-0.173464im     -0.0922292-0.0307334im      -0.127407+0.00902915im    -0.197369-0.181882im      -0.203945+0.172843im      -0.030176+0.203903im     -0.0234326-0.00624138im    0.226066-0.0350429im     -0.0808803-0.117158im    0.0239113-0.0138552im     0.0340194-0.174932im      -0.159877+0.00339993im    0.181184+0.0306519im   -0.0762629-0.0603682im     -0.157174+0.103218im      -0.194884+0.0763794im    0.0748837+0.00172831im    -0.189165-0.0119721im
    0.128996+0.111312im      0.195011+0.0923866im     -0.182664-0.179306im      0.0855317+0.0023319im      -0.151639+0.00931365im   0.0946413-0.188576im    -0.0397565+0.0993837im    -0.0322145+0.145279im         -0.143+0.00265676im     0.259246+0.0828552im    0.0114734+0.126122im      -0.127498+0.029134im      -0.0706164-0.209591im    -0.0599849-0.156247im      -0.072383+0.126077im     -0.0226011-0.0771308im       0.141643-0.0997503im     0.0617079-0.0269854im    -0.0164431-0.0732073im     -0.234241+0.0880892im      0.103708-0.199042im      0.104326+0.0493134im     -0.0461922-0.247752im   -0.0224875-4.5054e-5im     -0.174896-0.27651im        0.247809-0.0501887im   -0.0377832-0.0221676im    -0.145908-0.2214im        -0.130761+0.0781226im    -0.0489854+0.067601im    -0.0395452+0.0760489im    -0.0259647+0.0791391im
   -0.214992-0.0398694im   -0.0782344+0.020953im     -0.0754779+0.0937884im      0.125805-0.120095im      -0.0652802-0.0347657im   -0.0434079-0.0852572im    0.0841114-0.0448284im     -0.186179+0.440182im      -0.224924+0.179666im     -0.0597152+0.0180343im  0.000628247+0.02203im      -0.0468904+0.131308im      -0.0514471+0.0656025im     0.133687-0.0821357im     -0.086296-0.0332531im       0.16549-0.0436856im      0.0206148-0.04237im      -0.0594926-5.57832e-5im     0.113565+0.00537377im    -0.166174-0.0110381im     -0.177426+0.0537115im    -0.206585+0.134159im      -0.0433093+0.159128im   -0.0451754-0.136395im      -0.093895+0.0884814im      0.112652-0.0507344im     0.256918-0.140541im    0.00929968+0.118301im    -0.00428523-0.128521im    -0.00190998-0.178101im     -0.258975-0.0427283im     -0.141261-0.120374im
   0.0839181+0.0727125im    -0.225766+0.0460206im     -0.256304-0.0136102im     -0.207717-0.0712279im     -0.0432833+0.00681459im   0.0360347-0.0417018im     0.213756+0.0342583im     -0.216243+0.16564im     -0.00308466+0.0399214im     0.0625086-0.154786im      0.107878-0.0863038im      0.181567-0.15896im         0.198683+0.135344im     -0.234493-0.0227432im     0.0293461+0.175336im      0.0711214-0.0506954im     -0.0148259+0.0108494im    -0.0679208+0.101024im      0.0917945+0.223241im     -0.0563617+0.0849853im      0.163448+0.206618im    -0.0834322-0.0790048im     -0.0314586-0.0173553im   0.0656274+0.173211im     -0.0266161-0.132747im     0.00708203-0.00756019im  -0.0575683+0.128455im      0.206318-0.00803889im     0.107724+0.159507im      -0.117619+0.0400225im     -0.01646-0.23428im       -0.102105+0.184845im
   0.0768487-0.066198im     0.0580561+0.025381im      0.0768804+0.0233397im    0.00200154+0.0436818im     -0.0224885-0.123916im    0.00734136-0.0475694im    -0.117788-0.161303im      -0.173923+0.133837im      0.0414831+0.213906im      -0.139291+0.11042im      -0.123422+0.0573789im    -0.0267767+0.0718578im      -0.068591-0.0472749im    -0.204598-0.0266532im      0.171025-0.0046251im     0.0768719-0.0612019im     -0.0404206+0.0048462im     -0.112028+0.183893im     -0.0711866-0.135747im       0.232032+0.0318036im     0.0769792+0.0297257im    -0.102302+0.0724102im       0.085678+0.0107975im  -0.0258693+0.122978im       0.110932-0.0750038im      0.116859-0.10769im       0.198122+0.173114im    -0.0391237+0.155834im      -0.313064+0.197468im      0.0678963+0.351311im      0.223389-0.0557438im    -0.0939909-0.204818im
  -0.0162315-0.011638im     0.0764739-0.107169im      -0.217863-0.00584996im    0.0913579+0.261423im       -0.303519-0.0760114im    0.0816192-0.016791im    -0.0144665+0.108433im     0.00996323+0.0884082im      0.113479-0.111086im       -0.15074-0.069709im     0.0577293+0.0748687im     0.0508006-0.000574297im   -0.0240318-0.163904im         -0.17-0.0335043im     -0.244445-0.0775451im    -0.0275505-0.0158107im      -0.320469+0.280067im      0.0789808-0.112813im       0.190687+0.103049im       0.115943-0.0863024im     -0.121819+0.0764546im     0.119411-0.118515im        0.173196-0.0625481im   -0.135811+0.0804133im     0.0052063+0.0697242im     0.0305995-0.150538im     0.0492844+0.150066im    -0.0391659+0.0853273im    -0.0309338-0.248246im    -0.00430998+0.0656312im   -0.0810444+0.103358im      -0.121674+0.0882922im
   0.0276145-0.060612im     0.0232945-0.238321im     -0.0288605-0.0509327im     0.0855919-0.305669im      -0.0411688-0.0481032im    -0.128295+0.10292im      -0.147475+0.181964im      -0.119524+0.166202im       0.200531+0.100652im       0.149766-0.0925779im    -0.111016-0.0919811im    -0.0552337-0.0424791im       0.143873+0.0937986im    0.0762641-0.0211065im     0.0661033-0.159582im      -0.127712+0.0906016im      0.0990199+0.0129071im     0.0948861+0.00785176im    0.0922495-0.175798im       0.224506-0.183im         0.0626738+0.031862im     -0.115852-0.0300771im      -0.180921-0.25074im     -0.228771+0.0374416im    -0.0776844-0.0132079im    -0.0884702+0.143872im     0.0287079+0.103646im     0.0473241-0.0181194im     0.0116247-0.0454801im     -0.260408+0.146062im     -0.186038+0.134685im      0.0717734-0.00584544im
    0.165457-0.155338im     0.0998066+0.0502219im    -0.0904533+0.0754602im      0.148301+0.0172969im      0.0627059-0.0743239im    0.0244749+0.0443325im     0.106047-0.0796534im     0.0145061+0.0645009im     -0.138834-0.0942269im      0.382258+0.0584447im   -0.0610983+0.171954im      0.0150643+0.0130654im      -0.184374+0.108972im    -0.0609538+0.119651im      -0.239169-0.0803286im     -0.148815-0.0386164im       -0.18482+0.0440099im    -0.0889512+0.255299im     -0.0480562-0.0303798im    -0.0620435-0.153605im      0.0585845+0.178236im     0.0558488+0.126678im       0.0108945+0.253875im     0.087489+0.0801526im     0.0542628+0.122985im      -0.189452+0.057532im     0.0465625+0.0280478im   -0.0733452-0.230382im      0.0498694+0.00454021im     -0.28501+0.0931291im    0.0282391-0.0386827im     0.0728583-0.10819im
   -0.111099+0.11516im       0.183064+0.10461im       -0.240011-0.0149311im   0.000657077-0.0282496im       0.127655-0.140726im     -0.213338-0.0391288im   -0.0186355+0.00901338im    -0.118609+0.0201256im     0.0382767-0.195081im       0.144435-0.0582804im   -0.0595819-0.177909im      0.0912096+0.278987im     -0.00756995-0.216072im    -0.0498731+0.113441im     -0.0817657+0.0582368im     0.0753512+0.0423402im    -0.00664443+0.023657im    -0.00695434-0.115872im      -0.235246-0.222558im       0.020151+0.216177im      0.0191005+0.186058im     -0.117623+0.00355181im     0.0401415-0.200374im      0.20083-0.0482476im      0.228811+0.179956im     -0.0110786+0.0356386im   -0.0635948-0.0262886im     0.144811+0.0193784im      0.145805-0.0387521im      0.155929+0.145829im     -0.145825+0.0116329im    -0.0427897-0.0731979im
  -0.0799542+0.0633293im    0.0775567+0.0867277im     0.0812429+0.0880422im     0.0216518-0.0732897im      -0.118356+0.141201im      0.143615+0.176784im      0.144657-0.346348im     -0.0663638-0.00568302im     0.217245-0.0250442im    -0.0922811-0.0241596im     0.108465-0.121924im     -0.0439448+0.263731im       -0.195988+0.00554958im   -0.012747-0.0944174im     0.0819252+0.0656951im     -0.159063-0.0257347im      -0.290633-0.136372im     -0.0115499-0.0695414im     0.0142113-0.103657im      -0.187068-0.125541im      0.0260681+0.194305im     0.0547693-0.0839214im     -0.0906738-0.100388im    -0.141782+0.010477im     -0.0160683-0.372342im     -0.0822398+0.111279im     0.0204721+0.0779819im   -0.0339203-0.0236112im      0.135755+0.0462755im     0.0848852-0.0204275im    -0.118396-0.0349854im     0.0669624-0.119511im
  -0.0776002+0.190597im     0.0629404-0.0235839im     -0.264667-0.132797im     -0.0265184-0.146355im      -0.0765694+0.108345im      0.012315-0.048054im    0.00572106-0.0834236im     0.0705043-0.0622663im    -0.0696087+0.00871871im    -0.270401+0.148999im       0.13165+0.183043im      0.0501949-0.0307579im      0.0554972+0.0143879im   -0.0980785+0.178116im      0.0478025-0.105378im      -0.188401+0.243005im        0.209795-0.201888im      -0.131278+0.0896429im     -0.118211+0.0505757im      0.131233+0.111745im      -0.248322+0.0690608im   -0.0208318+0.0254028im       0.136604+0.0863237im  -0.0635833+0.0216072im   -0.00738156-0.0480055im     -0.149462+0.238625im      0.137326+0.0849151im    -0.142955-0.237515im     -0.0244695-0.0824133im     0.0463443+0.101407im     -0.129418-0.0231673im     -0.130408+0.0850018im
    0.215092-0.19458im    -0.00602915-0.0603068im     0.0817033-0.00441404im    0.0221712-0.0520636im      0.0415107+0.114826im    -0.0930437-0.117123im      0.203611-0.0750737im     0.0175383+0.0513683im      0.128634-0.0337399im    -0.0555097+0.105302im    -0.0116098-0.104434im      0.0374759+0.131556im      -0.0594572-0.142946im     -0.115784+0.108512im     -0.0163433+0.19156im      -0.0319395+0.238345im    -0.000777921+0.16768im         0.23409-0.0147889im    -0.0170855-0.00155642im     0.137193+0.00181894im    -0.214761-0.15779im      0.0410058+0.333717im      -0.0885805+0.0481276im   -0.047136+0.00807736im     0.129623-0.120728im       0.257755+0.203712im     -0.126808-0.0291126im    0.0826331+0.0365576im     0.0241023-0.0899477im     -0.226828-0.1171im       0.0414024-0.207733im      -0.165349+0.0145681im
 -0.00504963-0.182797im      0.213138-0.153877im      0.0435183-0.034147im     -0.0962391-0.0276664im       0.265512-0.018145im    -0.0472205+0.163127im      0.138767-0.188237im    -1.36087e-5+0.0685775im     -0.205523-0.0719638im     -0.175686+0.19176im       0.215901+0.027901im      -0.208574-0.0681642im      0.0316425+0.113863im     -0.138536-0.153207im     -0.0385551-0.0346609im   -0.00633024-0.0843494im     -0.0719905-0.11116im        0.145565-0.149777im      -0.146933-0.00526604im   -0.0220131-0.130573im       0.195242-0.0714435im    -0.120151-0.0823069im     -0.0619793-0.207187im    0.0554924-0.0157618im     0.0352746+0.17271im      -0.0822405-0.102867im    -0.0282266+0.0486615im    -0.027283-0.0420999im    -0.0269031-0.0719811im    -0.0943906+0.00920492im    0.010599-0.000288537im   -0.358337+0.189416im
    -0.10889+0.125346im     -0.324476+0.0291152im     -0.071781-0.0407894im      0.261662+0.00542423im     0.0973895-0.044149im     -0.269895-0.0552821im    -0.166569-0.237376im      0.0550532-0.0251549im     0.0435119-0.067702im    -0.00141209-0.104721im     -0.126167-0.0592529im      0.139516-0.154228im        0.100675+0.00309133im   -0.204678+0.0142276im     -0.179773+0.166894im      0.0114862-0.0656121im     -0.0913139-0.245998im    -0.00668744+0.173285im     -0.0169979-0.159419im      0.0137425-0.211509im    -0.00342909-0.22941im      0.0941224-0.108031im      -0.0875212-0.0505654im   0.0330919+0.119931im      0.0669561-0.00267436im    0.0302963-0.0131261im    -0.060283+0.0889433im    -0.212161+0.0120359im    -0.0772821-0.0600395im     0.0438307-0.214161im    -0.0924825-0.0179632im     -0.125041-0.0796639im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   0.05442485073626194 - 0.10393247514790835im
   0.05270413045239712 + 0.08925439586514435im
  -0.05634147687507948 - 0.3139600756581044im
    0.1118828464195113 + 0.2103136688632653im
   0.08961585845080652 + 0.11623867874504133im
    0.0575799449334072 + 0.17112601616578454im
   -0.2843573354336595 - 0.09281196519742438im
  0.049692102797481284 + 0.14683253416111489im
   -0.0690089808978045 - 0.11528301857429615im
  -0.08377802252983858 - 0.1067331970980637im
  -0.08492329927627121 + 0.11089388906225325im
  -0.18000875040083816 + 0.10683357408028019im
   0.07707254722870949 + 0.07042353432903907im
  -0.23850864069549393 - 0.0859207772268087im
  -0.20132810160339593 + 0.01771566728839348im
  -0.22622263818308763 + 0.23561496210788965im
   -0.0061213487082281 - 0.06102440558148384im
   0.06239944135302751 - 0.07403658480377633im
  0.054531171221423536 - 0.10471790739615754im
    0.0374132151551691 + 0.011936181644175294im
  -0.05996854008512498 + 0.016444156196258625im
 -0.045708115867125164 - 0.15688752404650147im
  -0.11362653137277207 + 0.06607379659863992im
  -0.07726567234405941 + 0.05135590512064967im
   0.12335936049511156 + 0.06551451082878929im
   -0.0460491392952602 - 0.06495654669596994im
  -0.13090498687663907 + 0.07102994256543936im
   0.01960757432704309 - 0.05768402244198175im
   -0.0748305133812836 + 0.05303015579045298im
    0.3375869463004878 + 0.0im
  -0.17040792543756292 - 0.03673946617313238im
  -0.08201295252588207 + 0.1747882904651081im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 11:12">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
