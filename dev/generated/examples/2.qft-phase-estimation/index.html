<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
    0.246399+0.115208im       0.0861315-0.143743im      -0.198112+0.136464im      0.0676113-0.0440561im   0.00983366-0.022845im       -0.0856452+0.363304im     -0.0386727-0.0284968im    -0.0449702-0.0235183im   -0.0869103-0.0397107im     0.0434723+0.0664853im     -0.124813+0.210515im      -0.0278408+0.0402997im        0.234717-0.0639829im      0.161881-0.015782im     -0.114625-0.14776im      -0.0353109+0.154731im       0.0146657-0.031926im      -0.102381-0.0918771im      0.233505+0.0350168im     -0.176102+0.0567858im     0.0377062-0.169042im    -0.0300664+0.348562im    -0.0758468-0.0166647im     -0.225628+0.0873245im    -0.0441154+0.218237im     0.0389638-0.0595369im    -0.165446+0.0116461im      0.152713-0.10042im     -0.0449934+0.0157762im     -0.0726893-0.0524538im    0.0729676+0.0690124im    0.00613757+0.0458347im
     0.16796-0.0610965im       0.123476+0.16497im     -0.00601311-0.0422473im    -0.0023416-0.0850796im     -0.19318+0.0253683im      -0.0375928+0.210454im    -0.00376374+0.0355531im    -0.0373398+0.113978im    -0.0422534-0.0941257im     -0.224495-0.0673913im      -0.10086-0.0662432im      0.0983835-0.248966im       -0.0438732+0.0702543im   -0.00615178+0.182882im     -0.112288-0.125177im       0.258248-0.081549im       -0.203199-0.0811951im    0.00733711+0.130874im      0.0496601-0.0228924im     -0.151974-0.204323im     -0.0507104+0.0384323im     0.074441-0.0567563im    -0.149172-0.182131im    -0.00203453+0.119221im     -0.0995078-0.201756im      -0.17335-0.196183im     0.0171555+0.0340969im     -0.185607-0.0580839im   -0.0833827-0.0327391im   -0.000526364+0.216728im     -0.253983+0.129422im      0.0838458+0.0797968im
   -0.148659+0.106148im      -0.0644724+0.0581801im       0.24327+0.078323im       0.146871-0.245547im     -0.138629+0.0117933im        0.212922+0.263887im     -0.0259914+0.0575505im   -0.00489541-0.0110281im   -0.0833667+0.0153164im      0.102374-0.127931im      0.0452629-0.0449734im      0.0971992-0.0463612im      -0.0952327+0.0297361im    -0.0266881-0.00447228im   0.0325743-0.0548712im     0.0360851+0.108762im        0.148414+0.0651243im      -0.18117-0.199183im       0.146558+0.112261im     -0.0737488+0.212265im     -0.0735675-0.123558im    -0.0638914-0.10077im      0.0799929+0.070165im        0.11489-0.119058im      -0.168977-0.241228im     0.0781235-0.0387043im    0.0829247-0.127486im       0.177619+0.23761im     -0.0993804+0.26946im       -0.0524406+0.0529975im   -0.0668787+0.180681im      -0.083678-0.0355198im
   -0.119084+0.0991857im       0.121995-0.081709im     -0.0357291+0.0280413im       0.14611+0.0780467im    -0.132363+0.0426292im      -0.0306435+0.217958im     -0.0775165-0.116055im      -0.115431-0.0384844im     0.144577-0.0491073im    -0.0891247-0.0448591im    0.00710907-0.207806im         0.13085+0.0740405im        0.282064+0.0509758im      0.102853+0.00372252im    0.225532+0.188891im      0.0364058-0.000538922im   -0.0720639+0.0238915im     -0.127577+0.169173im     -0.0574907-0.13933im       -0.107577+0.160773im     -0.0382275+0.142244im     0.0327876-0.0938574im    -0.142591+0.0194514im    -0.0538919-0.103967im     -0.0343362+0.043592im    -0.0808006-0.19531im       0.225437+0.260364im       0.102668+0.143748im      0.153638+0.0865013im       0.099781-0.0466031im     0.113398-0.327538im      0.0392191+0.0621532im
  -0.0411711+0.169088im      -0.0312233+0.0588672im     0.0865952-0.14781im      -0.0853417-0.0697271im    -0.182351+0.167883im        -0.120774-0.0113786im     -0.226754+0.0137001im      0.293591-0.125606im      0.224114-0.13371im        0.138643+0.0299386im      0.020981-0.116074im       -0.126666+0.0400986im      -0.0271384-0.188502im      0.0396068-0.0761467im   -0.0706592-0.124335im      -0.124904-0.105755im        -0.22956-0.0178971im    -0.0140893+0.156223im       0.129346-0.00514352im    -0.127279+0.0575825im      0.197929+0.224967im     0.0317844+0.0976812im     0.108955-0.0303738im     0.0666847+0.20649im        0.171007-0.00647896im   0.0937147+0.0754688im    0.0843849-0.055534im      0.0441968+0.0239783im   -0.0922496+0.17702im        -0.137695+0.206176im        0.1487+0.0246492im    -0.0560542+0.160017im
    0.109968+0.0394175im     -0.0830804-0.0470226im      0.121912-0.0619607im    -0.0900856+0.163182im     -0.125972+0.0994022im        0.256925-0.00307899im    0.0342044-0.389207im     -0.0716208+0.0480144im    0.0554961-0.233163im    -0.00144207+0.0868779im      0.116934-0.0454155im     -0.0246943+0.166195im       0.00112034+0.110519im      -0.247562+0.0461467im   -0.0581914+0.00218358im     0.121263-0.0386456im     -0.0335353+0.211296im   -0.000853082-0.104091im       0.200132+0.206724im      0.0381027-0.14361im        0.325335+0.0296094im     0.121758-0.0281094im    0.0138559+0.163503im      -0.129711-0.0316801im     0.0423435-0.0367509im   -0.0619309-0.0560742im    -0.134946+0.195983im       0.125273-0.0353591im   -0.0158086-0.0270277im         0.1439-0.0768224im   -0.0986002+0.0590315im     -0.118503+0.025893im
   -0.218482+0.244581im       0.0857028+0.0464688im     0.0483433+0.0607406im     0.0275629+0.035747im     -0.142279+0.065234im        0.0868086+0.0547387im     0.0598023+0.0814029im     -0.111274+0.289051im    0.00241954-0.0952305im     -0.146541-0.0269435im   -0.00817482-0.0179894im      -0.104012+0.083169im       -0.0602822-0.156738im     -0.0464365+0.17539im       0.175257-0.0771357im     -0.158425-0.0842796im       0.162799-0.0461627im     0.0406705-0.0226552im     -0.173234-0.0919546im      0.119544-0.0344104im      0.115018-0.205185im      0.168068+0.244478im      0.240908-0.0686859im     0.0832269-0.069827im     -0.0179103+0.13446im      -0.199874-0.0383416im    -0.171432+0.142273im      -0.121577+0.0968507im    -0.186287-0.00358247im   -0.00795114+0.156422im        0.1593+0.0185493im       0.18028+0.0245006im
 -0.00825948+0.194238im        0.104895+0.0615852im     0.0541992+0.167895im       0.069928-0.0201921im    0.0663814-0.000600553im     -0.114773-0.14059im       -0.235851+0.0953884im    0.00725011-0.0672694im    -0.132733+0.136069im      -0.128576+0.323116im      0.0596167-0.0223914im     -0.0197523-0.138358im       -0.0567612-0.0326774im     0.0338968-0.138521im      0.109748+0.0251123im      0.173136-0.0678938im     0.00720967+0.0212567im    -0.0235103-0.229829im     -0.0822271-0.00670776im   -0.0311485-0.0253625im     0.0407973+0.215779im      0.175701+0.0833429im    0.0684339+0.145483im     -0.0248855-0.109938im     -0.0102857-0.101376im      0.266523-0.148169im    -0.0291877+0.144953im      0.0981536-0.253037im     0.0136103+0.121627im        0.174576+0.003433im    -0.0614501+0.136001im       0.311164+0.0379198im
   0.0191999-0.19979im         0.153516-0.105532im     -0.0431503+0.0756041im      0.333335-0.0336627im    0.0740475+0.10573im        0.00261597-0.0818076im    -0.0572133-0.176289im     -0.0238131-0.0626657im    0.0909446+0.176055im      -0.110144-0.226535im       0.182583+0.066994im        -0.14452+0.115765im         0.132216-0.0404625im    -0.0895741-0.0324275im   -0.0482188-0.303248im     -0.0687959-0.15461im       -0.0825549-0.390684im      0.0758276+0.0921496im        0.0397-0.00112144im     0.111894-0.0179667im      0.160834-0.119729im    -0.0825548-0.0816734im    -0.051251+0.0957145im     0.0984195+0.00469741im    -0.010582-0.205482im    0.00753621-0.0780781im   -0.0989124-0.0641076im      0.139693-0.0233733im   -0.0683541+0.126776im          0.1319-0.00259519im   0.0261646-0.0483438im      0.147536-0.091449im
   0.0540371-0.0399724im      -0.101646-0.0215275im    -0.0494322+0.0101189im      -0.16471+0.0589449im    0.0653499+0.0506819im        0.137384-0.063im         -0.127687+0.167022im        -0.1482+0.0706257im   -0.0570145-0.211616im       0.113436+0.101341im     0.00763758-0.146785im       -0.191184+0.0877731im        0.393574+0.10476im        -0.17402-0.0664512im    0.0944271-0.161462im        0.10138+0.00512648im     0.0165576-0.115423im        0.22857-0.130099im      0.0409037+0.0252593im    -0.0532475+0.182042im      -0.202728+0.100161im     -0.173929+0.00671358im  -0.0427966-0.219826im       0.053885-0.1612im        0.0800672-0.0858484im    0.0391727+0.0215373im   -0.0706505+0.160772im      -0.154152-0.0764im       -0.108233+0.18675im        -0.123983+0.121617im    -0.0475619-0.0342323im    -0.0458498-0.16667im
   -0.079444+0.126137im      -0.0242278-0.145736im       0.136371+0.0991748im     0.0899638+0.320271im    -0.0353351-0.0124055im        0.131787-0.00122841im    -0.107992+0.0782152im      0.288242+0.0340569im    0.0700197-0.114295im       0.098366+0.0243686im     0.0397831-0.0268942im       0.108358-0.274857im       -0.0148326+0.0800494im      0.128908+0.182113im     -0.068434-0.274679im     -0.0197431+0.230266im      -0.0413242+0.0663491im     0.0216366-0.0490989im     0.0313749-0.216863im       0.170652-0.00931152im    0.0268023+0.0761323im    -0.149233-0.117166im     -0.148772+0.0675043im      0.144837+0.0727456im    -0.0107186+0.0312661im    0.0672773-0.206589im     -0.278924+0.00387544im    -0.128359+0.0401332im    0.0955943-0.0704476im     -0.0479466-0.166923im     0.0900072-0.0195578im     0.0477889-0.0857932im
   -0.050652+0.190509im        0.102154-0.105646im      -0.039637+0.0208232im     0.0714695+0.00107605im    0.180342-0.071763im       -0.0988715+0.0239407im    -0.0822772-0.164621im       0.173504+0.148014im      -0.17524-0.162328im     0.00282644-0.0263106im      0.401823+0.137706im      -0.0721877+0.16477im        -0.0832405+0.0436727im    -0.0650249+0.0379257im   -0.0769615-0.0292433im       0.22042-0.0509278im      0.0540968+0.163944im      0.0824217+0.239816im       -0.13352+0.00870519im   -0.0848638+0.170389im     -0.0845903+0.0457847im   -0.0179843+0.144339im     0.0174489-0.107914im      -0.143648-0.0879369im     -0.030113-0.25179im     -0.0690046-0.0759703im    0.0861226-0.159425im     -0.0352599+0.0245793im     0.196568-0.15527im        -0.153801+0.0382229im     0.145497+0.120395im     0.00384587-0.0590552im
   0.0573482-0.199634im       0.0872603-0.191566im      -0.132362-0.0537182im    -0.0788465-0.122757im      -0.14957-0.0820847im       0.0512138-0.180353im     -0.0217253+0.0408783im      0.227102-0.132967im      0.186324+0.0729179im      0.133807-0.0517452im   0.000644708+0.2407im         0.0993075+0.0929215im        0.079766+0.125668im      0.0331942+0.205282im      0.146053-0.0116547im    -0.0710787+0.0863424im      0.0141167+0.185343im       0.120975-0.116886im      -0.074682+0.232677im       0.136322+0.00797441im   -0.0948451-0.0244149im  -0.00546557+0.0797604im    0.0831274+0.092279im     -0.0239354+0.00493699im   -0.0495475-0.0259856im    -0.177441-0.200944im     0.0780158+0.143968im      0.0168017-0.00468514im     0.11645+0.160955im       -0.175712+0.202959im     -0.113794+0.0346542im      0.251644+0.185572im
  -0.0502284+1.58897e-5im       0.14789-0.322592im       0.339092-0.0548708im     -0.105481-0.017207im      0.269176-0.106449im        0.0976986+0.0352348im      0.139207+0.156366im     0.00709297-0.0390716im    0.0865243+0.0881061im     0.0461906-0.0768591im     0.0229325-0.0145152im    -0.00185575+0.0799847im      -0.0459292-0.132619im      0.0322643+0.144326im     0.0729162-0.0498243im      0.140111-0.0633848im      0.0728301+0.0336045im     0.0102096-0.0230397im      0.210762-0.00334431im    -0.201121-0.148368im      0.0501612+0.0876101im    -0.128412+0.116264im    -0.0925291-0.209329im       0.186195-0.113492im      0.0262794-0.0771323im   -0.0089263+0.100354im      0.100752+0.0861456im      0.103392-0.0936241im    -0.175485-0.172753im       0.0543343-0.12468im     -0.0047802-0.114703im       0.123388+0.288531im
   0.0139094-0.0584252im    -0.00757593-0.150255im       0.175032-0.0536521im      0.105135-0.0576504im   -0.0881678+0.173119im         -0.24199-0.0906749im    -0.0829842+0.0769881im    -0.0756951-0.0337848im   -0.0529265+0.124291im      0.0308069-0.0813712im     0.0186158-0.0417193im      -0.129662-0.107954im       -0.0218168-0.131368im     -0.0644895+0.110784im      0.109548-0.0215239im     -0.057847+0.195414im        0.152255+0.0915778im      0.157401+0.40532im        0.189542+0.101682im      -0.029273+0.0712376im    -0.0491036-0.0134692im      0.26156+0.0224791im    -0.182286+0.112693im     -0.0981886-0.253613im      -0.045461+0.0979992im     0.103884+0.107492im     -0.192841+0.103427im      -0.183389+0.0650292im    0.0829547+0.0690902im      0.0114791-0.0341736im    -0.184028+0.111288im      -0.110049+0.042644im
   -0.055825-0.151455im      -0.0495828+0.273837im       0.280883-0.0906726im      -0.10011+0.131917im      -0.19434-0.0732926im       0.0849296+0.1057im        0.0486464-0.0800563im      0.108622-0.26247im     -0.0557833+0.0017824im    -0.0572038+0.124323im      -0.114735+0.0513731im      -0.131688+0.0149347im        0.234981-0.121747im     -0.0216311+0.13239im      0.0201432-0.0955147im    -0.0345766+0.048358im      0.00752781+0.0324864im      0.237612+0.118321im     -0.0755963+0.0286757im     0.0112769-0.10268im       -0.208515-0.17301im       0.125176+0.206613im     0.0659153-0.0275678im    -0.0294005+0.0233494im    -0.0679253-0.148363im      0.185571-0.133711im      0.206778-0.0918056im      0.100198-0.0236701im     0.015891-0.099655im        0.119469-0.196639im      0.156668-0.0222412im      0.047338-0.128329im
   0.0909537-0.188131im      -0.0112806+0.0219909im    -0.0950594-0.0594047im     0.0338686-0.0280672im    -0.232965+0.0726812im    -0.000955704+0.0141779im    -0.0583341+0.0575472im      0.108165+0.168218im     -0.011769+0.162124im       -0.30753-0.0868438im    -0.0988916-0.118911im       -0.255962+0.200681im        -0.156783-0.0175783im      0.196463-0.100165im      0.222489-0.0905517im    -0.0787529-0.00222162im   0.000916109+0.302242im      -0.172954-0.150774im       0.178685-0.0364154im     0.0365579+0.0267688im    -0.0193775+0.0376919im   -0.0553593+0.0238895im   -0.0783808-0.0966653im     0.0409791-0.0425241im     0.0987954-0.232924im     0.0503972+0.0335411im   -0.0909847+0.0770229im     0.0677088-0.10567im       0.128862-0.224196im       -0.159193-0.0210854im    0.0519906-0.0680011im    -0.0247202-0.192697im
  -0.0909398+0.010935im       -0.152592+0.250483im     -0.0133428+0.0444147im     0.0567861-0.156624im    -0.0185105+0.142465im       -0.0632694-0.0176021im       0.15011+0.00359879im    -0.180614-0.053235im     -0.202341+0.0700556im      0.125271+0.155812im       0.185384+0.189925im        0.131295-0.093913im        -0.143644+0.100106im      0.0437891+0.134654im     0.0994682-0.197779im      0.0728782-0.17979im        -0.284307+0.177088im      0.0523936+0.104184im       0.195965+0.101421im       0.171653+0.0860191im     0.0378977-0.0593154im    -0.169543-0.00190702im   -0.123045-0.00146224im   -0.0234015-0.0501442im    -0.0463323+0.1257im       0.0668319+0.0616657im    0.0577525+0.17378im     -0.00447686-0.0457088im    -0.127451-0.020551im       -0.108567+0.0217589im      0.20187-0.258367im       0.107049-0.00745235im
  -0.0348499+0.0923505im      0.0988152-0.106424im       0.184793-0.0171527im    -0.0426597+0.0426772im     0.218196-0.200778im        -0.112414-0.167694im     -0.0190429-0.223205im      -0.138674-0.00198107im   0.0661357-0.0709395im     -0.100291-0.0729509im     -0.294443+0.18731im        0.0197352-0.202861im        0.0249217+0.0281209im      0.189338-0.104234im     0.0320579-0.0916965im   0.000835118-0.110631im      -0.0303145+0.0476351im     0.0617147-0.0117683im      0.112597+0.0981421im      0.062024+0.304466im    -0.00809107-0.0648226im     0.158126-0.0105891im     0.173008-0.0317465im     0.0978995+0.235157im      -0.157302-0.186482im     0.0468267-0.00325617im   -0.040492+0.239275im     -0.0273387+0.0431516im    0.0235296-0.0665848im     0.00539531+0.16982im      0.0147705-0.0835929im     -0.227596-0.088263im
   -0.224333+0.244535im        0.108232-0.103982im     -0.0994016-0.119106im      0.0395846-0.011828im     -0.237994-0.0789439im        0.147468+0.0120893im    -0.0313771+0.0982868im    -0.0961739+0.0680115im   0.00994819+0.188027im       0.309188+0.00874504im   -0.0602879+0.073135im      -0.0562858+0.0502045im        0.173356+0.0637386im    -0.0188633+0.0888709im    -0.142519+0.123831im      0.0375707+0.125304im       -0.158237-0.0557604im    0.00606706+0.0796417im    -0.0389245-0.0994397im     0.0387042-0.0474221im     0.0935646-0.108884im     0.0497505-0.130329im    -0.0524652+0.0109126im    -0.0540532+0.0339429im    -0.0413771-0.174335im      0.175465+0.300107im     0.0158164+0.116026im       0.133445-0.151087im     0.0550901-0.29519im         0.012542+0.229261im    -0.0876942+0.0785984im     0.0985916-0.144526im
  -0.0139253+0.0965011im       0.179388+0.168283im     -0.0380669+0.00053168im     0.158268-0.119313im      0.101908-0.168429im         0.190466-0.00672237im     0.187807+0.0368547im     0.0505541-0.0479054im    0.0473419-0.133432im      -0.131485+0.0686393im      0.142036-0.0650757im    -0.00202326-0.00701474im        0.13726+0.00234529im     0.228481-0.112275im      0.166765+0.151406im     -0.0681252+0.191845im      0.00291767-0.0925826im      0.139035+0.00307994im     0.189291+0.0842448im      0.203493-0.111019im       0.246958-0.050584im     0.0936853-0.0215174im     -0.18434-0.0114964im     0.0667232-0.0193481im   -0.00377148-0.0685544im   -0.0309626+0.0663129im     0.185095-0.00939594im    -0.252225-0.224067im     0.0672401+0.129682im        -0.15224-0.0481296im     0.145919+0.204586im      -0.148599+0.0612267im
      -0.111+0.00185716im     0.0183194-0.209138im      -0.145383+0.0359496im    -0.0447248+0.0657203im    0.0481522+0.0655221im       0.0352629+0.0185434im    0.00461384+0.0384965im     -0.008569+0.00907578im  -0.0725395+0.175071im      -0.306535-0.148731im      -0.137599-0.0573333im   -0.000303966-0.164244im         0.221433+0.0559428im     -0.208688+0.0201532im    -0.289809-0.0830846im      0.119796+0.075052im      -0.0486589+0.228861im     -0.0918122+0.000465152im  -0.0365312+0.178486im       0.134622-0.0181517im      0.111615+0.0672834im     0.219562-0.12816im       0.138879-0.0789607im    -0.0455837-0.0695079im     0.0512937+0.0396625im      0.14619+0.0709107im     0.172514-0.103924im     -0.0760365+0.0415955im    -0.176813+0.101641im        -0.26573-0.128569im      0.213663-0.048746im      0.0953102+0.0584248im
    0.129162+0.00903411im     0.0537329+0.0845465im     -0.056601-0.234633im       -0.15065+0.0508945im     0.119979-0.152216im       0.00589601+0.0195961im     -0.132577-0.0795668im    -0.0559293+0.0293989im   -0.0802859+0.215388im      -0.138251+0.116731im      0.0361008-0.0597893im       0.190458+0.0966015im        0.018113-0.155635im     -0.0132462+0.129992im    -0.0128454-0.0562541im     0.0560443+0.249872im      0.00769413-0.0412807im    -0.0629099+0.141809im      0.0404674+0.151559im     -0.0823857+0.103801im       0.118061+0.0241724im    -0.142899+0.00448431im   0.0198819+0.218752im       0.368534-0.117027im       0.162318+0.194545im    -0.0226534-0.170929im      0.104065+0.0259149im     0.0167498+0.0705985im   -0.0796063-0.126448im       0.0181523+0.230722im     0.0526977+0.125236im   -0.000493651-0.267244im
  -0.0924097-0.0254711im     -0.0797988-0.0430704im     -0.181131-0.0816909im    -0.0959639-0.0539285im     0.119816-0.0204191im       -0.077525+0.0882936im      0.147091+0.189697im       0.153756+0.0649431im   -0.0593422-0.131588im      0.0273435+0.0415793im      0.120013-0.00167919im    -0.0764965+0.000585074im      0.202543+0.0746687im     0.0970817+0.201384im      0.170524-0.140043im       0.142674-0.257162im      -0.0711371-0.0246601im     -0.144761-0.0125861im    -0.0616536+0.000151421im  -0.0740926-0.0781648im   -0.00882759-0.138198im      0.370663-0.074481im     0.0259084+0.239208im       0.289848-0.0483007im     0.0102887+0.0554238im     0.100484-0.0337917im    -0.108909-0.126453im       0.180803-0.0749299im      0.11542+0.00713212im    -0.0565438-0.0084237im    -0.128518-0.107975im       -0.25792+0.0339874im
  -0.0406844-0.000147317im    -0.193574-0.0918962im     -0.126698+0.0577254im      0.150173-0.396646im    -0.0174129-0.043293im         0.119437-0.178904im      0.0674022-0.112609im     -0.0979556+0.0297779im    -0.141475-0.020219im      0.0448505+0.10109im      -0.0963694+0.00125643im     -0.160219+0.0278807im       0.0542284+0.197358im      0.0750871+0.270072im    -0.0383968-0.019684im      -0.159117+0.193544im      0.00566964-0.0278226im    -0.0437641+0.0204283im     0.0955525-0.088518im     -0.0691174+0.0755324im     0.0544526+0.293767im      0.100581+0.0834105im     0.140149-0.0847328im      0.054995+0.0516292im      0.152446-0.0806191im    0.0358423-0.203981im     0.0406591-0.16628im       -0.152606+0.0524849im   -0.0554093-0.136357im        0.294126-0.0359238im    0.0150783-0.085809im     -0.0322387+0.0894548im
   0.0838545+0.0596572im      0.0907975-0.0718174im     -0.180331+0.158126im      -0.244639-0.0522143im    -0.236711-0.111781im        0.0108681-0.0116062im      0.071047-0.006492im     -0.0700737-0.170117im     -0.130959+0.0482238im     -0.130612-0.0330045im      0.159661+0.102204im      -0.0454839-0.159969im         -0.16352-0.117985im      -0.115968+0.236403im    0.00962208-0.115521im     -0.0953596+0.0571619im       0.215922-0.0727523im      0.108317-0.00908456im    -0.152248-0.173536im      -0.206308-0.0163881im      0.185575+0.12899im      -0.123643-0.057563im     0.0413595+0.036389im      0.0150119+0.0989321im    -0.0685877-0.115464im    0.00610752+0.129427im      0.101465+0.2339im        0.0810435-0.0960397im    0.0780036+0.187088im      -0.0873071-0.123083im     0.0268459-0.11065im       -0.262579-0.0848718im
  -0.0804216-0.0640584im      -0.231475-0.0416888im     -0.158296+0.054586im       0.080316+0.00768173im    0.185434-0.0442196im        0.186965-0.0337869im     -0.114666-0.148916im      -0.105006-0.0880889im    0.0758962+0.216463im       0.144788-0.0105231im    -0.0113967-0.105365im      0.00270317-0.118737im       -0.0819164-0.0394428im    -0.0156672-0.0999164im     0.192939-0.173403im     -0.0220602-0.0139616im     -0.0909423+0.158912im      0.0761903+0.0293675im      -0.17804-0.101197im     -0.0937912-0.217247im       0.118015-0.0564223im      0.13989+0.0757526im    -0.146652-0.402788im      0.0191285-0.014397im     -0.0821686+0.132117im      0.028754-0.149689im     0.0401564+0.0638644im      0.191798+0.120454im     0.0829508+0.0297715im     -0.0513289+0.11069im      0.0302614+0.266954im      -0.152014-0.0169309im
    0.174019+0.000977413im   -0.0426375+0.189092im      0.0300682+0.0953503im      0.249566-0.0108428im    0.0526459+0.00755752im      -0.164625+0.0761199im      0.185122-0.272551im       0.200877+0.0168607im     0.191462+0.0996327im     0.0773934+0.0114866im     -0.111443-0.0620445im     -0.0500612+0.00610143im      0.0593711-0.0275213im     -0.228751+0.14151im       0.038849-0.0117087im      0.170634+0.152415im      -0.0179042+0.11324im        0.115927-0.15061im        0.037207-0.244673im     -0.0483138+0.174392im    -0.00825229+0.117378im     0.0901992-0.0374399im     0.147574-0.0540166im      0.209003-0.0973273im      -0.20663+0.14491im      -0.155354+0.268341im    0.00275939-0.0556093im     0.0273795-0.219287im     0.0358238+0.0154575im     -0.0451633+0.0594241im   -0.0125438-0.0315177im     0.0805916-0.0409553im
    0.359376-0.0131582im     -0.0192176+0.0244827im      0.236022+0.0545508im      0.131126+0.0474973im   -0.0774407-0.00428585im     0.00311175-0.0550711im   -0.00155977+0.163218im      -0.324181+0.0831353im     0.130542+0.00111992im   -0.0799801+0.0632997im     0.0522911+0.199296im        0.307306+0.145403im         0.183931+0.142996im       0.127542+0.0345666im    -0.044672-0.0846018im     -0.164377-0.121301im      -0.0217663+0.12107im       0.0817232+0.0417787im    -0.0964679-0.170819im     -0.0732598-0.158873im     -0.0042093+0.203536im     0.0675209-0.026282im      0.116669+0.058133im      0.0522245-0.121065im      0.0578574-0.0966927im    0.0762098+0.159682im     -0.060895-0.127349im      0.0763242+0.139692im     0.0826329+0.00186995im     -0.138746+0.0455069im     0.143274+0.141064im     -0.0519939+0.0386522im
   0.0870038-0.0875223im      0.0702945+0.00479946im   0.00713083-0.0894342im     0.0417068+0.120242im      0.144471-0.166711im       -0.0364888-0.0427515im     0.0522987+0.0880141im     -0.193614-0.100079im     0.0685945-0.0682857im    -0.0424375+0.148055im       0.185524-0.181671im       -0.224584+0.0650594im    -0.000955871-0.0849567im      0.100749+0.163144im      0.119262-0.146907im      0.0571436+0.257087im       -0.102709+0.230955im      -0.256044+0.0940386im     -0.181148-0.0701527im      0.140481+0.0748944im     -0.100838-0.0344099im   -0.0461878-0.116569im     0.0237763+0.05976im        -0.23081+0.256072im     -0.0768065-0.0814771im   -0.0674109+0.142843im    -0.0588395-0.0666886im     0.0911933+0.0122719im     -0.28412+0.143819im        0.116328+0.0845249im   -0.0242056+0.0592571im    0.00124992+0.0997216im
  -0.0722651+0.0761015im      -0.266202+0.0716544im      0.033816-0.216709im      0.0125165+0.0973479im     0.124001-0.0122246im        0.136992+0.23464im       -0.204983+0.00443473im    0.0479561+0.0466829im   -0.0388153+0.272639im     -0.0414843-0.119823im     0.00571664+0.210474im     -0.00868335+0.015608im         0.055377+0.045611im       0.059208-0.0732571im     0.131628-0.0953025im     0.0468349+0.0890479im     -0.0323311+0.0260149im    -0.0189574-0.0271038im     -0.102445+0.112264im      -0.183772-0.1662im        0.0695717+0.0418411im   -0.0837738+0.0350011im     0.118528+0.120612im      -0.100088+0.00940298im   -0.0935212-0.112123im     -0.115101+0.162894im     -0.108778-0.044436im      -0.349654-0.131685im      0.145597+0.169812im        0.211873+0.0828583im    0.0822399-0.225841im     -0.0624968+0.115973im
   0.0481034+0.188425im      -0.0954937-0.0831109im     -0.108609-0.227423im    -0.00941635-0.121653im    -0.0218926+0.202546im        -0.119508+0.0992936im       0.10763-0.171213im      -0.103646-0.0904178im     0.155566+0.166381im     0.00597553+0.210733im      0.0454735-0.0733411im       0.128804-0.154872im         0.130611-0.136942im      -0.102028+0.0496464im   -0.0593426-0.0307024im    -0.0276494-0.125097im          0.1438+0.0430549im    -0.0895733-0.134428im      -0.138237+0.0287126im        0.1731+0.11148im       -0.172403-0.119859im    -0.0576966+0.104055im     -0.198752-0.0321037im      0.178792+0.0956783im      0.245623-0.294565im    -0.0894609+0.0698549im   -0.0959155+0.0599082im      -0.11431+0.00199611im     0.10457-0.0301224im      0.0509387-0.141714im     0.0736154+0.151456im     -0.0260199+0.167709im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
  -0.08065754143391692 - 0.055009647018866625im
   0.19006121803300283 - 0.07786891844814922im
   0.10110022848837084 + 0.07019692892627724im
   0.17722982976443863 - 3.845725322671953e-5im
  -0.01965030001833992 - 0.018323474940475915im
  -0.10041019664527258 - 0.06352273584511699im
  -0.06025107227379753 + 0.2575612552458329im
  -0.15443054565693942 + 0.0019917822053837943im
   0.07667187870643152 + 0.044896211808401865im
   0.18294782047496447 - 0.04110999141545236im
   0.17515170204754416 + 0.043903940534800054im
   0.11186840537164285 + 0.08167480560292308im
  -0.18075407116958775 - 0.08938572746357397im
 -0.039464158948234025 - 0.06466933278012425im
    0.2852231150621538 + 0.0im
   -0.0839802547795993 - 0.0029155308881749827im
    0.1032627242838993 + 0.05789684051869745im
  -0.16761915087686707 + 0.1108156023017131im
   0.05761396772027127 + 0.06514431044253055im
   0.11456529414242904 - 0.003252883543012841im
 -0.062438541544190033 + 0.21640509879312178im
   0.12916447469420633 - 0.24475604890695543im
  -0.04177599826076447 + 0.1254273927708512im
   0.28367429245849807 - 0.012852699463165529im
   0.21998147663298118 - 0.0185541567069078im
 -0.042575270237292684 - 0.0918044215109721im
   0.03285829646287229 + 0.07661907321005776im
   -0.2112250459206283 + 0.16668964049279222im
   0.09308329474067217 - 0.03622190741744301im
 -0.007285875270852709 - 0.07696829040374963im
   0.16109043351999203 - 0.039462393398074724im
  0.023738989929819425 + 0.28377175482297445im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Sunday 24 November 2024 04:55">Sunday 24 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
