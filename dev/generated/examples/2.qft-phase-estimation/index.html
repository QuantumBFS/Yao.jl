<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
     -0.19214+0.102943im    -0.00237853+0.0508649im      -0.16435+0.200618im      -0.112133+0.102615im      -0.103217+0.0307609im   -0.0347894+0.216951im   -0.0120965-0.189899im     0.0565723-0.0581215im    -0.0561245-0.108579im    -0.0409136-0.0184479im   -0.0694098+0.0992384im     0.084188+0.12237im      0.0166855-0.0395501im    -0.138714+0.0414694im      0.1537+0.152327im       -0.302873+0.0542447im  0.00659814-0.0207769im  -0.0808494+0.139028im       0.165527+0.206224im       -0.106957-0.0833455im     0.120633+0.0844677im   0.00278463+0.00403707im   -0.0669206+0.0183258im       0.253142+0.09848im       -0.0106914-0.311136im       0.123769+0.0351708im     0.349915+0.156209im      -0.051782-0.0702408im     0.0246474+0.0340495im    -0.0610412+0.084919im       0.020275-0.022734im     -0.205264-0.0149048im
    -0.173122+0.0419881im     -0.322156-0.171667im      0.0197287+0.144313im      -0.117755-0.0267875im     -0.179343+0.298745im      0.102774-0.0860407im  -0.0264192-0.128637im     -0.333384+0.0214714im      0.171083+0.10379im     -0.0511471-0.103396im     -0.149664+0.183139im     -0.147154-0.0692547im    -0.022598+0.0239909im     -0.14306+0.241907im    0.0870631+0.00992633im    -0.0485669-0.144595im   -0.0785428+0.203661im    -0.197289-0.0667081im     0.0352873-0.0238856im      -0.121513+0.0729388im    0.0077262+0.0105464im   -0.0446978+0.0921535im    -0.0460051-0.0900562im      -0.216261-0.153278im       0.0125272+0.0192048im     -0.057587-0.0101097im    -0.102137+0.00925611im     0.131203-0.00776923im   -0.0865364+0.0381953im     0.0209637-0.0599519im       0.14049+0.0652912im  -0.00547625+0.106806im
     0.325018+0.180604im      0.0529483+0.204389im      -0.491106-0.0160444im      0.187589-0.0759533im    0.00462966+0.0850053im   -0.0459154+0.108397im    -0.138655-0.199564im     -0.161944+0.136454im     -0.0490302+0.0195773im    0.0583601-0.0798599im   -0.0312722+0.0401195im     0.223336-0.0602551im   0.00117049+0.00106549im   0.0230645-0.0215016im   0.0539231-0.114691im     0.000797081-0.212984im   -0.0561454-0.0392862im   0.0480486+0.00193051im    -0.144098-0.0309461im      -0.128323-0.0361365im    0.0245334+0.143575im     0.0310115+0.0514348im     -0.143796-0.216881im      -0.0464038-0.0521942im     -0.0317678+0.0981655im     0.0990107-0.0698212im   -0.0112376-0.0774515im     0.0503168-0.0969113im      0.122906-0.224613im     -0.0783498-0.124669im     -0.0493792+0.0327416im   0.00224524-0.0251152im
    0.0501637+0.00646382im   -0.0169436-0.0715342im     -0.198049+0.0167631im     -0.140144-0.0639341im   -0.00310333+0.0269055im    -0.103316+0.210875im     0.102641+0.142865im      0.072049-0.03739im         0.07331+0.0182977im     0.132272+0.060788im      0.122693+0.0707426im    -0.143093-0.105265im     -0.155793-0.15119im     0.00545512+0.0967926im  -0.0698327-0.178087im     -0.00204003+0.276144im    -0.156841+0.0351449im  -0.0417382+0.246062im      -0.073367+0.025281im       0.0193504+0.0790904im    -0.229323+0.0367798im     0.110764-0.0495047im    -0.0523588-0.201849im          0.2565+0.0340552im      0.0186129+0.129723im      0.0210441+0.0507345im   -0.0445983+0.200422im       0.132579+0.00179567im   -0.0253367+0.13737im        0.097155-0.130195im     -0.0771261+0.12237im      0.0950014+0.389677im
    0.0779948-0.0953482im      0.124279+0.0170867im        0.1211-0.155269im      -0.166707+0.122461im       -0.17542-0.0911108im    -0.124636+0.226618im    -0.149046-0.152898im    -0.0728012+0.137933im       0.145178+0.0519302im    0.0270523+0.0515426im   -0.0463469-0.104546im     -0.147557+0.0422798im    0.0143603-0.339526im    -0.0465997+0.0709353im    0.029735-0.190112im        0.237925+0.0238167im    0.222515-0.0843702im   -0.123618+0.119002im       0.094571+0.158099im       -0.124982-0.0316212im     0.120448+0.114172im      0.112341+0.165445im      0.0303045+0.0843065im      0.0573893-0.147174im      -0.0148404-0.00139632im    -0.273106-0.147924im    -0.0143315+0.0376422im     0.0459399+0.0424221im    -0.0992349-0.132478im     -0.0420145-0.0878779im    -0.0233225-0.180943im     0.0525888-0.136559im
    -0.159181+0.120266im     -0.0996719-0.217495im      -0.050275-0.017064im      0.0686482+0.209997im      0.0685342-0.0622593im   -0.0812224+0.0286246im  0.00401145-0.0919874im    -0.013289-0.028368im      -0.132057+0.121302im   0.000985522-0.0601708im  -0.00862082-0.162904im      0.116054-0.0695835im    -0.289884+0.0293413im      0.14688-0.0553344im   0.0721224+0.0526877im      -0.167869+0.264347im    0.0768364-0.174848im    -0.159921-0.146757im      -0.220753+0.204551im        0.151081-0.0246262im    -0.075279+0.0678567im        0.221+0.20335im      -0.0983443+0.114164im       -0.209888-0.164876im       0.0501096+0.186807im     -0.0377087-0.0113467im   -0.0164299-0.0264858im     -0.207476-0.162826im     -0.0337685+0.00646276im    -0.101986-0.0214775im     0.0188511-0.0258912im   -0.0810238+0.0921664im
    0.0202837-0.0469451im    -0.0925363+1.89582e-5im   -0.0240481+0.0373426im    -0.0388635-0.00899074im    -0.203581-0.0459103im    -0.150962+0.167im       -0.160091+0.166264im     0.0204716-0.0145724im     0.0636911+0.0986425im   -0.0421522+0.0175478im     0.135572+0.194438im     0.0516645+0.109312im     0.0769053-0.0162828im    0.0250865+0.134025im    -0.127336+0.245809im        0.141077+0.0659448im   -0.167772-0.193495im    0.0878848-0.044098im     -0.0206736-0.0529801im     -0.0325885+0.177973im     0.0695147-0.0364121im     0.102639+0.356109im      -0.061464+0.0483422im      0.0447242-0.00335756im      0.302735+0.0882293im      0.287856-0.0420286im   -0.0771796-0.151622im      0.0633963+0.0241724im      0.218585+0.135499im      0.0768209+0.152055im       0.131712-0.122791im    -0.0113144-0.128847im
    0.0852431-0.0273472im     -0.176831-0.167055im      0.0165399+0.00232904im    -0.110909-0.0470611im      0.071601-0.00258751im   0.0445967+0.0430734im  -0.0300108-0.0924561im    0.0321648-0.0491121im     -0.193199-0.0353137im    -0.151664+0.0838575im    -0.122546-0.126473im      0.070897+0.387419im      0.269582+0.0590839im    0.0736919+0.057121im   -0.0752949+0.0540773im      0.0697122+0.0369148im  -0.0663444+0.0876159im    0.130235-0.00460431im   -0.0981168+0.0213309im      0.0281296-0.0609392im     0.198247+0.0430818im     0.259125+0.144985im      -0.131891-0.0527044im      0.0244829+0.0845021im      -0.177128+0.0559062im     -0.147631+0.166641im    -0.0971659+0.096924im       0.105331+0.0609271im    -0.0619279-0.285477im       0.132508+0.226247im     -0.0342271+0.114443im     0.0301599+0.232121im
   -0.0719598-0.154485im       0.066504+0.0133322im      0.122002-0.0992545im      0.139435+0.0836416im      0.141548+0.176952im    -0.0236814+0.130796im     0.105877-0.0400107im    -0.211037-0.0784774im     -0.232057+0.0788436im    -0.189154-0.0767181im    -0.056973+0.160422im     -0.219832+0.131545im    -0.0922788+0.0668774im    -0.122867-0.356827im     0.068178+0.0601273im     -0.0206195+0.0937063im  -0.0624455-0.0824819im  -0.0923258+0.0700341im     0.0704134+0.00584913im   -0.00174586+0.260827im    -0.0139482-0.104451im     0.0530303-0.0898796im     -0.222159-0.213381im       0.0849963+0.0795978im     -0.0534674+0.161239im        0.12141-0.117256im    -0.0150327+0.013998im       0.103223+0.0406704im     -0.119373-0.143633im    -0.00553064-0.026416im     -0.0635898-0.203421im      0.078252-0.169127im
    0.0161767-0.105356im     -0.0933492+0.158916im      -0.159539-0.0867824im     -0.108715+0.0633193im    -0.0183264+0.0202252im    0.0982546-0.0213493im    0.191253-0.136731im     0.0631279-0.149869im      0.0205963+0.018331im    -0.0227773-0.0378328im     0.184019-0.121143im    0.00942852-0.174723im     0.0752241-0.0456473im   -0.0676238+0.0830205im   -0.187087+0.0195778im       0.147969+0.203559im    0.0744531-0.167471im    -0.196417-0.184709im      0.0159451-0.175825im       -0.202221+0.0507792im     0.103986-0.123395im    -0.0234811-0.113412im      -0.378195+0.182837im       -0.234518+0.158092im       -0.106481-0.0768538im    -0.0389552+0.0374068im    0.0890056+0.0227116im      0.201081+0.0535394im      0.121959+0.0408575im    -0.0778793-0.00326729im    -0.137733-0.0435768im    -0.126012+0.073438im
   -0.0151836-0.0198142im      0.135535+0.0128891im     0.0810349-0.0730939im      0.224348+0.166028im      0.0646678+0.134987im      -0.27197-0.120497im     0.144073+0.169258im     -0.106973-0.12414im        0.108504+0.0692113im   -0.0513425-0.166759im     -0.130967+0.217911im       0.23473-0.113323im    -0.0382796-0.0250289im   -0.0305269+0.197652im    -0.324353+0.0747677im       0.100293+0.0170204im  -0.0349987+0.0890647im   0.0551689+0.22967im      0.00559758-0.051653im      -0.0182375-0.160397im    -0.0475461+0.0242972im    0.0113497+0.00648059im    -0.171399+0.136912im       0.0781556-0.0606236im     -0.0686158-0.033265im     -0.0884353-0.0741456im   -0.0324968+0.229496im      -0.182764+0.0577355im    -0.0070884-0.223794im     -0.0363537+0.0784803im      0.145012+0.0100626im    -0.134172+0.00942062im
   -0.0260391-0.169485im      -0.136595-0.0166862im     0.0390539+0.0572252im      0.112418+0.0718483im     0.0984226-0.217939im     -0.105998+0.0837074im   0.0459624+0.016466im     0.0991059+0.132032im      -0.043826-0.268717im    0.00753475+0.117709im      -0.13341+0.0617491im    -0.105219+0.0252922im    -0.197176-0.0439515im    -0.304775+0.189234im     0.136473-0.192238im      -0.0131538-0.129747im    -0.018312-0.115286im    -0.014988-0.25434im       0.0971317-0.224549im       0.0683882-0.0259589im   -0.0977514+0.0517492im     0.150174-0.116281im     -0.0161544+0.0768013im     -0.0301486+0.0730087im      0.0234338+0.140042im      0.0673989-0.0952899im     0.156472+0.011196im    -0.00661907+0.0470884im      0.205396-0.238263im      0.0587775+0.0222415im      0.281405+0.0260072im    0.0137022+0.111673im
     0.124139+0.17758im       0.0550328-0.0165546im     -0.107281+0.116968im     -0.0776093+0.00542079im    -0.399856+0.00521568im   -0.149203-0.0531876im   0.0846387+0.165184im      -0.15544+0.211427im     -0.0259617-0.0390479im     0.107931+0.18935im      0.0529687-0.0108058im    0.0161957+0.101843im    -0.0925503+0.119055im     -0.195255-0.122119im    -0.101546+0.297671im       0.0135407+0.0572998im    0.137707-0.0252192im  -0.0510912-0.0377531im   -0.00830364-0.194316im        0.251435+0.0528132im     0.229249-0.137673im   -0.00837088-0.0212493im   -0.00362084-0.027188im      -0.0224597+0.105131im       -0.162096+0.00481141im    -0.126121-0.109584im     0.0764418+0.0370951im     -0.167541+0.0113007im     -0.112777-0.0222759im    -0.0657684-0.164864im      0.0219737-0.019963im      0.152194+0.136258im
     0.117798+0.00871447im    0.0901158-0.188705im     -0.0528076-0.0428922im    -0.0359412-0.163648im      0.0438922+0.183751im     0.0180232-0.164963im   -0.0663405-0.0586132im    0.0841558-0.178923im       -0.19605+0.0970403im   -0.0161121-0.245396im      0.153802+0.0932038im    -0.158808+0.0552671im    0.0631184-0.113403im    -0.0374298+0.117686im    0.0215218-0.0287751im       0.195641-0.158703im     0.207708-0.112121im   -0.0249308-0.0351877im      0.230492-0.0687561im       0.121971-0.192813im    -0.0346162-0.054314im      0.100002+0.0852301im     0.0467634-0.0239058im     -0.0698077+0.113236im        0.207114-0.034713im       0.189276-0.0610399im     0.165124+0.0696846im     -0.208196-0.243471im      -0.132861-0.0449946im     0.0853708-0.0615312im     -0.112614-0.117646im     0.0477369+0.215318im
   -0.0182615+0.320844im       -0.13052-0.0650139im      0.140913+0.181544im       0.179302-0.0381897im    -0.0368203-0.0713358im     0.137313+0.0155159im    0.174631+0.0317949im     0.254811+0.00998014im   0.00330442+0.206578im      -0.18629-0.0221209im   -0.0465557-0.0975465im    0.0312058-0.0563322im     0.152639-0.0390599im   -0.0317522-0.0960198im   -0.144504-0.174205im       0.0376917-0.29302im    -0.0312652-0.0459077im  -0.0314913-0.0333514im    -0.0660843+0.000680549im    -0.095829+0.258008im    -0.0347296-0.123048im     0.0612853+0.208443im      0.0136985+0.000610674im     0.181418+0.0103678im     -0.0502906+0.0908304im     -0.097992+0.00722351im       0.185+0.226061im     -0.0344296+0.0398071im      0.100287+0.0455362im     -0.120805-0.23854im       0.0461411-0.150577im    -0.0213953+0.0144426im
     0.122718+0.0359305im      0.162018-0.147587im    -0.00883357+0.132133im       0.119615+0.0569169im    -0.0172918+0.213109im    -0.0745742+0.0326154im    0.102502+0.128696im    0.00766583-0.200607im     -0.0572717-0.0904272im    -0.286064+0.265339im     0.0143412+0.0743253im   -0.0122773+0.0875556im    0.0550722-0.0448834im    -0.094352+0.0815561im   0.0704274-0.129103im        0.061544+0.0784083im    0.192907+0.0316645im    -0.16105+0.0386833im     -0.251481+0.000930054im   -0.0270324+0.0849917im     0.188464+0.222068im   0.000660157-0.123308im       0.080393+0.108364im       -0.107447-0.0566218im       0.165226-0.00189453im    0.0886734+0.21957im       0.017125-0.0679044im     -0.035256+0.0653101im     0.0709764+0.023054im       0.166993-0.260888im     -0.0757123+0.202495im    -0.0779001-0.182925im
   -0.0674134+0.0702639im     0.0854587-0.129095im    -0.00801286-0.0829207im     -0.055032-0.185189im      0.0548244+0.191248im     0.0771129-0.114991im    -0.392425-0.0137185im    0.0293471-0.0590529im     0.0628439-0.159601im     0.0768117+0.0266638im    0.0239249+0.11983im      -0.020662+0.190741im    -0.0530702-0.0523119im    -0.170044-0.146682im   -0.0720125+0.0325741im      0.0502302+0.0729612im   -0.129941-0.0569551im   0.0876268-0.150006im      -0.290091+0.176628im       -0.137686-0.100642im      -0.12088-0.0162345im  -0.00121485-0.140095im     -0.0625625+0.213176im        0.012126-0.0381848im      -0.168698-0.0849254im     0.0218802+0.013326im    -0.0386405+0.104314im     -0.0477937+0.158149im       0.153085+0.0363082im    -0.0515533-0.204414im       0.131008-0.301651im     0.0623906+0.0984629im
    0.0253743+0.152171im      0.0452631+0.0186155im      0.173382+0.111374im        0.19509-0.10967im        0.229525-0.12085im     -0.0666924+0.217258im    -0.126899+0.162305im     -0.106085-0.0171116im      0.026098-0.0169127im     0.131083-0.0164936im    0.0207239+0.00504052im   -0.157308-0.0145884im   -0.0376917-0.0717229im    -0.054409+0.0226655im   -0.154122+0.138782im        0.109025+0.0333289im   -0.146663+0.106981im    -0.241683-0.207025im      0.0323033-0.0207724im      0.0141199-0.272583im     -0.033695-0.0762697im      0.11461+0.151321im      -0.110516-0.143722im       0.0142573+0.0514201im      -0.161443-0.180719im      -0.100669+0.24385im       0.112111-0.152514im       0.114097-0.235591im     -0.0616996+0.0444278im     0.0520331-0.132919im     -0.0170148+0.110681im    -0.0206801-0.194269im
     0.157456+0.0149641im     0.0396979+0.0530618im     -0.166446-0.188761im     -0.0797269-0.228555im       0.198555+0.0322052im     0.150043+0.0523439im   0.0434299+0.124262im    -0.0165347+0.016624im       0.016177+0.158554im     0.0263092-0.180483im     -0.194432+0.0401027im    -0.012534+0.0200231im    -0.170863+0.141956im    -0.0295382+0.0690372im  0.00541786-0.0481369im   -0.000727888+0.0233323im    0.207495-0.121621im    -0.222235-0.0364797im     -0.180085+0.0407712im       0.134704+0.192033im       0.12783-0.114245im     0.0207062+0.0636424im      0.110941+0.0802146im      0.0980425-0.156378im      -0.0997944-0.234752im     -0.0398646-0.0907425im     0.144757+0.132467im      0.0646955+0.0567241im     0.0720118+0.0788212im      0.242334+0.256324im       0.187355+0.0986731im     0.120852-0.0901915im
  -0.00589572+0.00721158im    0.0189474-0.0900016im      0.120647-0.0876694im      0.144351+0.0448125im     -0.017544-0.172717im     0.0701549+0.0878069im     0.07928-0.0822459im   -0.0655027-0.0189886im      0.304578-0.0561871im    0.0702281-0.404382im      0.147157+0.0967777im     0.111484+0.120572im      0.198075-0.0992292im    -0.195803+0.0981648im   0.0541206+0.0101037im      -0.164663+0.207412im   -0.0549547-0.146212im     0.117882-0.060922im      -0.121913+0.0410789im     -0.0797935+0.236577im      0.101862-0.0725486im    0.0052879-0.101875im       0.191456-0.0601651im     -0.0852586+0.12946im        0.0265131-0.0600324im    -0.0375839+0.0609854im   -0.0513887+0.0213702im     -0.124487-0.17313im      -0.0060488-0.17841im      -0.0183577-0.0980355im    -0.0708735+0.164856im      0.223529+0.00875651im
    -0.135581-0.0314581im    -0.0832216+0.0173394im   -0.00300081+0.0090282im     0.0336021-0.184517im      0.0364198+0.145277im     -0.135754-0.192133im    0.0444049+0.0158889im    0.0834557+0.0217782im      0.127094+0.130588im      0.119097+0.144353im      0.148426-0.387481im    -0.0338857-0.0607865im     -0.12461-0.0326745im    -0.208028+0.040058im    0.0304085-0.0171197im      0.0362112+0.0559063im   -0.134157+0.0255779im   0.0909664+0.182581im      -0.102529-0.0138278im      -0.202276+0.0572475im     0.206571+0.0754695im    0.0168508-0.0698677im    0.00773365-0.20421im       -0.0667974-0.017392im      -0.0527645+0.0960648im      0.038907+0.0993225im     0.165371+0.00440961im     -0.16155-0.236347im     -0.0253726-0.0959684im      0.226139+0.202993im       0.111064-0.226199im    -0.0160179-0.156307im
   0.00351421-0.0774647im       0.23907-0.0158645im     -0.197653-0.0100138im       0.17071+0.160596im      0.0548491-0.0689022im     0.014843-0.126964im     0.247847+0.173525im     -0.134771+0.141574im      0.0655312-0.0420893im    -0.101007+0.0912738im    -0.186868-0.0986769im   -0.0273185+0.138234im      0.181102-0.0856346im   -0.0137499+0.0625514im   0.0530512-0.121145im       0.0318566+0.0368793im  -0.0832834+0.0597616im  -0.0546554-0.106929im     -0.0455628+0.0826946im     -0.0807591+0.00218117im  0.00324661-0.101827im     0.0148866+0.0357955im    -0.0508919-0.0815301im    -0.00121049-0.145717im        0.149792-0.241062im      0.0850102+0.130466im     0.0219202-0.189007im      0.0203733-0.0661084im      -0.11197+0.146581im      -0.195528+0.138957im       0.083904-0.313395im      0.145134+0.298389im
 -0.000981919+0.0307751im     0.0371033+0.239489im       -0.17812+0.0020781im      0.102541+0.074363im      0.0908009+0.0608373im     0.151998+0.0581785im    0.073596+0.0314273im   0.00227983-0.0545369im     -0.265375+0.15389im       0.124758+0.110143im    0.00121136-0.0163767im    -0.253393+0.0544301im      0.21986-0.205019im    -0.0730257+0.27327im    -0.0766272+0.220511im      -0.0990998-0.0243624im  -0.0665982-0.103165im    0.0995913-0.0895371im      0.142722+0.152858im       0.0232499+0.138221im      -0.11905+0.204776im     0.0526816-0.0750552im     0.0601822-0.0250118im      -0.124817-0.016283im       -0.173213+0.0585431im      -0.15194-0.0575401im    -0.173195+0.0392001im     -0.283156+0.0984869im   -0.00549873+0.168112im      0.0515592-0.0309318im      0.134324+0.0337935im    0.0119893-0.081976im
    -0.142148-0.057158im     0.00150565-0.0239547im    -0.0968043-0.207189im      -0.131851-0.0577051im     0.0815751+0.180338im    -0.0971388+0.0932218im   0.0751407+0.0433434im     0.413145+0.0342734im      0.121564+0.189071im    0.00368817+0.0270631im    -0.121895+0.173583im       0.07904+0.0202346im    0.0377347-0.0748197im    0.0681354-0.182143im     0.103992+0.0329108im       0.154219+0.0445153im    -0.14966+0.139155im   -0.0292473-0.0249342im     0.0771539-0.0585795im       0.076879+0.149848im     0.0244779+0.236703im    -0.0701477+0.106391im     0.00977318+0.0582715im      -0.137351+0.125701im       -0.146338-0.0999295im   -0.00608725-0.0377184im     0.136805-0.299366im     -0.0484082-0.0495245im     -0.112667-0.123648im      -0.184748-0.135168im       0.183325+0.144925im     0.0616087+0.0634779im
     0.168971-0.263069im      -0.169171-0.0130777im   -0.00315835-0.00872018im      0.17967+0.111718im       0.158801-0.0956406im     0.232824-0.0311556im   -0.117905-0.0409363im     0.130084-0.0849622im     0.0990705-0.231661im     0.0788746+0.137762im     -0.150944+0.077718im     0.0669087+0.0171013im    0.0592941-0.0243795im    0.0109723-0.0462916im   0.0369874+0.251642im       0.0978554+0.101513im   -0.0552717+0.0799484im   -0.227033+0.089644im      -0.134776-0.142597im       -0.101641-0.00720562im    0.072312+0.062648im     -0.186674+0.192614im      0.0625643-0.196976im      -0.0334869-0.0667642im      0.0675378+0.0739832im    -0.0608613-0.28773im       0.126907+0.179754im      -0.175193-0.0329341im     -0.063461+0.128743im      0.0569776-0.0665622im     -0.142483-0.0664842im   -0.0521737+0.0798639im
    0.0605559-0.0590316im     -0.102301-0.0509639im   -0.00600174+0.000739746im   0.0925513-0.138842im     -0.0218813+0.0563924im    0.0319896-0.0194956im   0.0422425+0.0523037im   0.00880427-0.00698076im   -0.0751081+0.0521457im    -0.244717-0.0764328im    -0.287887-0.036788im     0.0842648-0.0531644im    -0.153755-0.0815717im   -0.0498864+0.125018im   -0.0255156+0.136202im      -0.0313061+0.160175im     0.176446+0.0415294im    0.258163+0.00622136im   -0.0174241+0.0627764im      -0.039878-0.0989927im    0.0599056+0.071558im     0.0426961-0.112228im       0.107153-0.0188122im       0.121432+0.304352im       0.0250547+0.0368822im     -0.249792-0.214257im    -0.0804342-0.196304im        0.25697-0.300177im       0.165253+0.201537im     -0.0260082-0.130389im      0.0201592-0.153169im    -0.0333884+0.0126845im
   -0.0468355+0.120033im       0.094451-0.0375461im    -0.0268296-0.00796444im    0.0239139-0.226862im      0.0310046+0.0525766im    0.0512311+0.236852im   -0.0318079+0.132328im   -0.00849576-0.248668im      0.0754766-0.137686im    -0.0690843+0.150625im    -0.0382334-0.198715im      0.202863+0.068756im     0.0307827-0.0205836im    0.0269531-0.0370786im   0.0866906+0.071439im       -0.158831-0.0273782im   0.0955528-0.132439im    -0.102832+0.185098im       0.291298-0.0179323im     -0.0567113-0.00530714im   -0.195126-0.155004im     -0.267193+0.0725221im     -0.188652+0.0232876im      -0.196347-0.0233159im       0.173336+0.0681162im     -0.210163+0.019957im    -0.0973393+0.0054508im    0.00581672-0.0546882im     0.0855254-0.136142im      0.0808057-0.00994559im     0.193993-0.0193961im     0.238816+0.0560861im
   0.00213184-0.267447im      -0.110844+0.18603im      -0.0136138+0.14789im       0.0936984+0.0276871im     0.0425092+0.0427812im    0.0333593+0.0597717im  -0.0610435-0.129828im     0.0139226+0.0965718im    0.00267873+0.128485im    -0.0398231-0.110909im      0.126865-0.13063im        0.20722+0.0816645im    -0.173875+0.059577im     -0.229516-0.076171im    -0.164922+0.097105im       0.0499208+0.0261566im    0.287492+0.111746im    -0.054523-0.00186849im      0.06993-0.00606042im     0.0359381+0.124837im     -0.261498+0.099464im    -0.0396375+0.145119im        0.16119-0.0701965im      0.0853394-0.000803677im    0.0338895-0.184889im     0.00836243+0.304279im     -0.137741-0.139594im      -0.056201+0.188479im     -0.0122592-0.107546im       0.137146-0.125237im      0.0101597-0.12413im      -0.086532+0.181535im
   -0.0316945+0.0901469im     -0.269564+0.25515im       -0.169919+0.1632im        0.0838262-0.144548im       0.025321-0.0444622im   -0.0347085-0.101147im     0.141247+0.109987im      0.184018-0.00961951im  0.000377832-0.010267im    -0.0974461-0.0853856im   -0.0730172+0.0114443im    -0.237468+0.182924im     -0.133441-0.220111im    -0.0388862-0.0528703im   0.0852154+0.0527859im     -0.0234352+0.184917im   0.00813364-0.0771438im    0.130842+0.102204im     -0.0241919-0.0691941im     -0.0623556-0.210766im     0.0567063-0.220119im    -0.0820194+0.115233im       0.107052+0.173044im      -0.0511458-0.278865im     0.000992792-0.0395345im      0.138699-0.0364482im    -0.174012+0.0375627im     0.0999227+0.0483058im     -0.168831-0.211617im      -0.102256-0.101512im     -0.0965636+0.0669395im   -0.0184216-0.0836766im
     -0.15428+0.105807im       0.124269+0.0345513im    -0.0260757-0.0172477im     0.0271395-0.0364926im     0.0332875+0.18528im        0.28959-0.21763im      0.229115+0.0177958im   -0.0395108+0.152238im       0.211156-0.140465im     0.0952399+0.112289im     0.0471302+0.0363754im    0.0184529+0.0813014im    -0.080274+0.0356692im    0.0266463-0.0277775im   -0.174055+0.00345998im    -0.0327124+0.0557698im    0.097537-0.117452im    -0.059556-0.149104im       0.100019+0.206361im       -0.226966-0.137427im    -0.0326174+0.0730471im     0.133456+0.216892im     -0.0158632-0.000226283im     0.216094+0.184496im        0.108276+0.206573im      0.0317526-0.170807im     0.0665964-0.190703im    -0.00183803+0.15089im      -0.0816918-0.125061im       0.144826+0.013486im     -0.0560707+0.197424im     0.0391539-0.0366326im
     0.265314+0.0869098im     0.0864708-0.0134509im       0.12023-0.201285im     0.00640551+0.267703im     -0.0328561-0.127168im     0.0828095-0.108075im    0.0395843-0.0893003im     0.199593+0.0192432im    -0.0670103+0.126448im     -0.139997+0.092187im      0.110466+0.0589618im   -0.0778909-0.0918262im    -0.353275+0.0327562im     -0.15136+0.106569im     0.119746+0.104218im        -0.10543-0.171875im    -0.219787+0.0380823im   0.0825799+0.0448267im   -0.00484303+0.218213im       -0.064965-0.07212im       0.142429-0.046765im     -0.184261+0.175296im       -0.18217+0.0296783im     -0.0505065+0.115506im       0.0169497-0.170213im      0.0108233+0.0603986im    -0.130605+0.0046883im     0.0569073+0.0343309im    -0.0189904-0.0254337im      0.210278-0.0844181im   -0.00452455+0.0291524im     0.169275+0.0909393im
    0.0869425+0.18031im      -0.0961527-0.218053im     -0.0741783+0.118091im      0.0832009+0.167785im     -0.0714881-0.136566im       0.04785-0.120789im    -0.128193+0.119525im      0.114957-0.0840407im      0.150704+0.127587im      0.120991+0.0996449im  0.000225761+0.0604628im    -0.130285+0.0419682im  0.000837586+0.00774058im    0.111759+0.0777651im    0.151872+0.134211im        0.144309+0.0100324im    0.311837-0.071555im      0.09594+0.00366038im    -0.142037+0.0429679im     -0.0657981+0.145321im     -0.333225+0.0251182im   -0.0348603-0.190916im      -0.182676-0.196315im      0.00720032+0.127026im       0.0104579-0.184613im     -0.0182728-0.0549623im    0.0377623-0.0398515im      0.130767+0.0517969im     -0.165499-0.2214im       -0.0331192+0.157007im       0.064087-0.0100472im    -0.113156-0.120139im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.1633640022895275 - 0.009830321111895794im
   0.16777495494520475 - 0.11599130285511815im
 -0.011819898986685722 + 0.0481900268563177im
   0.20500110147385578 + 0.05541891706024634im
  0.019421467377157407 + 0.14935611561752618im
  -0.09673150702811392 + 0.03074603503953215im
 -0.053399623909265656 - 0.20536066912651013im
 -0.041717087139744036 - 0.20796210466893197im
 -0.026515630882679827 + 0.04320648183157227im
   0.05842781041139376 + 0.0642846768000066im
  -0.05085486418905284 + 0.09475652794455885im
    0.0386920683289156 + 0.18770210470962934im
  -0.13176951143629076 + 0.05612758995344017im
  -0.08618283729432122 - 0.1583537653805459im
    0.3147869837001535 + 0.0im
   0.18715932745909447 - 0.19046066070478096im
   -0.1491430322885291 + 0.09740836090008098im
   -0.0435656948195282 + 0.2728118726083068im
   0.10511765092185549 - 0.04886901804366675im
   -0.2656123578967411 + 0.07810044349371861im
   -0.0840548737938371 + 0.08979667014564656im
  0.047944188644711075 + 0.11131529707929139im
  -0.11480587738400144 + 0.1283459988182517im
   0.18587313238439684 - 0.03330721104306011im
  -0.22387183306541605 + 0.0056557568989882775im
  -0.24654354851925567 + 0.06380478272126841im
   0.04162789980502016 - 0.05158000269140787im
  -0.15210246433018798 - 0.09910664434823241im
  -0.06866612230196345 + 0.01470744462739496im
  -0.07112004632739793 + 0.11443629573719703im
  -0.07806383230962313 - 0.006392215646261752im
  0.009040118491536846 + 0.06558562238872605im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 10:44">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
