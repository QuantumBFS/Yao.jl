<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quantum Fourier Transformation and Phase Estimation · Documentation | Yao</title><meta name="title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="og:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta property="twitter:title" content="Quantum Fourier Transformation and Phase Estimation · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li class="is-active"><a class="tocitem" href="index.html">Quantum Fourier Transformation and Phase Estimation</a><ul class="internal"><li><a class="tocitem" href="#Quantum-Fourier-Transformation"><span>Quantum Fourier Transformation</span></a></li><li><a class="tocitem" href="#Wrap-QFT-to-an-external-block"><span>Wrap QFT to an external block</span></a></li><li><a class="tocitem" href="#Phase-Estimation"><span>Phase Estimation</span></a></li></ul></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li><a class="tocitem" href="../8.riemannian-gradient-flow/index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Quantum Fourier Transformation and Phase Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/2.qft-phase-estimation/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/2.qft-phase-estimation/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="example-qft"><a class="docs-heading-anchor" href="#example-qft">Quantum Fourier Transformation and Phase Estimation</a><a id="example-qft-1"></a><a class="docs-heading-anchor-permalink" href="#example-qft" title="Permalink"></a></h1><p>Let&#39;s use Yao first</p><pre><code class="language-julia hljs">using Yao</code></pre><h2 id="Quantum-Fourier-Transformation"><a class="docs-heading-anchor" href="#Quantum-Fourier-Transformation">Quantum Fourier Transformation</a><a id="Quantum-Fourier-Transformation-1"></a><a class="docs-heading-anchor-permalink" href="#Quantum-Fourier-Transformation" title="Permalink"></a></h2><p>The Quantum Fourier Transformation (QFT) circuit is to repeat two kinds of blocks repeatly:</p><p><img src="assets/qft.png" alt="qft-circuit"/></p><p>The basic building block control phase shift gate is defined as</p><p class="math-container">\[R(k)=\begin{bmatrix}
1 &amp; 0\\
0 &amp; \exp\left(\frac{2\pi i}{2^k}\right)
\end{bmatrix}\]</p><p>Let&#39;s define block <code>A</code> and block <code>B</code>, block <code>A</code> is actually a control block.</p><pre><code class="language-julia hljs">A(i, j) = control(i, j=&gt;shift(2π/(1&lt;&lt;(i-j+1))))</code></pre><pre><code class="nohighlight hljs">A (generic function with 1 method)</code></pre><p>Once you construct the blockl you can inspect its matrix using <code>mat</code> function. Let&#39;s construct the circuit in dash box A, and see the matrix of <span>$R_4$</span> gate.</p><pre><code class="language-julia hljs">R4 = A(4, 1)</code></pre><pre><code class="nohighlight hljs">(n -&gt; control(n, 4, 1 =&gt; shift(0.39269908169872414)))</code></pre><p>If you have read about <a href="@ref tutorial-ghz">preparing GHZ state</a>, you probably know that in Yao, we could just leave the number of qubits, and it will be evaluated when possible.</p><pre><code class="language-julia hljs">R4(5)</code></pre><pre><code class="nohighlight hljs">nqubits: 5
control(4)
└─ (1,) shift(0.39269908169872414)</code></pre><p>its matrix will be</p><pre><code class="language-julia hljs">mat(R4(5))</code></pre><pre><code class="nohighlight hljs">32×32 Diagonal{ComplexF64, Vector{ComplexF64}}:
 1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅               ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im      ⋅              ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅           1.0+0.0im          ⋅    
     ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅          ⋅              ⋅               ⋅              ⋅               ⋅              ⋅               ⋅      0.92388+0.382683im</code></pre><p>Then we repeat this control block over and over on different qubits, and put a Hadamard gate to <code>i</code>th qubit to construct <code>i</code>-th <code>B</code> block.</p><pre><code class="language-julia hljs">B(n, k) = chain(n, j==k ? put(k=&gt;H) : A(j, k) for j in k:n)</code></pre><pre><code class="nohighlight hljs">B (generic function with 1 method)</code></pre><p>We need to input the total number of qubits <code>n</code> here because we have to iterate through from <code>k</code>-th location to the last.</p><p>Now, let&#39;s construct the circuit by chaining all the <code>B</code> blocks together</p><pre><code class="language-julia hljs">qft(n) = chain(B(n, k) for k in 1:n)
qft(4)</code></pre><pre><code class="nohighlight hljs">nqubits: 4
chain
├─ chain
│  ├─ put on (1)
│  │  └─ H
│  ├─ control(2)
│  │  └─ (1,) shift(1.5707963267948966)
│  ├─ control(3)
│  │  └─ (1,) shift(0.7853981633974483)
│  └─ control(4)
│     └─ (1,) shift(0.39269908169872414)
├─ chain
│  ├─ put on (2)
│  │  └─ H
│  ├─ control(3)
│  │  └─ (2,) shift(1.5707963267948966)
│  └─ control(4)
│     └─ (2,) shift(0.7853981633974483)
├─ chain
│  ├─ put on (3)
│  │  └─ H
│  └─ control(4)
│     └─ (3,) shift(1.5707963267948966)
└─ chain
   └─ put on (4)
      └─ H
</code></pre><h2 id="Wrap-QFT-to-an-external-block"><a class="docs-heading-anchor" href="#Wrap-QFT-to-an-external-block">Wrap QFT to an external block</a><a id="Wrap-QFT-to-an-external-block-1"></a><a class="docs-heading-anchor-permalink" href="#Wrap-QFT-to-an-external-block" title="Permalink"></a></h2><p>In most cases, <code>function</code>s are enough to wrap quantum circuits, like <code>A</code> and <code>B</code> we defined above, but sometimes, we need to dispatch specialized methods on certain kinds of quantum circuit, or we want to define an external block to export, thus, it&#39;s useful to be able to wrap circuit to custom blocks.</p><p>First, we define a new type as subtype of <code>PrimitiveBlock</code> since we are not going to use the subblocks of <code>QFT</code>, if you need to use its subblocks, it&#39;d be better to define it under <code>CompositeBlock</code>.</p><pre><code class="language-julia hljs">struct QFT &lt;: PrimitiveBlock{2}
    n::Int
end

YaoBlocks.nqudits(q::QFT) = q.n</code></pre><p>Now, let&#39;s define its circuit</p><pre><code class="language-julia hljs">circuit(q::QFT) = qft(q.n)</code></pre><pre><code class="nohighlight hljs">circuit (generic function with 1 method)</code></pre><p>And forward <code>mat</code> to its circuit&#39;s matrix</p><pre><code class="language-julia hljs">YaoBlocks.mat(::Type{T}, x::QFT) where T = mat(T, circuit(x))</code></pre><p>You may notice, it is a little ugly to print <code>QFT</code> at the moment, this is because we print the type summary by default, you can define your own printing by overloading <code>print_block</code></p><pre><code class="language-julia hljs">YaoBlocks.print_block(io::IO, x::QFT) = print(io, &quot;QFT($(x.n))&quot;)</code></pre><p>Since it is possible to use FFT to simulate the results of QFT (like cheating), we could define our custom <code>apply!</code> method:</p><pre><code class="language-julia hljs">using FFTW, LinearAlgebra

function YaoBlocks.apply!(r::ArrayReg, x::QFT)
    α = sqrt(length(statevec(r)))
    invorder!(r)
    lmul!(α, ifft!(statevec(r)))
    return r
end</code></pre><p>Now let&#39;s check if our <code>apply!</code> method is correct:</p><pre><code class="language-julia hljs">r = rand_state(5)
r1 = r |&gt; copy |&gt; QFT(5)
r2 = r |&gt; copy |&gt; circuit(QFT(5))
r1 ≈ r2</code></pre><pre><code class="nohighlight hljs">true</code></pre><p>We can get iQFT (inverse QFT) directly by calling <code>adjoint</code></p><pre><code class="language-julia hljs">QFT(5)&#39;</code></pre><pre><code class="nohighlight hljs"> [†]QFT(5)</code></pre><p>QFT and iQFT are different from FFT and IFFT in three ways,</p><ol><li>they are different by a factor of <span>$\sqrt{2^n}$</span> with <span>$n$</span> the number of qubits.</li><li>the <a href="https://quantumbfs.github.io/BitBasis.jl/stable/tutorial/#Conventions-1">bit numbering</a> will exchange after applying QFT or iQFT.</li><li>due to the convention, QFT is more related to IFFT rather than FFT.</li></ol><h2 id="Phase-Estimation"><a class="docs-heading-anchor" href="#Phase-Estimation">Phase Estimation</a><a id="Phase-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Phase-Estimation" title="Permalink"></a></h2><p>Since we have QFT and iQFT blocks we can then use them to realize phase estimation circuit, what we want to realize is the following circuit:</p><p><img src="assets/phaseest.png" alt="phase estimation"/></p><p>First we call Hadamard gates repeatly on first <code>n</code> qubits.</p><pre><code class="language-julia hljs">Hadamards(n) = repeat(H, 1:n)</code></pre><pre><code class="nohighlight hljs">Hadamards (generic function with 1 method)</code></pre><p>Then in dashed box <code>B</code>, we have controlled unitaries:</p><pre><code class="language-julia hljs">ControlU(n, m, U) = chain(n+m, control(k, n+1:n+m=&gt;matblock(U^(2^(k-1)))) for k in 1:n)</code></pre><pre><code class="nohighlight hljs">ControlU (generic function with 1 method)</code></pre><p>each of them is a <code>U</code> of power <span>$2^{(k-1)}$</span>.</p><p>Since we will only apply the qft and Hadamard on first <code>n</code> qubits, we could use <code>Subroutine</code>, which creates a context of a sub-scope of the qubits.</p><pre><code class="language-julia hljs">PE(n, m, U) =
    chain(n+m, # total number of the qubits
        subroutine(Hadamards(n), 1:n), # apply H in local scope
        ControlU(n, m, U),
        subroutine(QFT(n)&#39;, 1:n))</code></pre><pre><code class="nohighlight hljs">PE (generic function with 1 method)</code></pre><p>we use the first <code>n</code> qubits as the output space to store phase <span>$ϕ$</span>, and the other <code>m</code> qubits as the input state which corresponds to an eigenvector of oracle matrix <code>U</code>.</p><p>The subroutine here uses <code>focus!</code> and <code>relax!</code> to manage a local scope of quantum circuit, and only activate the first <code>n</code> qubits while applying the block inside the subroutine context, and the scope will be <code>relax!</code>ed back, after the context. This is equivalent to manually <code>focus!</code> then <code>relax!</code></p><p>fullly activated</p><pre><code class="language-julia hljs">r = rand_state(5)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>first 3 qubits activated</p><pre><code class="language-julia hljs">focus!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 3/5
    nlevel: 2</code></pre><p>relax back to the original</p><pre><code class="language-julia hljs">relax!(r, 1:3)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 5/5
    nlevel: 2</code></pre><p>In this way, we will be able to apply small operator directly on the subset of the qubits.</p><p>Details about the algorithm can be found here: <a href="https://en.wikipedia.org/wiki/Quantum_phase_estimation_algorithm">Quantum Phase Estimation Algorithm</a></p><p>Now let&#39;s check the results of our phase estimation.</p><p>First we need to set up a unitary with known phase, we set the phase to be 0.75, which is <code>0.75 * 2^3 == 6 == 0b110</code> .</p><pre><code class="language-julia hljs">N, M = 3, 5
P = eigen(rand_unitary(1&lt;&lt;M)).vectors
θ = Int(0b110) / 1&lt;&lt;N
phases = rand(1&lt;&lt;M)
phases[0b010+1] = θ
U = P * Diagonal(exp.(2π * im * phases)) * P&#39;</code></pre><pre><code class="nohighlight hljs">32×32 Matrix{ComplexF64}:
   0.0470043-0.314967im        0.167058+0.0468156im   -0.0703105-0.109735im        0.174948-0.0307941im     0.0110388+0.20281im      -0.0407272+0.00761931im    0.0178443+0.13339im        -0.203086-0.0974223im      0.149241-0.169101im     -0.0501268+0.170831im       0.121485+0.0855157im    -0.0833224-0.0241103im  -0.00740579+0.119376im     0.00781619+0.317711im    -0.0331589+0.067097im    -0.0767961+0.139081im     -0.154265+0.0809775im      0.154682-0.0868084im      0.128825-0.0416389im   -0.0567704-0.0685811im     -0.172416-0.216233im       0.235822+0.00726584im  -0.0892003-0.100005im      -0.0691081+0.145857im     0.00951861-0.0139194im     -0.192528-0.0115936im    0.0238547+0.105229im     -0.0430517-0.0133253im     0.207732-0.231948im     0.0714568-0.0729609im       0.111185+0.101968im      0.0551783+0.0352807im
   -0.163835-0.0985143im       0.141538+0.0256735im    -0.120917+0.0401256im      0.0330156-0.106462im      0.0492976-0.185332im      0.0615553-0.0913139im    0.00343729+0.0490939im       0.105904-0.0226449im    -0.0950739-0.148649im      0.0278664-0.0964812im      -0.13221+0.0633038im    0.00921667+0.0229921im     0.152958+0.314125im     -0.0941086-0.0543746im    0.0868422-0.0411281im   -0.0559922-0.0468949im    0.0565302-0.106858im        0.32078-0.0252869im     -0.164738-0.00783089im   0.0411477-0.0639186im      0.225325+0.220679im     -0.0302967+0.0691093im   -0.0655069-0.11578im         0.057705-0.201025im      -0.067221+0.0283569im     -0.122622-0.00801213im   -0.358332+0.0344338im     -0.120761-0.121417im     0.0607103-0.168292im      0.278814+0.0713384im       0.096744-0.0879405im      0.064631-0.0781255im
 -0.00695299+0.0554505im      -0.141476-0.054151im    0.00570446-0.135641im      -0.0417274+0.100593im     -0.0706003-0.124701im      -0.216921-0.209717im       0.080752-0.0782598im     -0.0378936+0.0723799im     0.0389551+0.145029im      0.0892525-0.102603im      0.0173251-0.193287im      -0.170759+0.224099im      0.205636+0.10122im     -0.00902871+0.145454im   -0.00835166+0.122323im     -0.108954-0.087018im     -0.159816+0.0753711im     0.0318522-0.108643im      0.0548036-0.090638im    -0.0226092-0.199921im      0.0239824+0.161534im      -0.166107-0.147942im    -0.0600378+0.154239im       -0.124492-0.0889325im     -0.183605-0.185594im      -0.176753-0.126937im      0.127378-0.00297377im   -0.0477538+0.0413129im     0.259871+0.0804377im    -0.131143+0.119244im        0.130977+0.152986im      -0.153157-0.136245im
    -0.10753-0.0481774im      -0.104084-0.13593im      0.0360805-0.00456592im    -0.0580853-0.320639im       0.162922+0.146578im       0.211285-0.132873im     -0.0201724-0.000659811im   -0.0671016-0.0606048im     -0.106182-0.0156169im     0.0782935+0.0821731im    -0.0975106-0.0493442im     0.0727715-0.302397im     -0.086591-0.217913im      -0.141839-0.0554196im   -0.0142591+0.0398294im    -0.167104+0.172308im    -0.0781078-0.167342im    -0.00751135-0.0575075im     0.0692297+0.00707664im   -0.141616-0.242288im      0.0622599+0.0164315im     -0.247014-0.169827im      0.183645-0.19628im         -0.06589-0.0795074im     -0.188694-0.0302202im      -0.15475+0.0756518im     0.167204-0.064238im      0.0851369-0.0580163im    0.0817282+0.020084im      0.118356+0.0144459im     -0.0395166+0.0168535im    -0.0918902+0.145832im
   -0.100158-0.0252378im       0.194207-0.123973im     -0.339362-0.142996im      -0.0289879+0.0176773im     0.0531598-0.188796im      -0.124718-0.0139725im     0.0148648+0.0922086im       0.148595+0.0588888im      0.158308+0.161634im     -0.0388393+0.00960331im    -0.148661+0.139964im      -0.207586-0.0560851im   -0.0583035-0.101876im      -0.040356-0.051759im     -0.191352+0.102766im     -0.117659+0.146836im     -0.146057+0.0489766im      0.123791+0.0513192im     -0.113445+0.123042im      0.177724+0.262562im      0.0972307-0.0398381im    -0.0396646-0.258122im      0.244824+0.00696033im   -0.00340426+0.16592im       0.0773143-0.259954im      0.0474428+0.0638484im   -0.0531505-0.0162342im      0.127724+0.114231im     -0.038233-0.0507481im  -0.00429302-0.0679363im      0.0248134-0.0330471im    -0.0827466+0.0552807im
  -0.0500996+0.215629im       0.0312695+0.192237im     -0.121495+0.177811im       0.0511923-0.00359043im     0.101423-0.0236402im      0.039472-0.311354im        0.22529+0.00993402im      0.189915+0.026676im      -0.078309+0.0483579im      0.085003+0.154866im      -0.126895-0.0186618im      0.120684+0.0945102im    -0.150805-0.0251631im     0.0206683+0.0174914im     0.149283+0.0174794im    0.0340873-0.196133im    -0.0410343+0.219245im      0.0922412-0.0916722im      0.168458-0.0402737im   -0.0513926+0.110739im      0.0930376-0.084653im       0.250572+0.0423949im     0.221706-0.128144im        0.248086+0.0176751im     0.0531266+0.0991204im      -0.14942+0.0176923im     0.168523+0.122789im      -0.059613+0.131408im     0.0459072+0.0996481im     0.119218+0.0338639im      0.0126912+0.19558im       -0.125665+0.0227808im
   0.0796035-0.0948661im      0.0287928-0.00135958im  -0.0906353-0.109121im       -0.170529+0.229988im       0.282164+0.0797302im     -0.150506-0.00635934im    0.0693677-0.105308im       0.0696805-0.0215744im     -0.219626+0.0224991im   -0.00238452+0.00295005im     0.106793+0.0976925im     0.0999175+0.0102172im    0.0790321+0.0599788im     0.0359148-0.266686im      0.106109+0.0870896im    0.0176099-0.153321im    -0.0327697+0.00488164im   -0.0390178+0.0651703im      0.446826+0.0456669im    0.0786886-0.149679im     -0.0856221-0.0368337im     -0.184575+0.0834263im    0.0278007+0.0363522im     -0.0836551+0.062138im       0.178617-0.0595255im     -0.178301-0.0625883im    -0.174322+0.00848847im     0.186304+0.0186239im     0.011121-0.175405im     0.0894435-0.16879im        -0.102859-0.142465im       -0.10437+0.0380052im
   0.0873313+0.124027im        0.256398+0.10592im      0.0657931-0.132193im       -0.180251-0.0943109im     -0.116149+0.0235829im     0.0950661-0.0291339im    0.00913551-0.160816im       0.0461108-0.133303im     -0.0377417-0.154823im      0.0758233-0.135122im      -0.142579-0.143569im    -0.00233064-0.0614749im     0.120899-0.0660565im     0.0189112-0.0695124im   -0.0729767-0.104903im       0.22323+0.0834474im    -0.132171+0.0692467im     0.0502944+0.0941903im      0.192486-0.114723im      0.216804+0.127626im      0.0075408-0.013805im      0.0366976+0.0744076im    0.0283969-0.0914257im     -0.0554595+0.0168014im     -0.162004-0.150118im      0.0640246+0.193378im      0.159434+0.162277im    -0.00118086-0.101214im       0.14023-0.269802im     -0.133087+0.246004im       -0.221142-0.0442557im     0.0738837-0.17187im
    0.143893+0.192485im        0.325902-0.0043096im   -0.0596485-0.040306im        0.100244+0.0127341im    0.00940145-0.12858im       0.0956996+0.0821642im     0.0474222+0.0606067im    -0.00552575+0.138518im     -0.0353514-0.156677im      -0.173003-0.221963im     -0.0203663-0.106887im      -0.126921+0.218183im       0.11668-0.198972im      -0.290122-0.0520735im    0.0874039+0.12589im       0.109474+0.110334im    -0.0227467-0.0343422im    -0.0207067+0.0545854im      0.192139+0.0643969im    -0.154042-0.0923367im     -0.121017-0.00626061im     0.055594-0.0905362im    0.0460819-0.0765553im     -0.0487289-0.169237im       0.162834-0.00565226im   -0.0599326-0.0435072im     0.153409-0.199454im      -0.211209-0.071569im     -0.062992+0.101561im     0.0738405-0.0992125im       0.172314-0.0897789im      0.144949+0.133618im
   -0.124284-0.0547948im      -0.112271-0.121308im    -0.0192468-0.0211484im      -0.114078-0.0146338im    -0.0806165+0.158994im      0.0280767-0.137302im      0.0378367+0.0353402im      0.0753383-0.012018im      0.0209596+0.128713im       0.253705-0.230855im       0.203389+0.255515im     0.00946298+0.171247im        0.3119-0.169383im     -0.0308999+0.0351162im    -0.127781-0.174513im   -0.00466087+0.0483892im     0.195155+0.00853126im   -0.0976659+0.199265im      0.0393928-0.0562875im   -0.0786835-0.0493273im    -0.0850388+0.089013im       0.126015+0.025412im      0.157407-0.282047im      0.00601566+0.259092im      0.0627251-0.0584582im     0.0318647-0.0412406im    -0.103945+0.012469im     -0.0662483+0.0986761im     0.099445+0.0855686im     0.133881+0.134802im       0.0648277+0.0454429im      0.182112+0.0202471im
    0.040644-0.0213967im   -0.000132674-0.190172im     -0.150091+0.0524044im      -0.106303-0.0630288im   -0.00236117+0.0855697im     -0.184741-0.118897im      -0.157037+0.144298im       0.0127833-0.0946028im      0.287894-0.0795048im     0.0909534-0.0819417im    -0.0812366-0.423088im      0.0184004-0.0409335im   -0.0445295+0.136338im     0.00213969-0.130599im     0.0496174+0.151905im    -0.0647946-0.270503im     0.0705654-0.00925028im    -0.182732-0.0923186im     -0.131323+0.0881254im   -0.0183613-0.0383177im    -0.0514504-0.109458im     0.00578736+0.0831311im     0.109186-0.0695622im     -0.0964099+0.142596im      0.0994337-0.0541812im      -0.13552+0.131148im     0.0437967+0.023776im      -0.138929-0.0415843im   -0.0365857+0.0712287im     0.131772-0.0816645im      -0.173408-0.0598878im      0.280552-0.148901im
     -0.2024+0.128772im      -0.0232597-0.133585im     0.0484801+0.0460319im      -0.182648+0.179217im      -0.141359+0.0569294im    -0.0653386-0.0133349im      0.181013-0.12029im        -0.122407+0.160755im       0.139099-0.275032im     0.00196967-0.0281091im     0.0181143+0.0880931im       0.17101-0.244057im     -0.178626+0.00871377im    -0.104852-0.183199im     0.0324523+0.0610736im   -0.0393917+0.0869251im   -0.0192807+0.148791im       0.106971-0.043889im     -0.0612333-0.0994254im   -0.0982511-0.119612im       0.062089+0.00250615im     0.118247+0.0220854im   -0.0911958+0.194056im       -0.059315-0.0144281im      0.176576-0.244111im      0.0325767-0.0579408im   -0.0745787-0.00394772im    -0.192083+0.179931im     0.0971868-0.0332824im   -0.0050889+0.215373im      -0.0752622-0.00457159im    0.0555841+0.27927im
    0.114084+0.0710191im     -0.0619354-0.174267im     0.0290113-0.0136022im      0.0101971+0.134259im     -0.0699793-0.0867857im     0.0405049-0.300328im     0.00753549+0.0368771im      0.0416492+0.1277im      -0.00530469-0.0287772im     0.0277115+0.0139429im     -0.275893-0.00467153im  -0.00335419-0.206555im     0.0782347-0.20349im        0.127913-0.0665354im   -0.0113859+0.0796002im   -0.0338363-0.0170523im      0.26111-0.0697128im     0.0410345+0.0545043im     0.0544143+0.0785726im    0.0801106+0.0772235im     -0.144351-0.0626151im      0.209584+0.0119022im    -0.129826+0.0740653im     0.00715502+0.111183im      -0.298718+0.0782969im     -0.187222-0.15762im      -0.143718+0.109009im     0.00656941-0.253639im     0.0357992-0.0504573im    -0.214962-0.144991im        0.190161-0.0882303im     0.0683855+0.182653im
  -0.0482066+0.0402669im    -0.00736815+0.0463939im   -0.0488181+0.255755im       0.0625857+0.0828986im     -0.132708+0.0234954im      0.140071-0.0679767im     -0.044506-0.232412im       -0.121841+0.0350072im     -0.144609+0.0567012im     -0.150967+0.161993im      0.0847434-0.0312317im     -0.189112+0.103685im     0.0177525+0.151345im       0.188727-0.0651664im    -0.169257+0.263908im     -0.258922+0.0475833im   -0.0606035-0.0389077im     -0.234916+0.326873im      0.0350446-0.071446im      0.124524+0.0980128im      0.108404+0.104639im       0.132224-0.0400137im    -0.068895-0.0912977im     -0.0906186+0.00094115im   -0.0988165+0.00583336im   -0.0746013+0.102982im     0.0541443-0.0591503im     -0.185165+0.019133im     0.0770714-0.0116518im     0.190056-0.0548428im      -0.178881-0.121739im    -0.00676533+0.146339im
  0.00552022+0.0314254im      0.0100891+0.0956762im    -0.204039+0.0136559im      -0.183603+0.0238121im    -0.0645429-0.108426im     -0.0156499-0.173259im     -0.0278949+0.0300533im       -0.36594-0.08829im     -0.00596274-0.0787321im    -0.0891876+0.0660079im       0.17756-0.139644im     -0.0424013+0.0263577im     0.015132-0.137663im    -0.00625468+0.0921587im     0.474677-0.251612im     -0.223251+0.0562869im     0.120631-0.155645im      0.0257661+0.00953018im    0.0449323-0.00155918im    0.205073+0.22487im     -0.00693563+0.0475473im     -0.112247-0.0824047im    0.0832489+0.052391im      -0.0638975+0.0435624im     0.0358103+0.0721651im     0.0638827-0.209124im     0.0378417+0.0184899im     0.0535264+0.0461728im   -0.0705717-0.0819956im    0.0724084+0.125161im      -0.0189977+0.0707655im     0.0834621+0.0713472im
   -0.122821+0.0770652im     -0.0893205-0.0722536im    -0.279603+0.0739664im      0.0105308+0.202202im     -0.0221942+0.0336281im      0.175704+0.159103im      -0.200894+0.172747im      -0.0117521+0.121014im       0.196396-0.0674768im      0.122427+0.0533677im    -0.0432114+0.157025im      0.0558191-0.0185371im     0.162603+0.0232932im     0.0274732-0.145116im    -0.0737952-0.164174im     0.0952107-0.247932im     -0.172224-0.101473im      0.0588573+0.00737433im     0.137228-0.115302im    -0.0719444+0.192294im     -0.0202924-0.0908925im    -0.0542594-0.181524im     -0.168164-0.029797im        -0.12573-0.268667im       -0.10132+0.194546im     -0.0965448+0.0270786im     0.127103-0.0418708im      0.139285+0.142474im      0.155889+0.0289035im   -0.0198537-0.00621404im    -0.0629652+0.0793817im      0.152905+0.0345635im
   -0.081386-0.22346im        0.0775215-0.0366044im    -0.119765+0.057298im       0.0528042+0.0794852im     -0.199536+0.0531975im     0.0221588+0.0515342im       0.11917-0.0214442im       0.190674+0.0326702im      -0.23983+0.196798im      0.0932879-0.000357142im   0.0444629-0.0597274im     0.0590101-0.0707216im    0.0320276-0.121658im      0.0158403-0.0166573im     0.175585+0.112422im     0.0562614-0.075556im    -0.0989073-0.294091im       -0.15772-0.0377914im    -0.0759968+0.16705im      0.0200133+0.0718993im     0.0391459-0.202883im     -0.0970669+0.0876144im    -0.199171+0.100115im        0.211116+0.00172732im    0.0703281-0.191658im      0.0835033+0.0983661im     0.088774-0.137791im     -0.0922078-0.149493im      0.175341-0.155841im     0.0534795+0.0958417im       0.112808+0.304251im       0.118793+0.0734443im
    0.100876+0.0266099im      0.0880945+0.115691im     -0.154979-0.146752im        0.157938+0.133436im       0.228526+0.0991966im     0.0491781-0.0202763im      0.303368-0.0447108im     -0.0361739-0.0684329im     0.0239439+0.124707im     -0.0497807+0.0952455im     -0.127648+0.0473098im     0.0729838+0.0421258im    0.0499672-0.0422359im      0.169675-0.262208im     0.0671574+0.0358051im   -0.0828176+0.195441im    -0.0759554-0.0281414im    -0.0824786-0.28565im       -0.138418-0.143392im     0.0230272-0.0506138im     -0.107158+0.0324832im    -0.0441206+0.0420739im   -0.0829283-0.0971695im      -0.152454-0.00172877im    -0.168404-0.00798544im     0.314315-0.0627339im   -0.0608932+0.13638im      -0.0605565+0.0141279im      0.11333+0.261343im     0.0950981+0.000855929im  -0.00477494-0.0442182im      0.244809-0.075854im
  -0.0663435-0.0568075im      0.0373318-0.0761138im    0.0689853+0.090691im      -0.0704142+0.224542im       -0.15182+0.016919im       0.204837+0.147579im        0.11616-0.0399692im       0.104862-0.316275im      0.0158637+0.0650093im     0.0799156-0.163951im      -0.215412-0.130378im     -0.0799706-0.1098im      -0.0372381+0.0945009im     0.0901667+0.130664im     0.0734013+0.0650793im     0.187325+0.0983653im    0.0422316-0.0484603im      0.146049+0.064572im     -0.0571538-0.105932im     0.0201212-0.00243438im    -0.121427+0.249197im      -0.144224-0.0630586im    0.0772325+0.135976im      -0.0917611+0.160289im       0.193786+0.195714im     -0.0359175-0.0458401im     0.173001+0.192354im      0.0370314+0.0836985im     0.120566+0.0552323im     0.189256-0.230068im       0.0744644+0.0359509im    -0.0476039+0.139334im
   0.0252588-0.147936im         0.04896+0.234323im     -0.141609+0.133757im         -0.2015-0.0648038im      0.162972+0.135186im     -0.0789103+0.0708538im       0.14442-0.069946im       0.0270669+0.0884781im    -0.0123115-0.0487701im     0.0906687-0.00801514im   -0.0840268-0.0239463im    -0.0391615-0.0855367im     0.161883-0.111415im      -0.154185+0.323507im     0.0491636+0.120774im      0.055359-0.238869im     -0.135285-0.0371635im    -0.0670874+0.131931im      -0.208231-0.0711362im      0.21549-0.230736im       0.162268+0.0292111im      0.149701+0.0425561im    0.0125969+0.024525im      -0.0221505-0.0629039im    -0.0755255+0.0389148im     0.0635859-0.043891im     0.0412566+0.0132491im      0.173715+0.136809im    -0.0577177+0.0767698im    -0.182013-0.0588479im      0.0403671-0.198318im       0.183977+0.211373im
  -0.0910575-0.133724im      -0.0163575+0.0603682im    0.0232517-0.231809im       0.0609226+0.0355925im    -0.0881374-0.174878im       0.186146-0.0940666im     0.0941278-0.157208im       0.0117088+0.0975403im      0.130488-0.244698im       0.203481-0.0634918im    -0.0309366+0.021299im     -0.0610873+0.108052im     -0.118078-0.0518858im     0.0267867+0.0922725im   -0.0769245+0.0101076im    -0.108451-0.0613299im      0.17034-0.146769im      -0.086232+0.05243im        0.113699-0.293617im     0.0263173-0.0970518im      0.144727-0.401132im      -0.176988-0.0115745im     0.121925+0.151601im        0.151846-0.0299481im    -0.0437944+0.0404976im      0.159556-0.0145677im   -0.0322653+0.00133277im    -0.109588+0.105344im   -0.00506498-0.0173488im    0.0823802-0.256757im      -0.0308933-0.0784243im   -0.00549813-0.142697im
   0.0173256+0.104523im      -0.0664355+0.255243im     0.0588117-0.04093im       0.00335024-0.106277im     -0.0559445-0.146277im    -0.00753004-0.041158im      -0.106801-0.0898851im     -0.0224561+0.148318im      0.0957757-0.023826im      -0.155321+0.101866im      -0.144981+0.142186im       0.164564+0.0308797im     0.010598-0.0417321im     0.0470212+0.105714im    -0.0532756-0.06058im      0.0526861-0.270591im     -0.118198+0.0577056im      -0.11783+0.105832im     -0.0839262+0.094631im    -0.0196926-0.160364im       -0.28769+0.0951804im     -0.254644-0.256642im    0.00777044-0.072314im     0.000848557+0.0650984im     0.0699112-0.132034im      0.0989574+0.0329393im   -0.0906602+0.310889im      -0.147106-0.12442im     -0.0414661-0.163614im       0.14199-0.0871331im     -0.0176683+0.190009im       0.108756+0.164388im
   -0.064605+0.0679271im      0.0673585-0.166344im     0.0554134-0.264686im       0.0388543+0.224692im     -0.0177623+0.0365787im    0.00912903+0.159921im    -0.00710111-0.197404im       -0.175781+0.111305im      -0.101688-0.0419863im      0.173437+0.0284454im      0.178815-0.0891681im      0.123365-0.0797687im   -0.0533689-0.116777im      -0.124091+0.093091im     0.0358955+0.0595645im   -0.0906082-0.117927im     -0.109995+0.134528im      0.0344739-0.060237im      -0.100992+0.203507im      0.225907+0.102756im     -0.0384532+0.141761im     -0.0204369+0.0256268im     0.203333-0.21023im        0.0463622-0.070879im     -0.0430109+0.291805im    -0.00605391+0.239596im     -0.191518+0.00393611im    -0.177922-0.0136603im      0.16688+0.0661759im    -0.110678-0.143901im       0.0537152+0.0706467im    -0.0337823-0.0385957im
  -0.0725644-0.221302im       -0.173652-0.00766397im  -0.0190483-0.0380174im      -0.176735+0.0583013im     -0.205411+0.11052im      -0.0639715-0.0190793im     0.0578458+0.0147488im      0.0693401+0.0381926im   -0.00765105-0.0220455im     -0.200202+0.129274im     -0.0207825-0.0413408im    -0.0354765-0.0272968im    0.0103054-0.0666089im   -0.00450952-0.131417im     0.0407089+0.0921319im    0.0590335+0.133795im     0.0467704+0.247416im      -0.149898+0.0671511im     -0.001657-0.156525im     -0.071978+0.0211068im      0.190008+0.056086im       0.122105-0.131295im      0.217884-0.10223im       -0.0679118-0.365545im       0.170749+0.0529808im     0.0607728-0.105854im    -0.0221241+0.109815im       0.145699-0.280421im   -6.55274e-5-0.108631im     -0.045701-0.149971im        0.130858+0.162974im       0.144833-0.21721im
  -0.0924026+0.111907im       0.0253733-0.0695481im     0.116104-0.0391653im   -0.000584393+0.197448im      0.0247917-0.014334im     -0.0422519-0.0714021im     -0.195771+0.0926187im     -0.0488236-0.0506149im  -0.000202519-0.012966im       0.301588+0.288708im      -0.191179+0.0492839im     0.0758202+0.283913im    -0.0922891-0.130827im      -0.177677+0.17932im     -0.0714849+0.20022im     -0.0800083+0.0624401im    0.0194737-0.169597im      -0.114667-0.109601im     0.00501263+0.0225227im   -0.0494688+0.0531941im     -0.121364+0.196157im       0.103743+0.155492im    -0.0117304+0.0457905im      0.0408591-0.179026im       0.133805-0.106219im       0.139873-0.0336281im    0.0709239+0.0932737im      0.220009-0.057464im      0.035952-0.179795im      0.153281+0.10565im       -0.0360366-0.212982im      0.0106369-0.0256341im
    0.150144+0.0631863im       -0.12693+0.042003im      0.159252+0.0992723im      -0.126832-0.170263im      0.0141372-0.113461im       0.069251+0.364465im     -0.0941745-0.0288713im     -0.0468355+0.0928536im      -0.01421+0.105207im        0.12305+0.00260295im   -0.0811706+0.0598305im     -0.172637-0.0732917im    0.0432699-0.206199im       0.167523-0.0696633im    0.0624674+0.234328im    -0.0486127-0.0571956im   -0.0774843-0.0665783im     0.0746587-0.227322im     -0.0482608-0.219016im     0.0974539+0.104836im     -0.0511874-0.0540748im     0.0206184+0.109582im     0.0804889-0.210374im         0.02095-0.000261066im    0.120866-0.0942424im     -0.200325-0.337503im     -0.100757-0.0215546im     -0.180581+0.157659im   -0.00223366-0.14818im      0.0199256+0.0122494im    -0.00010987+0.0532021im     0.0194738-0.107736im
   -0.123868+0.183309im       0.0881206+0.23107im       -0.10447-0.0848766im       0.082201+0.0863693im      -0.28498-0.117954im      0.0465718-0.029442im       0.227319+0.108547im       -0.131166-0.100657im      0.0620162+0.241444im     -0.0175656+0.144866im     -0.0452794-0.0173965im     0.0790925-0.269263im     0.0919424+0.0312959im    -0.0385125+0.085535im    -0.0792806+0.135133im     0.0868237+0.041681im       0.18702-0.0243065im    -0.0709102-0.0017984im     0.0535497+0.0638498im   -0.0371923-0.240531im      -0.110235+0.0521423im   -0.00962405-0.0563239im   0.00986137-0.0710111im      0.0339782-0.00655241im   0.00498429+0.0921645im     -0.139725+0.0189011im    -0.129361-0.304019im      0.0904574+0.199893im     -0.122113-0.159607im    -0.0678817+0.0449118im      -0.157425-0.00180182im    0.0987553-0.2313im
  -0.0987247-0.0301289im      0.0526504-0.158663im      0.134802-0.0921963im     -0.0198727-0.105176im      0.0457377+0.168565im      0.0541101+0.0903408im      0.346113-0.144105im       0.0195571+0.2785im         0.137279+0.226725im      -0.131908-0.139325im      -0.116841-0.00771846im    0.0951809+0.172579im    -0.0361892+0.222844im      -0.216789+0.0556374im   -0.0607498+0.0350511im    -0.232549-0.042365im      0.109087-0.0482076im     0.0507734+1.36537e-5im    0.0234125+0.0449679im   0.00551671+0.214778im     -0.0386701-0.0404573im     -0.112319+0.0656798im   -0.0720949-0.0866252im     -0.0269397+0.00731622im   -0.0197993+0.176049im     -0.0919711-0.158992im      0.179854+0.10931im        0.101573-0.0455149im    -0.168597-0.187444im    -0.0511049+0.0680936im      -0.161852+0.066167im       0.128962+0.052953im
    0.241831+0.121247im       -0.232551-0.152592im     -0.110289-0.195563im    -0.000928923-0.0247844im    -0.0464244-0.136386im      0.0430396+0.100576im       0.261737-0.124401im       0.0483078-0.308018im     -0.0752124-0.153958im       0.196071+0.222568im     0.00190996-0.181047im     -0.0345538+0.172394im   -0.00480973+0.00716709im    0.0225565-0.137126im     -0.126554-0.146598im    -0.0950511-0.0478529im    -0.224573-0.0342106im     0.0853216+0.1831im        -0.146601+0.0933974im     -0.17498-0.0890167im     0.0864434-0.0498077im       0.10552-0.0567582im   -0.0942436-0.0883744im   -0.000337022+0.0732077im     0.0718078+0.0716544im    -0.0156237-0.0729689im   -0.0176403-0.0457101im     0.0535641+0.0224142im    -0.201342-0.178563im    -0.0419373+0.0287213im      0.0874457+0.0557675im     0.0796399+0.118307im
   -0.161486+0.230639im     -0.00721782+0.155559im     -0.197614-0.15088im        -0.131103-0.260671im      -0.182063+0.222138im     -0.0241549+0.195648im     -0.0691381-0.0757915im       0.123593-0.0120575im    -0.0771688+0.0346316im     0.0445705+0.0281883im    -0.0405178+0.0261886im     -0.136676+0.13149im      -0.151691-0.0650485im    -0.0915708-0.0413819im    0.0234962-0.154182im     -0.158238-0.0756482im     0.118628+0.0719059im      0.100296-0.171187im      0.0554011-0.0355696im    0.0491805-0.0947797im    -0.0289684+0.126067im       0.172685-0.0410197im    -0.176667+0.152567im      0.00643728+0.148096im     -0.0193189-0.0222105im     0.0161007-0.0529129im   -0.0318956-0.183586im      0.0496678-0.23596im       0.200921+0.054845im     0.0471757-0.303463im       -0.165097+0.0213304im   0.000531904+0.0181732im
   0.0371694+0.00928801im     0.0338648+0.0170708im    0.0946825-0.0145406im     -0.0412082+0.168449im      -0.171089+0.11335im        0.066624-0.0774547im    -0.0802288+0.0380771im       0.177072+0.0847319im     0.0601415+0.00236665im  -0.00928326+0.0471194im     0.0449036-0.0906605im     0.0388907-0.17217im       0.207522+0.150038im      -0.124169+0.019488im      0.142684-0.0396933im    -0.106132-0.00825636im   -0.317955+0.0637245im    -0.0824272-0.130087im    -0.00989253-0.13346im      -0.117348+0.0574406im    0.00988675-0.0262215im    -0.0471655-0.239603im    -0.0503394-0.178232im        0.301416+0.251922im      0.0281291+0.0910312im      0.153775-0.21872im     4.77338e-6-0.0874346im    -0.0310082-0.155384im    -0.0395078-0.0114663im    0.0141242+0.0323862im     -0.0217323-0.375486im      -0.160994-0.0195321im
    0.327822-0.0222462im      -0.190881-0.0184821im    -0.150728+0.0740537im       -0.13996+0.0484631im     0.0161492-0.00271482im      0.13679-0.0161785im      0.161813+8.25935e-5im    -0.0104425+0.22921im        0.132965+0.168738im      0.0336761+0.0777336im      0.143599+0.0421112im    -0.0515688-0.0574611im    0.0971317+0.013272im      0.0359648+0.026776im     0.0732052-0.105005im   0.000533587+0.0330614im     0.119183+0.0280469im      0.295019+0.0881186im     -0.202998+0.113249im    -0.0658707-0.0782763im     -0.225564-0.0423984im     0.0403776+0.105131im      0.136878+0.0755725im      0.0547429-0.213611im      0.0169689-0.104455im      0.0842468+0.170862im       0.20863-0.0380608im    -0.0935009-0.108113im      0.152663-0.138461im       0.12498-0.0978847im      -0.145336-0.22376im        -0.15219-0.0928087im</code></pre><p>and then generate the state <span>$ψ$</span></p><pre><code class="language-julia hljs">psi = P[:, 3]</code></pre><pre><code class="nohighlight hljs">32-element Vector{ComplexF64}:
   -0.07314572775307149 - 0.046299658836818455im
  -0.019950463459308104 + 0.030123551054790625im
    0.11088062076326961 + 0.07616911224241793im
   -0.13379020128430974 - 0.17815778146039252im
   -0.04454116123460912 - 0.09538899140486638im
     0.0761778216090977 + 0.0012393315647581393im
 -0.0009588922097174962 + 0.1772819216303137im
    0.14207948901744163 + 0.0850749031864069im
   -0.03745397515488988 - 0.1168762840985693im
  -0.025018956502067806 + 0.04003711490516365im
     0.3459328096118841 + 0.0im
   -0.15745936752592476 + 0.008341238140607693im
   -0.02588093714188651 - 0.21450979116575im
    0.21482385231395568 + 0.0603107945212743im
    0.08392222872360565 + 0.0032906822940138372im
   0.028040460637962776 - 0.014732490534003847im
   -0.20135319347303038 - 0.18468884007008202im
    0.11982125060549764 + 0.1620523611545923im
 -0.0007699340480196715 + 0.16212124419650503im
   -0.15118861119952354 - 0.24622044837748275im
   -0.20136325619635512 - 0.06544123348046664im
    -0.1341645573215748 - 0.1488776993658428im
    0.14663500184217454 + 0.06337145485369683im
  -0.018942702423393777 + 0.11867570690922088im
    0.04445166214952061 + 0.012931021196544192im
   -0.03486779125727685 + 0.18385862195302283im
  -0.013188637225419332 - 0.13722742145880226im
    -0.0178715077896535 + 0.05567441239108283im
   -0.03427335662084931 - 0.07590083854595348im
    0.12398232055585418 - 0.06810392529367021im
  -0.055949735518560834 + 0.3308813380494727im
    0.02557669010232462 + 0.17770248434714128im</code></pre><p>In the phase estimation process, we will feed the state to circuit and measure the first <code>n</code> qubits processed by iQFT.</p><pre><code class="language-julia hljs">r = join(ArrayReg(psi), zero_state(N))
r |&gt; PE(N, M, U)</code></pre><pre><code class="nohighlight hljs">ArrayReg{2, ComplexF64, Array...}
    active qubits: 8/8
    nlevel: 2</code></pre><p>Since our phase can be represented by 3 qubits precisely, we only need to measure once</p><pre><code class="language-julia hljs">results = measure(r, 1:N; nshots=1)</code></pre><pre><code class="nohighlight hljs">1-element Vector{DitStr{2, 3, Int64}}:
 011 ₍₂₎</code></pre><p>Recall that our QFT&#39;s bit numbering is reversed, let&#39;s reverse it back</p><pre><code class="language-julia hljs">using BitBasis
estimated_phase = bfloat(results[]; nbits=N)</code></pre><pre><code class="nohighlight hljs">0.75</code></pre><p>the phase is exactly <code>0.75</code>!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1.prepare-ghz-state/index.html">« Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a><a class="docs-footer-nextpage" href="../3.grover-search/index.html">Grover Search »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 14 August 2025 11:05">Thursday 14 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
