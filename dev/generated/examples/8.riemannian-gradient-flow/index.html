<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Riemannian gradient flow optimizer · Documentation | Yao</title><meta name="title" content="Riemannian gradient flow optimizer · Documentation | Yao"/><meta property="og:title" content="Riemannian gradient flow optimizer · Documentation | Yao"/><meta property="twitter:title" content="Riemannian gradient flow optimizer · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor Network Backend</a></li><li><a class="tocitem" href="../../../man/paulipropagation.html">Pauli Propagation Backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li><a class="tocitem" href="../2.qft-phase-estimation/index.html">Quantum Fourier Transformation and Phase Estimation</a></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li class="is-active"><a class="tocitem" href="index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Riemannian gradient flow optimizer</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Riemannian gradient flow optimizer</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/8.riemannian-gradient-flow/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/8.riemannian-gradient-flow/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="Riemannian-gradient-flow-optimizer"><a class="docs-heading-anchor" href="#Riemannian-gradient-flow-optimizer">Riemannian gradient flow optimizer</a><a id="Riemannian-gradient-flow-optimizer-1"></a><a class="docs-heading-anchor-permalink" href="#Riemannian-gradient-flow-optimizer" title="Permalink"></a></h1><p>In this tutorial we will present the Riemannian gradient descent algorithm described in <a href="https://arxiv.org/pdf/2108.13401.pdf">Miao and Barthel (2021)</a> and <a href="https://arxiv.org/pdf/2202.06976.pdf">Wiersema and Killoran (2022)</a> As opposed to most standard optimization algorithms that optimize parameters of variational quantum circuits, this algorithm optimizes a function directly over the special unitary group by following the gradient flow over the manifold. Let&#39;s start by importing the necessary packages.</p><pre><code class="language-julia hljs">using Yao, Yao.EasyBuild, Plots, Random
using KrylovKit: eigsolve</code></pre><p>Variational quantum eigensolver (VQE) is one of the most celebrated near-term quantum algorithms. In the usual setting, VQE tries to reach the ground state by minimizing the energy cost function</p><p class="math-container">\[\mathcal{L}(\theta) = \text{Tr}\{HU(\theta)\rho_0U^\dagger(\theta)\},\]</p><p>with respect to parameters <span>$\theta$</span> which parameterize a quantum circuit <span>$U(\theta)$</span>, where <span>$\rho_0 = |\psi_0\rangle\langle\psi_0|$</span> is some initial state and <span>$H$</span> the Hamiltonian whose ground state we want to approximate. We can solve the optimization problem <span>$\text{min}_\theta\mathcal{L}(\theta)$</span> by following the direction of the steepest descent in parameter space which is given by the gradient of the cost function, i.e. by considering the following gradient flow</p><p class="math-container">\[\dot{\theta} = -\text{grad}\mathcal{L}(\theta).\]</p><p>Discretizing the equation above, we recover the well-known gradient descent algorithm</p><p class="math-container">\[\theta_{k + 1} = \theta_k - \alpha\text{grad}\mathcal{L}(\theta),\]</p><p>where <span>$\alpha$</span> is the learning rate. Let&#39;s demonstrate it on the example of finding the ground state of the transverse field Ising model.</p><pre><code class="language-julia hljs">n = 8
h = transverse_ising(n, 1.0)
w, v = eigsolve(mat(h), 1, :SR, ishermitian=true)

Random.seed!(0)
circuit = dispatch!(variational_circuit(n, 100), :random);
history = Float64[]
for i in 1:100
    _, grad = expect&#39;(h, zero_state(n) =&gt; circuit)
    dispatch!(-, circuit, 0.01 * grad)
    push!(history, real.(expect(h, zero_state(n)=&gt;circuit)))
end

Plots.plot(history, legend=false)
Plots.plot!(1:100, [w[1] for i=1:100])
xlabel!(&quot;steps&quot;)
ylabel!(&quot;energy&quot;)</code></pre><img src="data:image/png;base64,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z02rSKkIwUN6ASBoEITnbHCKXEXvKAAEC4LwnA1JlWvoHQWAYEEQnjMGjgJAMPEehNdee+37779fV1fn42oCQocYaavTDteQhQAQDLwH4eHDh6+++urMzMyHHnpo//79Pq7Jz0khBqco9I4CQHDwHoSrV6/evHnz2LFjX3311TZt2lx66aWLFy+mgegxJIXThAAQJBo9R9i7d+833njjp59+ev3118vLyydMmJCZmfnAAw/QQBRCDGHgKAAEizMMlomKirr55ps3bNhw1113FRcXP/PMM23atJkwYcLevXt9U59/6hYnS05qJSf1rgMA8IedIQgLCgruv//+li1bvvTSS8OHD1+8ePHLL7+cl5fXr1+/4uJi35TohxQpBibLNUUuvQsBAPxR3oOwtrZ20aJFw4cPb9eu3VtvvTV58uTdu3cvX778qquuuuOOO7Zu3app2jfffOPjWv3KkBSFiygAIAiYvc7t1q3b7t27+/XrN2fOnIkTJ4aHh9dfGhUVlZ6efuLECZ9U6KeGpMhb19IiBICA5z0Ir7jiiokTJ/bq1auxf7Zjx45mKykw9E6Qhce1SoeIDdO7FADAH+A9CJ955hkf1xFwzIoYmCxXFblys7g7DwAEMO9BuHr16tra2t/PT0pKys7OjoqKauaqAsMlacqKo1pult51AAD+AO9BOGHChNMMCh0+fPhbb72VlWX0BLgkTU5eyWlCAAhs3rv13nzzzaSkpBtuuOHDDz9cs2bNokWLxo0bl52dvWTJkhdffHHbtm1jx451uYyeAT3iZekp7Sg3HQWAQCY1zctxfMiQIaNGjXrooYfqz5w2bVptbe2//vWvDRs2DBw4cO3atYMGDfJVnb9htVrLy8sbjGX1sNlskZGRvqnkqhVqbpac3IbThEJVVYfDYbVa9S7EcOx2u8ViURS+hL7my0MN6mvyPe/lj6eysnLNmjVXXnllg/lXXnnlJ598IoQYMGBAcnLyvn37mrCOAHVJmlzxEy1CAAhgXoJQVVUhxIEDBxrMP3DggHuRECI8PDwsjOsGxCVpcsVRghAAApiXIExISOjdu/ff/va3jRs3emZ+8cUXjzzyyMiRI4UQ5eXlR44cyc7O9lmVfqtdtBRC7K0mCwEgUHk/r/DOO+84HI4BAwakpKR07tw5Pj5+1KhRqampr776qhBi7969N91002kutzeU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1auX+yrLAQMGhIeHr1u3Tu+iglZaWprnCu7U1FSHw+FZVFpa+vnnn2/fvl3jEtXmUVZW9vnnn2/bts2zh7/99tuoqKh+/foJIbKysrp16/bFF1/oWmMwe/vtt0eNGuW5oNvlcn399dfffvttTU2NvoUFDSml10vgP/3006uuusr9evz48Z999pkQYvXq1QkJCb169RJCtGrVqlOnTsuXLz/XLQZPEB49ejQjI8MzmZ6efvToUR3rMQhVVWfNmnXTTTe5J00m0/79+19//fWRI0defPHFHBqanKIoBw8efP3110ePHj1s2DD3Y4D48vuMy+V65513pk6d6pkTGxv78ssvT58+vXXr1mvWrNGxtqB39OjR9PR092vPl7xJvvzBE4SqqkopPZNms9npdOpYjxFomnbbbbeZTKZHHnnEPeeBBx7YuHHjJ598UlBQYLPZXnjhBX0rDD733nvvpk2b3HvY4XA899xzgi+/Dy1btszhcIwZM8Y9mZOTU1hY+Mknn+Tn50+fPt3zixDNof733GQyub/kTfLlD54gTE1NLSkp8UwWFxenpaXpWI8RzJgx44cffvjkk088Axc9NyC2Wq25ubnfffedftUFJ88eDg8P9+zhBl/+oqIivvzNZM6cOVOmTAkJCXFPKoriOQpfc801e/bssdvt+lUX5FJTU0tLS92vPUf4JjnyB08QDh06dOPGjcePHxdCFBQUHDt27DzH0eLsPPjgg2vWrPnPf/4TGRnpdYX8/HzPZRVoDp49PGDAgMOHDxcWFgohqqqq8vLyeABLcygvL//ss89uuOEGr0vz8/Pj4+OtVquPqzKOiy66yHPye/ny5cOGDRNCDBw4cP/+/QcPHhRCVFRUbNmy5Ty+/MFzHWHHjh0vu+yyMWPGjB8//u2337799ttjY2P1LipozZs37+mnn7766qsfeOAB95x//OMfoaGhY8eO7dy5c2xs7Lfffrthw4a8vDx96ww+48aNa9++fXx8/Lp169asWbNp0yYhRHx8/K233jpu3LipU6cuXrw4Nze3bdu2elcahP71r3/16tWrU6dOnjkvvfTSjh072rdv/9NPP82ZM+fZZ5/Vsbxg8uijjxYVFdnt9meeeSY5OXnWrFkJCQkzZswYOHBgVFSUpmnz58/fuHGjECIpKWnatGm5ubnXX3/9woULr7766vN4JEhQPX2irq5u3rx5e/bs6dOnz/jx4+t3HKNpbd++ff369fXnTJ061Ww2r1y5ct26dSdOnMjKypo4cWJMTIxeFQarVatWrVu3zmazZWZmTpw40fNrT9O0xYsX5+fnd+jQYfLkyWZz8PzG9R+ff/55YmJi/SfhHThwYOnSpYcPH46NjR0xYkSPHj10LC+YLFq0qKqqyjM5adIk9+Xze/fuXbBggZTymmuuadOmjXupy+VatGjR999/36lTpz//+c/n8eUPqiAEAOBcBc85QgAAzgNBCAAwNIIQAGBoBCEAwNAIQgCAoRGEAABDIwgBAIZGEAIBYMOGDe+8847eVQDBiSAEAsD7779/9913610FEJwIQsDvlJaWVldXn+XKDoejqKjo1KlTja1QU1NT//b89dlstpKSEpfLdT5VAsGCIAT8haZpjz32WExMTFJSUkxMTExMzKxZs4QQt99+++zZs8vLy+Pi4uLi4jz3FK6oqJgyZUpsbGxqampUVNSkSZMqKyvdi3bt2hUXF/fuu++OHTs2KioqOTm5R48e33//vWdbH3zwQevWrd2LwsPDx44d6/vPC/gJ7swL+Iv58+c/+eSTL7744ogRI1RV3blzp/vpa3/9619LSkq+/PLLRYsWCSHc9xR2OBzDhw8vKyt7++23u3fvvnPnzhkzZlx55ZXffPONEEJV1crKyhkzZkyaNCk/P7+4uPiOO+4YOXLkzp074+PjDxw4cM011/zlL39ZsmRJeHj4gQMHVq5cqetHB3SlAfAPM2bMyMnJ8bro7rvvTkhIqD/nzTffFEJs3rzZM+fzzz8XQmzatEnTtB9++EEIMXToUM/S7du3SymffvppTdM++ugjIcTBgweb41MAAYeuUcBf9OzZc//+/ZMmTfrss89OnDhx+pWXL1+ekJBQWVn51S+cTqcQwh2BbuPHj/e87tKlS/v27d1PtO/SpUtISMiECRPmzp1bXFzcPJ8GCBh0jQL+YvLkySUlJa+99trChQvDwsJGjBjx/PPPt2vXzuvKxcXFVVVVEyZMqD8zNja2oqLCM5mSklJ/aWpq6uHDh4UQrVu3/vDDDx977LEbb7xRCNGnT58nnnhi5MiRTf+RgEBAixDwF4qi3HPPPYWFhbt3737uuefy8vJGjx6tNfLE0Ojo6IyMjIrfqX+VRVlZWf1/Ulpampqa6n79pz/9KS8vr6ioaP78+S6Xa+zYsXv37m2+jwb4M4IQ8Dvt2rW74447Hn744cLCQnfXZYsWLU6ePFl/naFDhx44cGDTpk2neZ9ly5Z5Xh84cGDXrl1dunSpv0JSUtKkSZPmzp1bW1ubn5/fpB8CCBgEIeAvnn322Xnz5h0+fNjlcu3bt+/999/PyMhITk4WQnTu3Lmmpubll1/euHGj+yqIadOmtW7desKECR9//HFlZWVFRcX69eunT5/u7vx0+/rrr59//vnjx4/v3r178uTJFovlpptuEkJ8/PHHzz777O7du2tra93jTk0mU/fu3fX64IDO9B6tA+BnM2fOjIiI8PxtduvWLS8vz73I6XTedtttKSkpUsqYmBj3zEOHDo0ePVpK6V7fZDINHjy4uLhY+2XU6CuvvNK1a1f30uTk5OXLl7v/4UcffZSUlOTZUHJy8jvvvKPLRwb8gdQaOQMBwPfq6ur27dt3/Pjx1NTUjIwMT8idRllZWWFhodVqzczMjIqKcs/csWNHly5dPv7448svv3zXrl12u71r166hoaGef6Vp2qFDh4qLi2NiYnJyckJCQprrIwF+j1GjgB8JCQnp0KHDOf2ThISEhISExpZKKTt27Oh1flZWVlZW1jmXCAQdzhECAAyNIASCUFpa2htvvMH4F+BscI4QAGBotAgBAIZGEAIADI0gBAAY2v8H6ueavpU+XhEAAAAASUVORK5CYII=" /><p>Let&#39;s now consider the energy cost function directly over the special unitary group <span>$\mathcal{L}: \text{SU}(2^n) \rightarrow \mathbb{R}$</span></p><p class="math-container">\[\mathcal{L}(U) = \text{Tr}\{HU\rho_0U^\dagger\}.\]</p><p>To minimize the cost function we can follow the Riemannian gradient flow defined through the following differential equation</p><p class="math-container">\[\dot{U} = -\text{grad}\mathcal{L}(U) = [U\rho_0U^\dagger, H]U.\]</p><p>Discretizing the flow we get the following recursive update rule</p><p class="math-container">\[U_{k + 1} = \exp\{\alpha[U_k\rho_0U^\dagger_k, H]\}U_k = \exp\{\alpha[\rho_k, H]\}U_k,\]</p><p>where <span>$\alpha$</span> is the appropriate learning rate and <span>$U_0 = I$</span>.</p><p>We can expand the commutator in the exponent in the basis of Pauli strings <span>$P^j$</span></p><p class="math-container">\[[\rho_k, H] = \frac{1}{2^n}\sum_{j = 1}^{4^n - 1}\omega^j_kP^j,\]</p><p>where</p><p class="math-container">\[\omega^j_k = \text{Tr}\{[\rho_k, H]P^j\} = \text{Tr}\{[H, P^j]\rho_k\} = \langle[H, P^j]\rangle_{\rho_k}.\]</p><p>It turns out that <span>$\omega^j_k$</span> can easily be evaluated with the help of a parameter shift rule</p><p class="math-container">\[\omega^j_k = \langle[H, P^j]\rangle_{\rho_k} = -i\langle V^\dagger_j(\pi/4)HV_j(\pi/4) - V^\dagger_j(-\pi/4)HV_j(-\pi/4)\rangle_{\rho_k},\]</p><p>where <span>$V_j(t) = \exp\{-itP^j\}$</span>.</p><p>Next, we write a function for generation of 2-local Pauli operators. We will restrict the Riemannian gradient to this subspace of the Lie algebra since otherwise the number of parameters to calculate would be <span>$4^8 - 1 = 65535$</span> which is too much for a reasonable runtime of the algorithm.</p><pre><code class="language-julia hljs">function generate_2local_pauli_strings(n)
    pauli_strings = []
    for i = 1:n
        push!(pauli_strings, kron(n, i =&gt; X))
        push!(pauli_strings, kron(n, i =&gt; Y))
        push!(pauli_strings, kron(n, i =&gt; Z))
    end
    for i = 1:n-1
        for j = i+1:n
            for P1 in [X, Y, Z]
                for P2 in [X, Y, Z]
                    push!(pauli_strings, kron(n, i =&gt; P1, j =&gt; P2))
                end
            end
        end
    end
    pauli_strings
end;</code></pre><p>Next we write functions for calculating the expansion coefficients and a single optimization step. We will absorb the factor of <span>$1/2^n$</span> into the learning rate.</p><pre><code class="language-julia hljs">function calculate_omegas(n, reg, h, pauli_strings)
    iω = []
    for P in pauli_strings
        push!(iω, real(expect(h, reg =&gt; time_evolve(P, π/4)) - expect(h, reg =&gt; time_evolve(P, -π/4))))
    end
    iω
end;

function step_and_cost!(n, circuit, h, α, pauli_strings)
    iω = calculate_omegas(n, zero_state(n) |&gt; circuit, h, pauli_strings)

    for (iωʲ, P) in zip(iω, pauli_strings)
        if abs(iωʲ) &gt; 1e-6 # we will only keep the ones that actually contribute
            append!(circuit, chain(n, time_evolve(P, -α * iωʲ)))
        end
    end

    real(expect(h, zero_state(n) =&gt; circuit))
end;</code></pre><p>Finally, let&#39;s try it out. We initialize the state <span>$|0\rangle$</span> and apply several optimization steps.</p><pre><code class="language-julia hljs">circuit = chain(n)
pauli_strings = generate_2local_pauli_strings(n)
history = Float64[]

for i=1:100
    cost = step_and_cost!(n, circuit, h, 0.01, pauli_strings)
    push!(history, cost)
end

Plots.plot(history, legend=false)
Plots.plot!(1:100, [w[1] for i=1:100])
xlabel!(&quot;steps&quot;)
ylabel!(&quot;energy&quot;)</code></pre><img src="/assets/images/Riemannian.png" alt="Riemannian gradient flow" width="600"/><p>When we compare the final states achieved with the Riemannian gradient flow optimizer and with the standard VQE we can notice that the former has lower quality. This is because the Riemannian gradient flow optimizer has only a local view of the cost landscape while VQE can access these directions since the ansatz we used is universal. However, if we were able to calculate all of the <span>$4^n - 1$</span> projections, Riemannian gradient flow optimizer would be guaranteed to converge given the appropriate learning rate!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../7.variation-quantum-eigen-solver/index.html">« Variational Quantum Eigen Solver</a><a class="docs-footer-nextpage" href="../9.noisy-simulation/index.html">Noisy Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.15.0 on <span class="colophon-date" title="Friday 24 October 2025 01:59">Friday 24 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
