<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Riemannian gradient flow optimizer · Documentation | Yao</title><meta name="title" content="Riemannian gradient flow optimizer · Documentation | Yao"/><meta property="og:title" content="Riemannian gradient flow optimizer · Documentation | Yao"/><meta property="twitter:title" content="Riemannian gradient flow optimizer · Documentation | Yao"/><meta name="description" content="Documentation for Documentation | Yao."/><meta property="og:description" content="Documentation for Documentation | Yao."/><meta property="twitter:description" content="Documentation for Documentation | Yao."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/indigo.css" rel="stylesheet" type="text/css"/><link href="https://yaoquantum.org/assets/favicon-light.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../index.html"><img src="../../../assets/logo.png" alt="Documentation | Yao logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../index.html">Documentation | Yao</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../index.html">Home</a></li><li><a class="tocitem" href="../../../quick-start.html">Quick Start</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../../man/registers.html">Quantum Registers</a></li><li><a class="tocitem" href="../../../man/blocks.html">Blocks</a></li><li><a class="tocitem" href="../../../man/symbolic.html">Symbolic Computation</a></li><li><a class="tocitem" href="../../../man/cuda.html">CUDA extension - CuYao</a></li><li><a class="tocitem" href="../../../man/plot.html">Quantum Circuit Visualization</a></li><li><a class="tocitem" href="../../../man/automatic_differentiation.html">Automatic Differentiation</a></li><li><a class="tocitem" href="../../../man/yao2einsum.html">Tensor network backend</a></li><li><a class="tocitem" href="../../../man/simplification.html">Simplification</a></li><li><a class="tocitem" href="../../../man/bitbasis.html">BitBasis</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../1.prepare-ghz-state/index.html">Prepare Greenberger–Horne–Zeilinger state with Quantum Circuit</a></li><li><a class="tocitem" href="../2.qft-phase-estimation/index.html">Quantum Fourier Transformation and Phase Estimation</a></li><li><a class="tocitem" href="../3.grover-search/index.html">Grover Search</a></li><li><a class="tocitem" href="../4.shor-algorithm/index.html">Shor&#39;s Algorithm</a></li><li><a class="tocitem" href="../5.shor-9-code/index.html">Shor&#39;s 9 qubit code</a></li><li><a class="tocitem" href="../6.quantum-circuit-born-machine/index.html">Quantum Circuit Born Machine</a></li><li><a class="tocitem" href="../7.variation-quantum-eigen-solver/index.html">Variational Quantum Eigen Solver</a></li><li class="is-active"><a class="tocitem" href="index.html">Riemannian gradient flow optimizer</a></li><li><a class="tocitem" href="../9.noisy-simulation/index.html">Noisy Simulation</a></li></ul></li><li><a class="tocitem" href="../../../performancetips.html">Performance Tips</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href="index.html">Riemannian gradient flow optimizer</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Riemannian gradient flow optimizer</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumBFS/Yao.jl/blob/master/docs/src/examples/8.riemannian-gradient-flow/main.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><p><a href="/generated/examples/8.riemannian-gradient-flow/main.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><h1 id="Riemannian-gradient-flow-optimizer"><a class="docs-heading-anchor" href="#Riemannian-gradient-flow-optimizer">Riemannian gradient flow optimizer</a><a id="Riemannian-gradient-flow-optimizer-1"></a><a class="docs-heading-anchor-permalink" href="#Riemannian-gradient-flow-optimizer" title="Permalink"></a></h1><p>In this tutorial we will present the Riemannian gradient descent algorithm described in <a href="https://arxiv.org/pdf/2108.13401.pdf">Miao and Barthel (2021)</a> and <a href="https://arxiv.org/pdf/2202.06976.pdf">Wiersema and Killoran (2022)</a> As opposed to most standard optimization algorithms that optimize parameters of variational quantum circuits, this algorithm optimizes a function directly over the special unitary group by following the gradient flow over the manifold. Let&#39;s start by importing the necessary packages.</p><pre><code class="language-julia hljs">using Yao, Yao.EasyBuild, Plots, Random
using KrylovKit: eigsolve</code></pre><p>Variational quantum eigensolver (VQE) is one of the most celebrated near-term quantum algorithms. In the usual setting, VQE tries to reach the ground state by minimizing the energy cost function</p><p class="math-container">\[\mathcal{L}(\theta) = \text{Tr}\{HU(\theta)\rho_0U^\dagger(\theta)\},\]</p><p>with respect to parameters <span>$\theta$</span> which parameterize a quantum circuit <span>$U(\theta)$</span>, where <span>$\rho_0 = |\psi_0\rangle\langle\psi_0|$</span> is some initial state and <span>$H$</span> the Hamiltonian whose ground state we want to approximate. We can solve the optimization problem <span>$\text{min}_\theta\mathcal{L}(\theta)$</span> by following the direction of the steepest descent in parameter space which is given by the gradient of the cost function, i.e. by considering the following gradient flow</p><p class="math-container">\[\dot{\theta} = -\text{grad}\mathcal{L}(\theta).\]</p><p>Discretizing the equation above, we recover the well-known gradient descent algorithm</p><p class="math-container">\[\theta_{k + 1} = \theta_k - \alpha\text{grad}\mathcal{L}(\theta),\]</p><p>where <span>$\alpha$</span> is the learning rate. Let&#39;s demonstrate it on the example of finding the ground state of the transverse field Ising model.</p><pre><code class="language-julia hljs">n = 8
h = transverse_ising(n, 1.0)
w, v = eigsolve(mat(h), 1, :SR, ishermitian=true)

Random.seed!(0)
circuit = dispatch!(variational_circuit(n, 100), :random);
history = Float64[]
for i in 1:100
    _, grad = expect&#39;(h, zero_state(n) =&gt; circuit)
    dispatch!(-, circuit, 0.01 * grad)
    push!(history, real.(expect(h, zero_state(n)=&gt;circuit)))
end

Plots.plot(history, legend=false)
Plots.plot!(1:100, [w[1] for i=1:100])
xlabel!(&quot;steps&quot;)
ylabel!(&quot;energy&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip650">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip650)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip651">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip650)" d="M242.135 1423.18 L2352.76 1423.18 L2352.76 47.2441 L242.135 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip652">
    <rect x="242" y="47" width="2112" height="1377"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="281.757,1423.18 281.757,47.2441 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="784.573,1423.18 784.573,47.2441 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1287.39,1423.18 1287.39,47.2441 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1790.21,1423.18 1790.21,47.2441 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2293.02,1423.18 2293.02,47.2441 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.135,1350.52 2352.76,1350.52 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.135,1082.59 2352.76,1082.59 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.135,814.658 2352.76,814.658 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.135,546.725 2352.76,546.725 "/>
<polyline clip-path="url(#clip652)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="242.135,278.793 2352.76,278.793 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,1423.18 2352.76,1423.18 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.757,1423.18 281.757,1404.28 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="784.573,1423.18 784.573,1404.28 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1287.39,1423.18 1287.39,1404.28 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1790.21,1423.18 1790.21,1404.28 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2293.02,1423.18 2293.02,1404.28 "/>
<path clip-path="url(#clip650)" d="M281.757 1454.1 Q278.145 1454.1 276.317 1457.66 Q274.511 1461.2 274.511 1468.33 Q274.511 1475.44 276.317 1479.01 Q278.145 1482.55 281.757 1482.55 Q285.391 1482.55 287.196 1479.01 Q289.025 1475.44 289.025 1468.33 Q289.025 1461.2 287.196 1457.66 Q285.391 1454.1 281.757 1454.1 M281.757 1450.39 Q287.567 1450.39 290.622 1455 Q293.701 1459.58 293.701 1468.33 Q293.701 1477.06 290.622 1481.67 Q287.567 1486.25 281.757 1486.25 Q275.946 1486.25 272.868 1481.67 Q269.812 1477.06 269.812 1468.33 Q269.812 1459.58 272.868 1455 Q275.946 1450.39 281.757 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M763.844 1481.64 L780.163 1481.64 L780.163 1485.58 L758.219 1485.58 L758.219 1481.64 Q760.881 1478.89 765.464 1474.26 Q770.071 1469.61 771.251 1468.27 Q773.496 1465.74 774.376 1464.01 Q775.279 1462.25 775.279 1460.56 Q775.279 1457.8 773.334 1456.07 Q771.413 1454.33 768.311 1454.33 Q766.112 1454.33 763.659 1455.09 Q761.228 1455.86 758.45 1457.41 L758.45 1452.69 Q761.274 1451.55 763.728 1450.97 Q766.182 1450.39 768.219 1450.39 Q773.589 1450.39 776.783 1453.08 Q779.978 1455.77 779.978 1460.26 Q779.978 1462.39 779.168 1464.31 Q778.381 1466.2 776.274 1468.8 Q775.696 1469.47 772.594 1472.69 Q769.492 1475.88 763.844 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M790.024 1451.02 L808.381 1451.02 L808.381 1454.96 L794.307 1454.96 L794.307 1463.43 Q795.325 1463.08 796.344 1462.92 Q797.362 1462.73 798.381 1462.73 Q804.168 1462.73 807.547 1465.9 Q810.927 1469.08 810.927 1474.49 Q810.927 1480.07 807.455 1483.17 Q803.982 1486.25 797.663 1486.25 Q795.487 1486.25 793.219 1485.88 Q790.973 1485.51 788.566 1484.77 L788.566 1480.07 Q790.649 1481.2 792.871 1481.76 Q795.094 1482.32 797.57 1482.32 Q801.575 1482.32 803.913 1480.21 Q806.251 1478.1 806.251 1474.49 Q806.251 1470.88 803.913 1468.77 Q801.575 1466.67 797.57 1466.67 Q795.695 1466.67 793.82 1467.08 Q791.969 1467.5 790.024 1468.38 L790.024 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1262.09 1451.02 L1280.44 1451.02 L1280.44 1454.96 L1266.37 1454.96 L1266.37 1463.43 Q1267.39 1463.08 1268.41 1462.92 Q1269.43 1462.73 1270.44 1462.73 Q1276.23 1462.73 1279.61 1465.9 Q1282.99 1469.08 1282.99 1474.49 Q1282.99 1480.07 1279.52 1483.17 Q1276.05 1486.25 1269.73 1486.25 Q1267.55 1486.25 1265.28 1485.88 Q1263.04 1485.51 1260.63 1484.77 L1260.63 1480.07 Q1262.71 1481.2 1264.94 1481.76 Q1267.16 1482.32 1269.63 1482.32 Q1273.64 1482.32 1275.98 1480.21 Q1278.31 1478.1 1278.31 1474.49 Q1278.31 1470.88 1275.98 1468.77 Q1273.64 1466.67 1269.63 1466.67 Q1267.76 1466.67 1265.88 1467.08 Q1264.03 1467.5 1262.09 1468.38 L1262.09 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1302.2 1454.1 Q1298.59 1454.1 1296.76 1457.66 Q1294.96 1461.2 1294.96 1468.33 Q1294.96 1475.44 1296.76 1479.01 Q1298.59 1482.55 1302.2 1482.55 Q1305.84 1482.55 1307.64 1479.01 Q1309.47 1475.44 1309.47 1468.33 Q1309.47 1461.2 1307.64 1457.66 Q1305.84 1454.1 1302.2 1454.1 M1302.2 1450.39 Q1308.01 1450.39 1311.07 1455 Q1314.15 1459.58 1314.15 1468.33 Q1314.15 1477.06 1311.07 1481.67 Q1308.01 1486.25 1302.2 1486.25 Q1296.39 1486.25 1293.31 1481.67 Q1290.26 1477.06 1290.26 1468.33 Q1290.26 1459.58 1293.31 1455 Q1296.39 1450.39 1302.2 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1764.06 1451.02 L1786.28 1451.02 L1786.28 1453.01 L1773.74 1485.58 L1768.85 1485.58 L1780.66 1454.96 L1764.06 1454.96 L1764.06 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1795.45 1451.02 L1813.8 1451.02 L1813.8 1454.96 L1799.73 1454.96 L1799.73 1463.43 Q1800.75 1463.08 1801.77 1462.92 Q1802.79 1462.73 1803.8 1462.73 Q1809.59 1462.73 1812.97 1465.9 Q1816.35 1469.08 1816.35 1474.49 Q1816.35 1480.07 1812.88 1483.17 Q1809.41 1486.25 1803.09 1486.25 Q1800.91 1486.25 1798.64 1485.88 Q1796.4 1485.51 1793.99 1484.77 L1793.99 1480.07 Q1796.07 1481.2 1798.3 1481.76 Q1800.52 1482.32 1802.99 1482.32 Q1807 1482.32 1809.34 1480.21 Q1811.67 1478.1 1811.67 1474.49 Q1811.67 1470.88 1809.34 1468.77 Q1807 1466.67 1802.99 1466.67 Q1801.12 1466.67 1799.24 1467.08 Q1797.39 1467.5 1795.45 1468.38 L1795.45 1451.02 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2252.63 1481.64 L2260.27 1481.64 L2260.27 1455.28 L2251.96 1456.95 L2251.96 1452.69 L2260.22 1451.02 L2264.9 1451.02 L2264.9 1481.64 L2272.54 1481.64 L2272.54 1485.58 L2252.63 1485.58 L2252.63 1481.64 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2291.98 1454.1 Q2288.37 1454.1 2286.54 1457.66 Q2284.73 1461.2 2284.73 1468.33 Q2284.73 1475.44 2286.54 1479.01 Q2288.37 1482.55 2291.98 1482.55 Q2295.61 1482.55 2297.42 1479.01 Q2299.25 1475.44 2299.25 1468.33 Q2299.25 1461.2 2297.42 1457.66 Q2295.61 1454.1 2291.98 1454.1 M2291.98 1450.39 Q2297.79 1450.39 2300.85 1455 Q2303.92 1459.58 2303.92 1468.33 Q2303.92 1477.06 2300.85 1481.67 Q2297.79 1486.25 2291.98 1486.25 Q2286.17 1486.25 2283.09 1481.67 Q2280.04 1477.06 2280.04 1468.33 Q2280.04 1459.58 2283.09 1455 Q2286.17 1450.39 2291.98 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M2322.14 1454.1 Q2318.53 1454.1 2316.7 1457.66 Q2314.9 1461.2 2314.9 1468.33 Q2314.9 1475.44 2316.7 1479.01 Q2318.53 1482.55 2322.14 1482.55 Q2325.78 1482.55 2327.58 1479.01 Q2329.41 1475.44 2329.41 1468.33 Q2329.41 1461.2 2327.58 1457.66 Q2325.78 1454.1 2322.14 1454.1 M2322.14 1450.39 Q2327.95 1450.39 2331.01 1455 Q2334.09 1459.58 2334.09 1468.33 Q2334.09 1477.06 2331.01 1481.67 Q2327.95 1486.25 2322.14 1486.25 Q2316.33 1486.25 2313.25 1481.67 Q2310.2 1477.06 2310.2 1468.33 Q2310.2 1459.58 2313.25 1455 Q2316.33 1450.39 2322.14 1450.39 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1238.66 1533.45 L1238.66 1538.98 Q1236.18 1537.71 1233.5 1537.07 Q1230.83 1536.44 1227.96 1536.44 Q1223.6 1536.44 1221.41 1537.77 Q1219.24 1539.11 1219.24 1541.79 Q1219.24 1543.82 1220.8 1545 Q1222.36 1546.15 1227.07 1547.2 L1229.08 1547.64 Q1235.32 1548.98 1237.93 1551.43 Q1240.57 1553.85 1240.57 1558.21 Q1240.57 1563.17 1236.62 1566.07 Q1232.71 1568.97 1225.83 1568.97 Q1222.97 1568.97 1219.85 1568.39 Q1216.76 1567.85 1213.32 1566.74 L1213.32 1560.69 Q1216.57 1562.38 1219.72 1563.24 Q1222.87 1564.07 1225.96 1564.07 Q1230.1 1564.07 1232.32 1562.66 Q1234.55 1561.23 1234.55 1558.65 Q1234.55 1556.27 1232.93 1554.99 Q1231.34 1553.72 1225.89 1552.54 L1223.86 1552.07 Q1218.42 1550.92 1216 1548.56 Q1213.58 1546.18 1213.58 1542.04 Q1213.58 1537.01 1217.14 1534.27 Q1220.71 1531.54 1227.26 1531.54 Q1230.51 1531.54 1233.37 1532.01 Q1236.24 1532.49 1238.66 1533.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1255.69 1522.27 L1255.69 1532.4 L1267.75 1532.4 L1267.75 1536.95 L1255.69 1536.95 L1255.69 1556.3 Q1255.69 1560.66 1256.86 1561.9 Q1258.07 1563.14 1261.73 1563.14 L1267.75 1563.14 L1267.75 1568.04 L1261.73 1568.04 Q1254.95 1568.04 1252.38 1565.53 Q1249.8 1562.98 1249.8 1556.3 L1249.8 1536.95 L1245.5 1536.95 L1245.5 1532.4 L1249.8 1532.4 L1249.8 1522.27 L1255.69 1522.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1305.94 1548.76 L1305.94 1551.62 L1279.02 1551.62 Q1279.4 1557.67 1282.65 1560.85 Q1285.92 1564 1291.75 1564 Q1295.12 1564 1298.27 1563.17 Q1301.46 1562.35 1304.57 1560.69 L1304.57 1566.23 Q1301.42 1567.57 1298.11 1568.27 Q1294.8 1568.97 1291.4 1568.97 Q1282.87 1568.97 1277.87 1564 Q1272.91 1559.04 1272.91 1550.57 Q1272.91 1541.82 1277.62 1536.69 Q1282.36 1531.54 1290.38 1531.54 Q1297.57 1531.54 1301.74 1536.18 Q1305.94 1540.8 1305.94 1548.76 M1300.09 1547.04 Q1300.02 1542.23 1297.38 1539.37 Q1294.77 1536.5 1290.44 1536.5 Q1285.54 1536.5 1282.58 1539.27 Q1279.65 1542.04 1279.21 1547.07 L1300.09 1547.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1321.22 1562.7 L1321.22 1581.6 L1315.33 1581.6 L1315.33 1532.4 L1321.22 1532.4 L1321.22 1537.81 Q1323.07 1534.62 1325.87 1533.1 Q1328.7 1531.54 1332.62 1531.54 Q1339.11 1531.54 1343.15 1536.69 Q1347.23 1541.85 1347.23 1550.25 Q1347.23 1558.65 1343.15 1563.81 Q1339.11 1568.97 1332.62 1568.97 Q1328.7 1568.97 1325.87 1567.44 Q1323.07 1565.88 1321.22 1562.7 M1341.15 1550.25 Q1341.15 1543.79 1338.47 1540.13 Q1335.83 1536.44 1331.18 1536.44 Q1326.54 1536.44 1323.86 1540.13 Q1321.22 1543.79 1321.22 1550.25 Q1321.22 1556.71 1323.86 1560.4 Q1326.54 1564.07 1331.18 1564.07 Q1335.83 1564.07 1338.47 1560.4 Q1341.15 1556.71 1341.15 1550.25 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M1379.66 1533.45 L1379.66 1538.98 Q1377.18 1537.71 1374.5 1537.07 Q1371.83 1536.44 1368.96 1536.44 Q1364.6 1536.44 1362.41 1537.77 Q1360.24 1539.11 1360.24 1541.79 Q1360.24 1543.82 1361.8 1545 Q1363.36 1546.15 1368.07 1547.2 L1370.08 1547.64 Q1376.32 1548.98 1378.93 1551.43 Q1381.57 1553.85 1381.57 1558.21 Q1381.57 1563.17 1377.62 1566.07 Q1373.71 1568.97 1366.83 1568.97 Q1363.97 1568.97 1360.85 1568.39 Q1357.76 1567.85 1354.32 1566.74 L1354.32 1560.69 Q1357.57 1562.38 1360.72 1563.24 Q1363.87 1564.07 1366.96 1564.07 Q1371.1 1564.07 1373.32 1562.66 Q1375.55 1561.23 1375.55 1558.65 Q1375.55 1556.27 1373.93 1554.99 Q1372.34 1553.72 1366.9 1552.54 L1364.86 1552.07 Q1359.42 1550.92 1357 1548.56 Q1354.58 1546.18 1354.58 1542.04 Q1354.58 1537.01 1358.14 1534.27 Q1361.71 1531.54 1368.26 1531.54 Q1371.51 1531.54 1374.37 1532.01 Q1377.24 1532.49 1379.66 1533.45 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,1423.18 242.135,47.2441 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,1350.52 261.032,1350.52 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,1082.59 261.032,1082.59 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,814.658 261.032,814.658 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,546.725 261.032,546.725 "/>
<polyline clip-path="url(#clip650)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="242.135,278.793 261.032,278.793 "/>
<path clip-path="url(#clip650)" d="M114.26 1350.98 L143.936 1350.98 L143.936 1354.91 L114.26 1354.91 L114.26 1350.98 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M154.839 1363.87 L162.477 1363.87 L162.477 1337.5 L154.167 1339.17 L154.167 1334.91 L162.431 1333.24 L167.107 1333.24 L167.107 1363.87 L174.746 1363.87 L174.746 1367.8 L154.839 1367.8 L154.839 1363.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M194.19 1336.32 Q190.579 1336.32 188.75 1339.89 Q186.945 1343.43 186.945 1350.56 Q186.945 1357.67 188.75 1361.23 Q190.579 1364.77 194.19 1364.77 Q197.825 1364.77 199.63 1361.23 Q201.459 1357.67 201.459 1350.56 Q201.459 1343.43 199.63 1339.89 Q197.825 1336.32 194.19 1336.32 M194.19 1332.62 Q200 1332.62 203.056 1337.23 Q206.135 1341.81 206.135 1350.56 Q206.135 1359.29 203.056 1363.89 Q200 1368.48 194.19 1368.48 Q188.38 1368.48 185.301 1363.89 Q182.246 1359.29 182.246 1350.56 Q182.246 1341.81 185.301 1337.23 Q188.38 1332.62 194.19 1332.62 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M144.515 1083.04 L174.19 1083.04 L174.19 1086.98 L144.515 1086.98 L144.515 1083.04 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M194.283 1083.46 Q190.95 1083.46 189.028 1085.24 Q187.13 1087.02 187.13 1090.15 Q187.13 1093.27 189.028 1095.06 Q190.95 1096.84 194.283 1096.84 Q197.616 1096.84 199.537 1095.06 Q201.459 1093.25 201.459 1090.15 Q201.459 1087.02 199.537 1085.24 Q197.639 1083.46 194.283 1083.46 M189.607 1081.47 Q186.598 1080.73 184.908 1078.67 Q183.241 1076.61 183.241 1073.64 Q183.241 1069.5 186.181 1067.09 Q189.144 1064.69 194.283 1064.69 Q199.445 1064.69 202.385 1067.09 Q205.324 1069.5 205.324 1073.64 Q205.324 1076.61 203.635 1078.67 Q201.968 1080.73 198.982 1081.47 Q202.362 1082.26 204.237 1084.55 Q206.135 1086.84 206.135 1090.15 Q206.135 1095.17 203.056 1097.86 Q200 1100.54 194.283 1100.54 Q188.565 1100.54 185.487 1097.86 Q182.431 1095.17 182.431 1090.15 Q182.431 1086.84 184.329 1084.55 Q186.227 1082.26 189.607 1081.47 M187.894 1074.08 Q187.894 1076.77 189.561 1078.27 Q191.25 1079.78 194.283 1079.78 Q197.292 1079.78 198.982 1078.27 Q200.695 1076.77 200.695 1074.08 Q200.695 1071.4 198.982 1069.89 Q197.292 1068.39 194.283 1068.39 Q191.25 1068.39 189.561 1069.89 Q187.894 1071.4 187.894 1074.08 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M144.26 815.11 L173.936 815.11 L173.936 819.045 L144.26 819.045 L144.26 815.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M194.607 812.795 Q191.459 812.795 189.607 814.948 Q187.778 817.1 187.778 820.85 Q187.778 824.577 189.607 826.753 Q191.459 828.906 194.607 828.906 Q197.755 828.906 199.584 826.753 Q201.436 824.577 201.436 820.85 Q201.436 817.1 199.584 814.948 Q197.755 812.795 194.607 812.795 M203.889 798.142 L203.889 802.401 Q202.13 801.568 200.325 801.128 Q198.542 800.688 196.783 800.688 Q192.153 800.688 189.7 803.813 Q187.269 806.938 186.922 813.258 Q188.288 811.244 190.348 810.179 Q192.408 809.091 194.885 809.091 Q200.093 809.091 203.102 812.262 Q206.135 815.411 206.135 820.85 Q206.135 826.174 202.987 829.392 Q199.838 832.61 194.607 832.61 Q188.612 832.61 185.44 828.026 Q182.269 823.42 182.269 814.693 Q182.269 806.499 186.158 801.638 Q190.047 796.753 196.598 796.753 Q198.357 796.753 200.139 797.101 Q201.945 797.448 203.889 798.142 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M143.936 547.177 L173.612 547.177 L173.612 551.112 L143.936 551.112 L143.936 547.177 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M196.551 533.519 L184.746 551.968 L196.551 551.968 L196.551 533.519 M195.325 529.445 L201.204 529.445 L201.204 551.968 L206.135 551.968 L206.135 555.857 L201.204 555.857 L201.204 564.005 L196.551 564.005 L196.551 555.857 L180.95 555.857 L180.95 551.343 L195.325 529.445 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M146.019 279.244 L175.695 279.244 L175.695 283.179 L146.019 283.179 L146.019 279.244 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M189.815 292.137 L206.135 292.137 L206.135 296.073 L184.19 296.073 L184.19 292.137 Q186.852 289.383 191.436 284.753 Q196.042 280.1 197.223 278.758 Q199.468 276.235 200.348 274.499 Q201.25 272.739 201.25 271.05 Q201.25 268.295 199.306 266.559 Q197.385 264.823 194.283 264.823 Q192.084 264.823 189.63 265.587 Q187.2 266.351 184.422 267.901 L184.422 263.179 Q187.246 262.045 189.7 261.466 Q192.153 260.888 194.19 260.888 Q199.561 260.888 202.755 263.573 Q205.949 266.258 205.949 270.749 Q205.949 272.878 205.139 274.8 Q204.352 276.698 202.246 279.29 Q201.667 279.962 198.565 283.179 Q195.463 286.374 189.815 292.137 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M44.7161 812.969 L47.5806 812.969 L47.5806 839.896 Q53.6281 839.514 56.8109 836.268 Q59.9619 832.989 59.9619 827.165 Q59.9619 823.791 59.1344 820.64 Q58.3069 817.457 56.6518 814.338 L62.1899 814.338 Q63.5267 817.489 64.227 820.799 Q64.9272 824.109 64.9272 827.515 Q64.9272 836.045 59.9619 841.042 Q54.9967 846.007 46.5303 846.007 Q37.7774 846.007 32.6531 841.296 Q27.4968 836.554 27.4968 828.533 Q27.4968 821.34 32.1438 817.17 Q36.7589 812.969 44.7161 812.969 M42.9973 818.826 Q38.1912 818.889 35.3266 821.531 Q32.4621 824.141 32.4621 828.47 Q32.4621 833.371 35.2312 836.331 Q38.0002 839.259 43.0292 839.705 L42.9973 818.826 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M42.4881 773.724 L64.0042 773.724 L64.0042 779.581 L42.679 779.581 Q37.6183 779.581 35.1038 781.554 Q32.5894 783.528 32.5894 787.474 Q32.5894 792.217 35.6131 794.954 Q38.6368 797.691 43.8567 797.691 L64.0042 797.691 L64.0042 803.58 L28.3562 803.58 L28.3562 797.691 L33.8944 797.691 Q30.6797 795.591 29.0883 792.758 Q27.4968 789.893 27.4968 786.169 Q27.4968 780.027 31.3163 776.876 Q35.1038 773.724 42.4881 773.724 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M44.7161 731.552 L47.5806 731.552 L47.5806 758.479 Q53.6281 758.097 56.8109 754.85 Q59.9619 751.572 59.9619 745.747 Q59.9619 742.373 59.1344 739.222 Q58.3069 736.04 56.6518 732.92 L62.1899 732.92 Q63.5267 736.071 64.227 739.382 Q64.9272 742.692 64.9272 746.097 Q64.9272 754.627 59.9619 759.624 Q54.9967 764.59 46.5303 764.59 Q37.7774 764.59 32.6531 759.879 Q27.4968 755.137 27.4968 747.116 Q27.4968 739.923 32.1438 735.753 Q36.7589 731.552 44.7161 731.552 M42.9973 737.408 Q38.1912 737.472 35.3266 740.114 Q32.4621 742.724 32.4621 747.052 Q32.4621 751.954 35.2312 754.914 Q38.0002 757.842 43.0292 758.288 L42.9973 737.408 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M33.8307 701.283 Q33.2578 702.269 33.0032 703.447 Q32.7167 704.593 32.7167 705.993 Q32.7167 710.959 35.9632 713.632 Q39.1779 716.274 45.2253 716.274 L64.0042 716.274 L64.0042 722.162 L28.3562 722.162 L28.3562 716.274 L33.8944 716.274 Q30.6479 714.428 29.0883 711.468 Q27.4968 708.508 27.4968 704.275 Q27.4968 703.67 27.5923 702.938 Q27.656 702.206 27.8151 701.315 L33.8307 701.283 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M45.7664 672.828 Q39.4007 672.828 35.8996 675.47 Q32.3984 678.08 32.3984 682.822 Q32.3984 687.533 35.8996 690.175 Q39.4007 692.785 45.7664 692.785 Q52.1003 692.785 55.6014 690.175 Q59.1026 687.533 59.1026 682.822 Q59.1026 678.08 55.6014 675.47 Q52.1003 672.828 45.7664 672.828 M59.58 666.972 Q68.683 666.972 73.1071 671.014 Q77.5631 675.056 77.5631 683.395 Q77.5631 686.482 77.0857 689.22 Q76.6401 691.957 75.6852 694.535 L69.9879 694.535 Q71.3884 691.957 72.0568 689.443 Q72.7252 686.928 72.7252 684.318 Q72.7252 678.557 69.7015 675.693 Q66.7096 672.828 60.6303 672.828 L57.7339 672.828 Q60.885 674.642 62.4446 677.475 Q64.0042 680.308 64.0042 684.254 Q64.0042 690.811 59.0071 694.822 Q54.01 698.832 45.7664 698.832 Q37.491 698.832 32.4939 694.822 Q27.4968 690.811 27.4968 684.254 Q27.4968 680.308 29.0564 677.475 Q30.616 674.642 33.7671 672.828 L28.3562 672.828 L28.3562 666.972 L59.58 666.972 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip650)" d="M67.3143 640.076 Q73.68 642.559 75.6216 644.914 Q77.5631 647.27 77.5631 651.216 L77.5631 655.895 L72.6615 655.895 L72.6615 652.458 Q72.6615 650.039 71.5157 648.702 Q70.3699 647.365 66.1048 645.742 L63.4312 644.692 L28.3562 659.11 L28.3562 652.903 L56.238 641.763 L28.3562 630.623 L28.3562 624.417 L67.3143 640.076 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip652)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="301.869,86.1857 321.982,193.076 342.095,296.427 362.207,395.123 382.32,488.68 402.432,576.885 422.545,659.528 442.658,736.357 462.77,807.165 482.883,871.881 502.996,930.6 523.108,983.551 543.221,1031.05 563.334,1073.45 583.446,1111.11 603.559,1144.41 623.672,1173.72 643.784,1199.4 663.897,1221.84 684.01,1241.37 704.122,1258.33 724.235,1273.05 744.347,1285.81 764.46,1296.87 784.573,1306.45 804.685,1314.77 824.798,1322 844.911,1328.29 865.023,1333.77 885.136,1338.55 905.249,1342.74 925.361,1346.41 945.474,1349.63 965.587,1352.47 985.699,1354.97 1005.81,1357.18 1025.92,1359.14 1046.04,1360.87 1066.15,1362.41 1086.26,1363.79 1106.38,1365.01 1126.49,1366.11 1146.6,1367.09 1166.71,1367.97 1186.83,1368.76 1206.94,1369.48 1227.05,1370.12 1247.16,1370.71 1267.28,1371.24 1287.39,1371.72 1307.5,1372.16 1327.61,1372.56 1347.73,1372.92 1367.84,1373.26 1387.95,1373.57 1408.06,1373.85 1428.18,1374.11 1448.29,1374.35 1468.4,1374.58 1488.52,1374.79 1508.63,1374.98 1528.74,1375.16 1548.85,1375.33 1568.97,1375.49 1589.08,1375.64 1609.19,1375.78 1629.3,1375.92 1649.42,1376.04 1669.53,1376.16 1689.64,1376.27 1709.75,1376.38 1729.87,1376.49 1749.98,1376.58 1770.09,1376.68 1790.21,1376.77 1810.32,1376.86 1830.43,1376.94 1850.54,1377.02 1870.66,1377.1 1890.77,1377.17 1910.88,1377.25 1930.99,1377.32 1951.11,1377.39 1971.22,1377.45 1991.33,1377.52 2011.44,1377.58 2031.56,1377.64 2051.67,1377.7 2071.78,1377.76 2091.89,1377.82 2112.01,1377.87 2132.12,1377.93 2152.23,1377.98 2172.35,1378.04 2192.46,1378.09 2212.57,1378.14 2232.68,1378.19 2252.8,1378.24 2272.91,1378.29 2293.02,1378.34 "/>
<polyline clip-path="url(#clip652)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="301.869,1384.24 321.982,1384.24 342.095,1384.24 362.207,1384.24 382.32,1384.24 402.432,1384.24 422.545,1384.24 442.658,1384.24 462.77,1384.24 482.883,1384.24 502.996,1384.24 523.108,1384.24 543.221,1384.24 563.334,1384.24 583.446,1384.24 603.559,1384.24 623.672,1384.24 643.784,1384.24 663.897,1384.24 684.01,1384.24 704.122,1384.24 724.235,1384.24 744.347,1384.24 764.46,1384.24 784.573,1384.24 804.685,1384.24 824.798,1384.24 844.911,1384.24 865.023,1384.24 885.136,1384.24 905.249,1384.24 925.361,1384.24 945.474,1384.24 965.587,1384.24 985.699,1384.24 1005.81,1384.24 1025.92,1384.24 1046.04,1384.24 1066.15,1384.24 1086.26,1384.24 1106.38,1384.24 1126.49,1384.24 1146.6,1384.24 1166.71,1384.24 1186.83,1384.24 1206.94,1384.24 1227.05,1384.24 1247.16,1384.24 1267.28,1384.24 1287.39,1384.24 1307.5,1384.24 1327.61,1384.24 1347.73,1384.24 1367.84,1384.24 1387.95,1384.24 1408.06,1384.24 1428.18,1384.24 1448.29,1384.24 1468.4,1384.24 1488.52,1384.24 1508.63,1384.24 1528.74,1384.24 1548.85,1384.24 1568.97,1384.24 1589.08,1384.24 1609.19,1384.24 1629.3,1384.24 1649.42,1384.24 1669.53,1384.24 1689.64,1384.24 1709.75,1384.24 1729.87,1384.24 1749.98,1384.24 1770.09,1384.24 1790.21,1384.24 1810.32,1384.24 1830.43,1384.24 1850.54,1384.24 1870.66,1384.24 1890.77,1384.24 1910.88,1384.24 1930.99,1384.24 1951.11,1384.24 1971.22,1384.24 1991.33,1384.24 2011.44,1384.24 2031.56,1384.24 2051.67,1384.24 2071.78,1384.24 2091.89,1384.24 2112.01,1384.24 2132.12,1384.24 2152.23,1384.24 2172.35,1384.24 2192.46,1384.24 2212.57,1384.24 2232.68,1384.24 2252.8,1384.24 2272.91,1384.24 2293.02,1384.24 "/>
</svg>
<p>Let&#39;s now consider the energy cost function directly over the special unitary group <span>$\mathcal{L}: \text{SU}(2^n) \rightarrow \mathbb{R}$</span></p><p class="math-container">\[\mathcal{L}(U) = \text{Tr}\{HU\rho_0U^\dagger\}.\]</p><p>To minimize the cost function we can follow the Riemannian gradient flow defined through the following differential equation</p><p class="math-container">\[\dot{U} = -\text{grad}\mathcal{L}(U) = [U\rho_0U^\dagger, H]U.\]</p><p>Discretizing the flow we get the following recursive update rule</p><p class="math-container">\[U_{k + 1} = \exp\{\alpha[U_k\rho_0U^\dagger_k, H]\}U_k = \exp\{\alpha[\rho_k, H]\}U_k,\]</p><p>where <span>$\alpha$</span> is the appropriate learning rate and <span>$U_0 = I$</span>.</p><p>We can expand the commutator in the exponent in the basis of Pauli strings <span>$P^j$</span></p><p class="math-container">\[[\rho_k, H] = \frac{1}{2^n}\sum_{j = 1}^{4^n - 1}\omega^j_kP^j,\]</p><p>where</p><p class="math-container">\[\omega^j_k = \text{Tr}\{[\rho_k, H]P^j\} = \text{Tr}\{[H, P^j]\rho_k\} = \langle[H, P^j]\rangle_{\rho_k}.\]</p><p>It turns out that <span>$\omega^j_k$</span> can easily be evaluated with the help of a parameter shift rule</p><p class="math-container">\[\omega^j_k = \langle[H, P^j]\rangle_{\rho_k} = -i\langle V^\dagger_j(\pi/4)HV_j(\pi/4) - V^\dagger_j(-\pi/4)HV_j(-\pi/4)\rangle_{\rho_k},\]</p><p>where <span>$V_j(t) = \exp\{-itP^j\}$</span>.</p><p>Next, we write a function for generation of 2-local Pauli operators. We will restrict the Riemannian gradient to this subspace of the Lie algebra since otherwise the number of parameters to calculate would be <span>$4^8 - 1 = 65535$</span> which is too much for a reasonable runtime of the algorithm.</p><pre><code class="language-julia hljs">function generate_2local_pauli_strings(n)
    pauli_strings = []
    for i = 1:n
        push!(pauli_strings, kron(n, i =&gt; X))
        push!(pauli_strings, kron(n, i =&gt; Y))
        push!(pauli_strings, kron(n, i =&gt; Z))
    end
    for i = 1:n-1
        for j = i+1:n
            for P1 in [X, Y, Z]
                for P2 in [X, Y, Z]
                    push!(pauli_strings, kron(n, i =&gt; P1, j =&gt; P2))
                end
            end
        end
    end
    pauli_strings
end;</code></pre><p>Next we write functions for calculating the expansion coefficients and a single optimization step. We will absorb the factor of <span>$1/2^n$</span> into the learning rate.</p><pre><code class="language-julia hljs">function calculate_omegas(n, reg, h, pauli_strings)
    iω = []
    for P in pauli_strings
        push!(iω, real(expect(h, reg =&gt; time_evolve(P, π/4)) - expect(h, reg =&gt; time_evolve(P, -π/4))))
    end
    iω
end;

function step_and_cost!(n, circuit, h, α, pauli_strings)
    iω = calculate_omegas(n, zero_state(n) |&gt; circuit, h, pauli_strings)

    for (iωʲ, P) in zip(iω, pauli_strings)
        if abs(iωʲ) &gt; 1e-6 # we will only keep the ones that actually contribute
            append!(circuit, chain(n, time_evolve(P, -α * iωʲ)))
        end
    end

    real(expect(h, zero_state(n) =&gt; circuit))
end;</code></pre><p>Finally, let&#39;s try it out. We initialize the state <span>$|0\rangle$</span> and apply several optimization steps.</p><pre><code class="language-julia hljs">circuit = chain(n)
pauli_strings = generate_2local_pauli_strings(n)
history = Float64[]

for i=1:100
    cost = step_and_cost!(n, circuit, h, 0.01, pauli_strings)
    push!(history, cost)
end

Plots.plot(history, legend=false)
Plots.plot!(1:100, [w[1] for i=1:100])
xlabel!(&quot;steps&quot;)
ylabel!(&quot;energy&quot;)</code></pre><img src="/assets/images/Riemannian.png" alt="Riemannian gradient flow" width="600"/><p>When we compare the final states achieved with the Riemannian gradient flow optimizer and with the standard VQE we can notice that the former has lower quality. This is because the Riemannian gradient flow optimizer has only a local view of the cost landscape while VQE can access these directions since the ansatz we used is universal. However, if we were able to calculate all of the <span>$4^n - 1$</span> projections, Riemannian gradient flow optimizer would be guaranteed to converge given the appropriate learning rate!</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../7.variation-quantum-eigen-solver/index.html">« Variational Quantum Eigen Solver</a><a class="docs-footer-nextpage" href="../9.noisy-simulation/index.html">Noisy Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Sunday 22 June 2025 14:48">Sunday 22 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
